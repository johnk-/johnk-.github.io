<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ENVELOP (and COMPOSE!) By Example - #2 by hostilefork - Dialects/DSLs - AltRebol</title>
    <meta name="description" content="Prior to splices, we were considering rethinking append/only [a b c] [d e] as append [a b c] only [d e], where ONLY would just envelop its argument in a block. 
@rgchris didn&amp;#39;t care for the name: 

As it happens, ONLY de&amp;hellip;">
    <meta name="generator" content="Discourse 3.5.0.beta6-dev - https://github.com/discourse/discourse version 623cde985b21c2ed812b83d3ea94f69231613718">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="../2294.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="AltRebol Search">

    <link href="https://rebol.metaeducation.com/stylesheets/color_definitions_base__2_ceb61c279a74dfa3cef6a62f7784988102abec82.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" class="light-scheme"/>

<link href="https://rebol.metaeducation.com/stylesheets/common_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common"  />

  <link href="https://rebol.metaeducation.com/stylesheets/desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="desktop"  />



    <link href="https://rebol.metaeducation.com/stylesheets/chat_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-details_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-lazy-videos_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-local-dates_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-narrative-bot_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-presence_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="https://rebol.metaeducation.com/stylesheets/docker_manager_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="https://rebol.metaeducation.com/stylesheets/footnote_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll"  />
    <link href="https://rebol.metaeducation.com/stylesheets/spoiler-alert_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="https://rebol.metaeducation.com/stylesheets/chat_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat_desktop"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://rebol.metaeducation.com/stylesheets/common_theme_2_57fe803ed5a41e9f7d94086afaf66a1aab57d9ae.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="2" data-theme-name="default"/>
    

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;ENVELOP (and COMPOSE!) By Example&#39;" href="../2294.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://rebol.metaeducation.com/t/envelop-and-compose-by-example/2294/2" />
<meta name="twitter:url" content="https://rebol.metaeducation.com/t/envelop-and-compose-by-example/2294/2" />
<meta property="og:title" content="ENVELOP (and COMPOSE!) By Example" />
<meta name="twitter:title" content="ENVELOP (and COMPOSE!) By Example" />
<meta property="og:description" content="I have realized that this is an incredibly useful ability...  ...but even more importantly...  The Binding Aspect Motivates COMPOSE-by-Example Since today&#39;s COMPOSE is arity-1, to get it to work at all you have to run it on a bound block (assuming the nested groups you&#39;re composing aren&#39;t somehow already bound).  The tip of the binding of that block is what COMPOSE sloppily borrows to use when evaluating the inner groups.  &gt;&gt; x: 1, y: 2  ; let&#39;s say these are incidental definitions  &gt;&gt; var: &#39;y ..." />
<meta name="twitter:description" content="I have realized that this is an incredibly useful ability...  ...but even more importantly...  The Binding Aspect Motivates COMPOSE-by-Example Since today&#39;s COMPOSE is arity-1, to get it to work at all you have to run it on a bound block (assuming the nested groups you&#39;re composing aren&#39;t somehow already bound).  The tip of the binding of that block is what COMPOSE sloppily borrows to use when evaluating the inner groups.  &gt;&gt; x: 1, y: 2  ; let&#39;s say these are incidental definitions  &gt;&gt; var: &#39;y ..." />
<meta property="og:article:section" content="Domains" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="og:article:section" content="Dialects/DSLs" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="article:published_time" content="2024-09-23T16:23:55+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://rebol.metaeducation.com/">AltRebol</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="../2294.html">ENVELOP (and COMPOSE!) By Example</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/domains/dialects-dsls/18" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Domains</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/domains/dialects-dsls/18" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Dialects/DSLs</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='ENVELOP (and COMPOSE!) By Example'>
      <link itemprop='url' href='../2294.html'>
      <meta itemprop='datePublished' content='2024-09-23T12:43:20Z'>
        <meta itemprop='articleSection' content='Dialects/DSLs'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>

          <span itemprop='author' itemscope itemtype="http://schema.org/Person">
            <meta itemprop='name' content='hostilefork'>
            <link itemprop='url' rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'>
          </span>
        <meta itemprop='text' content='Prior to splices, we were considering rethinking append/only [a b c] [d e] as append [a b c] only [d e], where ONLY would just envelop its argument in a block. 
@rgchris didn&amp;#39;t care for the name: 

As it happens, ONLY de&amp;hellip;'>

          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-09-23T16:23:55Z' class='post-time'>
                    September 23, 2024,  4:23pm
                  </time>
                  <meta itemprop='dateModified' content='2025-03-24T01:06:26Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="2294">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>But as arity-1 functions, the returned block or group would be unbound at its tip. So you'd have to use the ENVELOP-by-example to pass in a binding.</p>
</blockquote>
</aside>
<p>I have realized that this is an incredibly useful ability...</p>
<p>...but even more importantly...</p>
<h2><a name="p-7761-the-binding-aspect-motivates-compose-by-example-1" class="anchor" href="2.html#p-7761-the-binding-aspect-motivates-compose-by-example-1"></a>The Binding Aspect Motivates <strong>COMPOSE-by-Example</strong></h2>
<p>Since today's COMPOSE is arity-1, to get it to work at all you have to run it on a bound block (assuming the nested groups you're composing aren't somehow already bound).  The tip of the binding of that block is what COMPOSE sloppily borrows to use when evaluating the inner groups.</p>
<pre><code>&gt;&gt; x: 1, y: 2  ; let's say these are incidental definitions

&gt;&gt; var: 'y

&gt;&gt; code: compose '[x + (var)]
** Error: var is not bound

&gt;&gt; code: compose [x + (var)]  ; eval'd BLOCK! binds, compose borrows that binding
== [x + y]  ; but the result tip still has the binding

&gt;&gt; eval compose [let x: 10 let y: 20 (as group! code)]
== 3  ; let's say this is not what I meant
</code></pre>
<p>If you didn't want the final result of a COMPOSE to be unbound, you still have to bind the block long enough for compose to find the bindings...and then unbind it.</p>
<p>Not only is that awkward, what if you had a meaningful binding on the input you wanted to keep.  You'd have to store the binding somehow... bind to the context for your groups long enough for the compose to work, then rebind it to the stored binding...</p>
<h2><a name="p-7761-compose-by-example-can-fix-this-smiley-2" class="anchor" href="2.html#p-7761-compose-by-example-can-fix-this-smiley-2"></a>Compose-By-Example Can Fix This!  <img src="../../../images/emoji/twitter/smiley.png%3Fv=14" title=":smiley:" class="emoji" alt=":smiley:" loading="lazy" width="20" height="20"></h2>
<p>I suggest the arity-2 form be called <strong><code>COMPOSE2</code></strong>.  (It's a good name because it tells you the arity, and also kind of like it's the sequel... COMPOSE 2: The Revenge)</p>
<p>When you pass a list with an @ on it, COMPOSE2 receives that signal and interprets it to mean you want to use the binding of that list for the substitution sites:</p>
<pre><code>&gt;&gt; var: 'y
== y

&gt;&gt; code: compose2 @() '[x + (var)]
== [x + y]  ; worked even though we passed in an unbound block!

&gt;&gt; eval compose [let x: 10 let y: 20 (as group! code)]
== 30
</code></pre>
<p>So not only do you get the freedom to specify what delimiters (or synthetic/nested delimiters) you want to use, you can also supply an arbitrary binding.</p>
<h2><a name="p-7761-old-compose-is-still-useful-day-to-day-3" class="anchor" href="2.html#p-7761-old-compose-is-still-useful-day-to-day-3"></a>Old COMPOSE Is Still Useful Day-To-Day</h2>
<p>It's useful enough to keep its name, and do what it does.  It works out a lot of the time.</p>
<p>But the strange thing here is that COMPOSE with an non-<code>@</code>-list has to mean use the binding of the template.</p>
<pre><code>compose: specialize compose2/ [template: '()]
</code></pre>
<p>And you can do this off the cuff...</p>
<pre><code> test: func [block] [  ; can't see foo
     compose2 '{{}} block  ; block captured environment
 ]

let foo: 1000

&gt;&gt; test [hello {{foo + 20}} world]
== [hello 1020 world]
</code></pre>
<p><img src="../../../images/emoji/twitter/man_mage.png%3Fv=14" title=":man_mage:" class="emoji only-emoji" alt=":man_mage:" loading="lazy" width="20" height="20"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../../could-sigil-carry-a-binding/2376/3.html">Could SIGIL! Carry A Binding?</a>
                        <meta itemprop='position' content='1'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../../usefulness-of-string-interpolation/2114/4.html">Usefulness of String Interpolation</a>
                        <meta itemprop='position' content='2'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../../fretting-over-the-arity-of-compose/2376.html">Could SIGIL! Carry A Binding?</a>
                        <meta itemprop='position' content='3'>
                      </div>
                </div>
          </div>
    </div>

      <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
          <span itemprop='name'>
            <a itemprop="url" href="../2294.html#post_2">show post in topic</a>
          </span>
      </div>

    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
