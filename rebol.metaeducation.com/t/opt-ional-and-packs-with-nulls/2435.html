<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>OPT(IONAL) and Packs-With-Nulls - Semantics - AltRebol</title>
    <meta name="description" content="Antiform packs that contain pure nulls, e.g. the &amp;quot;heavy null&amp;quot; ~[~null~]~, are a cornerstone of how Ren-C handles the situation of a branch that returns null... to avoid having such branches run, and then pass control to &amp;hellip;">
    <meta name="generator" content="Discourse 3.5.0.beta6-dev - https://github.com/discourse/discourse version 623cde985b21c2ed812b83d3ea94f69231613718">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="2435.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

    <link href="https://rebol.metaeducation.com/stylesheets/color_definitions_base__2_ceb61c279a74dfa3cef6a62f7784988102abec82.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" class="light-scheme"/>

<link href="https://rebol.metaeducation.com/stylesheets/common_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common"  />

  <link href="https://rebol.metaeducation.com/stylesheets/desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="desktop"  />



    <link href="https://rebol.metaeducation.com/stylesheets/chat_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-details_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-lazy-videos_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-local-dates_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-narrative-bot_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-presence_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="https://rebol.metaeducation.com/stylesheets/docker_manager_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="https://rebol.metaeducation.com/stylesheets/footnote_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll"  />
    <link href="https://rebol.metaeducation.com/stylesheets/spoiler-alert_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="https://rebol.metaeducation.com/stylesheets/chat_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat_desktop"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://rebol.metaeducation.com/stylesheets/common_theme_2_57fe803ed5a41e9f7d94086afaf66a1aab57d9ae.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="2" data-theme-name="default"/>
    

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;OPT(IONAL) and Packs-With-Nulls&#39;" href="2435.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://rebol.metaeducation.com/t/opt-ional-and-packs-with-nulls/2435" />
<meta name="twitter:url" content="https://rebol.metaeducation.com/t/opt-ional-and-packs-with-nulls/2435" />
<meta property="og:title" content="OPT(IONAL) and Packs-With-Nulls" />
<meta name="twitter:title" content="OPT(IONAL) and Packs-With-Nulls" />
<meta property="og:description" content="Antiform packs that contain pure nulls, e.g. the &quot;heavy null&quot; ~[~null~]~, are a cornerstone of how Ren-C handles the situation of a branch that returns null... to avoid having such branches run, and then pass control to an ELSE even though the branch was executed.  This is both beautiful and a thorny edge case.  Some constructs want to treat a boxed null just the same as an unboxed one.  Others don&#39;t.  It can be a bit hairy.  So to reserve the functionality for just pure nulls and branches... I ..." />
<meta name="twitter:description" content="Antiform packs that contain pure nulls, e.g. the &quot;heavy null&quot; ~[~null~]~, are a cornerstone of how Ren-C handles the situation of a branch that returns null... to avoid having such branches run, and then pass control to an ELSE even though the branch was executed.  This is both beautiful and a thorny edge case.  Some constructs want to treat a boxed null just the same as an unboxed one.  Others don&#39;t.  It can be a bit hairy.  So to reserve the functionality for just pure nulls and branches... I ..." />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:section" content="Semantics" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="article:published_time" content="2025-05-05T10:58:36+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://rebol.metaeducation.com/">AltRebol</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="2435.html">OPT(IONAL) and Packs-With-Nulls</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/development/semantics/55" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/development/semantics/55" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Semantics</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='OPT(IONAL) and Packs-With-Nulls'>
      <link itemprop='url' href='2435.html'>
      <meta itemprop='datePublished' content='2025-05-05T10:58:36Z'>
        <meta itemprop='articleSection' content='Semantics'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="2435.html">


              <span class="crawler-post-infos">
                  <time  datetime='2025-05-05T10:58:36Z' class='post-time'>
                    May 5, 2025, 10:58am
                  </time>
                  <meta itemprop='dateModified' content='2025-05-10T04:05:44Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Antiform packs that contain pure nulls, e.g. the "heavy null" <strong><code>~[~null~]~</code></strong>, are a cornerstone of how Ren-C handles the situation of a branch that returns null... to avoid having such branches run, and then pass control to an ELSE even though the branch was executed.</p>
<p>This is both beautiful and a thorny edge case.  Some constructs want to treat a boxed null just the same as an unboxed one.  Others don't.  It can be a bit hairy.</p>
<p>So to reserve the functionality for just pure nulls and branches... I discourage the creation of packs with nulls in them for the ordinary functioning of routines--if you can avoid it (you sometimes can't).  The general rule of thumb is that your functions should not put nulls in packs, and if they ever return null it should be the <em>only</em> return--not in a pack.  (Similar guidance discourages putting error antiforms in packs, but making it the overall result.)</p>
<h2><a name="p-8206-case-study-split-path-1" class="anchor" href="2435.html#p-8206-case-study-split-path-1"></a>Case Study: SPLIT-PATH</h2>
<p>So the SPLIT-PATH function in Ren-C is a multi-return, giving you two parts: the file component, and the path component:</p>
<pre><code>&gt;&gt; meta split-path %foo/bar.txt
== ~['%foo/ '%bar.txt]~

&gt;&gt; split-path %foo/bar.txt
== %foo/
</code></pre>
<p>It seemed that a lot of calls to it wanted the directory, so I made that the first return.</p>
<p>The problem arises when a component is missing:</p>
<pre><code>&gt;&gt; meta split-path %bar.txt
== ~[~null~ '%bar.txt]~

&gt;&gt; split-path %bar.txt
== ~null~  ; anti
</code></pre>
<p>Why is this a problem?  Well, there are functions such as OPT that don't want to decay their arguments... but rather be driven by pure nulls.  So this gives:</p>
<pre><code>&gt;&gt; decay opt split-path %bar.txt
== ~null~  ; anti
</code></pre>
<p>Not what the person using OPT wanted.  They wanted VOID.</p>
<p>You might address this by decaying your null value before passing it to OPT.</p>
<pre><code>&gt;&gt; opt decay split-path %bar.txt
== ~[]~  ; anti
</code></pre>
<p>This is a bit of a bummer.  Making OPT decay things removes a safeguard I was fond of, which is catching situations where you expected a branching construct to produce something if it ran:</p>
<pre><code>&gt;&gt; compose [a (? if 1 &lt; 2 [... code that inadvertently makes null ...]) c]
== [a c]
</code></pre>
<p>My feeling here is that the ? isn't a carte-blanche on null-producing branches... it's to address the fact that we have to make IF return null instead of void (as void triggers THEN and not ELSE, by design).</p>
<h2><a name="p-8206-are-there-just-different-types-of-opt-2" class="anchor" href="2435.html#p-8206-are-there-just-different-types-of-opt-2"></a>Are There Just Different Types Of OPT</h2>
<p>The default OPT(IONAL) has to be willing to decay a pack that's got a ~null~ in the first slot.</p>
<p>But maybe the ? form refuses to and gives an informative error.... <em>to say the null arose from a branch, not from the failure to execute a branch.</em></p>
<p>If it were done with a refinement it would be OPT:LIGHT, I guess (?)</p>
<p>(Because I think PURE will be coming soon for pure functions with no side-effects, I want to stop saying "pure null" for a null that's not in a pack.  I'm okay calling it "light null" compared to "heavy null" because the terms aren't really used elsewhere.)</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-05-10T04:17:25Z' class='post-time'>
                    May 10, 2025,  4:17am
                  </time>
                  <meta itemprop='dateModified' content='2025-05-10T04:19:46Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="2435">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>But maybe the ? form refuses to and gives an informative error.... <em>to say the null arose from a branch, not from the failure to execute a branch.</em></p>
<p>If it were done with a refinement it would be OPT:LIGHT, I guess (?)</p>
</blockquote>
</aside>
<p>So my point here is about suppressing the wrong thing.  I'm not as worried about the branch consciously returning null as I am about it returning some other definitional error, that opt suppresses:</p>
<pre><code>append [a b c] opt case [
    condition1 [... 1 / 0]
    condition2 [...]
]
</code></pre>
<p>The OPT is supposed to get you a VOID from not matching any cases, it's not supposed to be vanishing divide by zero errors on a branch that ran.</p>
<h2><a name="p-8236-all-right-try-has-to-be-taken-out-of-opt-1" class="anchor" href="2435.html#p-8236-all-right-try-has-to-be-taken-out-of-opt-1"></a>All Right, TRY Has To Be Taken Out of OPT</h2>
<pre><code>&gt;&gt; append [a b c] opt pick [a b c] 'd
** Error: Invalid pick 'd in BLOCK
</code></pre>
<p>It doesn't look that bad to say both words, or use the ? abbreviation for OPT:</p>
<pre><code>&gt;&gt; append [a b c] optional try pick [a b c] 'd
== [a b c]

&gt;&gt; append [a b c] opt try pick [a b c] 'd
== [a b c]

&gt;&gt; append [a b c] ? try pick [a b c] 'd
== [a b c]
</code></pre>
<p>BUT there can be an intrinsic version of the combined operation which is aliased as <strong>??</strong>.</p>
<pre><code>&gt;&gt; append [a b c] ? pick [a b c] 'd
** Error: Invalid pick 'd in BLOCK

&gt;&gt; append [a b c] ?? pick [a b c] 'd
== [a b c]
</code></pre>
<p>Seems to me that breaks the intent down pretty well.  Also, this ties into my idea for a VETO operation, which would be <strong>?!</strong> or <strong>??!</strong> ... but I'm getting ahead of myself.  <img src="../../images/emoji/twitter/wink.png%3Fv=14" title=":wink:" class="emoji" alt=":wink:" loading="lazy" width="20" height="20"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
