<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>OBDC, Excel and memory allocation problems - Databases - AltRebol</title>
    <meta name="description" content="Error: Couldn&amp;#39;t allocate column buffer 
Hi there! First time posting on a Rebol/Ren-C/Red forum, I hope this is the right place for my question. I have been testing the ODBC functionality in Ren-C build 2.102.0.3.1 from 1&amp;hellip;">
    <meta name="generator" content="Discourse 3.5.0.beta6-dev - https://github.com/discourse/discourse version 623cde985b21c2ed812b83d3ea94f69231613718">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="280.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

    <link href="https://rebol.metaeducation.com/stylesheets/color_definitions_base__2_ceb61c279a74dfa3cef6a62f7784988102abec82.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" class="light-scheme"/>

<link href="https://rebol.metaeducation.com/stylesheets/common_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common"  />

  <link href="https://rebol.metaeducation.com/stylesheets/desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="desktop"  />



    <link href="https://rebol.metaeducation.com/stylesheets/chat_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-details_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-lazy-videos_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-local-dates_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-narrative-bot_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-presence_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="https://rebol.metaeducation.com/stylesheets/docker_manager_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="https://rebol.metaeducation.com/stylesheets/footnote_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll"  />
    <link href="https://rebol.metaeducation.com/stylesheets/spoiler-alert_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="https://rebol.metaeducation.com/stylesheets/chat_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat_desktop"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://rebol.metaeducation.com/stylesheets/common_theme_2_57fe803ed5a41e9f7d94086afaf66a1aab57d9ae.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="2" data-theme-name="default"/>
    

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;OBDC, Excel and memory allocation problems&#39;" href="280.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://rebol.metaeducation.com/t/obdc-excel-and-memory-allocation-problems/280" />
<meta name="twitter:url" content="https://rebol.metaeducation.com/t/obdc-excel-and-memory-allocation-problems/280" />
<meta property="og:title" content="OBDC, Excel and memory allocation problems" />
<meta name="twitter:title" content="OBDC, Excel and memory allocation problems" />
<meta property="og:description" content="Error: Couldn&#39;t allocate column buffer  Hi there! First time posting on a Rebol/Ren-C/Red forum, I hope this is the right place for my question. I have been testing the ODBC functionality in Ren-C build 2.102.0.3.1 from 10-Aug-2017/5:25:53 on Windows 10 Pro.  Is there any way how to increase the available memory for the ODBC query? Because I have some kind of memory allocation problem while running my queries..  &gt;&gt; insert conn-port &quot;select * from [Sheet0$] where Meno = &#39;ALENA&#39;&quot; ** Error: Couldn&#39;..." />
<meta name="twitter:description" content="Error: Couldn&#39;t allocate column buffer  Hi there! First time posting on a Rebol/Ren-C/Red forum, I hope this is the right place for my question. I have been testing the ODBC functionality in Ren-C build 2.102.0.3.1 from 10-Aug-2017/5:25:53 on Windows 10 Pro.  Is there any way how to increase the available memory for the ODBC query? Because I have some kind of memory allocation problem while running my queries..  &gt;&gt; insert conn-port &quot;select * from [Sheet0$] where Meno = &#39;ALENA&#39;&quot; ** Error: Couldn&#39;..." />
<meta property="og:article:section" content="Domains" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="og:article:section" content="Databases" />
<meta property="og:article:section:color" content="F1592A" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="6 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="2 ❤" />
<meta property="article:published_time" content="2017-08-31T09:29:41+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://rebol.metaeducation.com/">AltRebol</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="280.html">OBDC, Excel and memory allocation problems</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/domains/other-database/27" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Domains</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/domains/other-database/27" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Databases</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='OBDC, Excel and memory allocation problems'>
      <link itemprop='url' href='280.html'>
      <meta itemprop='datePublished' content='2017-08-31T09:29:41Z'>
        <meta itemprop='articleSection' content='Databases'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/orr721.html'><span itemprop='name'>orr721</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="280.html">


              <span class="crawler-post-infos">
                  <time  datetime='2017-08-31T09:29:41Z' class='post-time'>
                    August 31, 2017,  9:29am
                  </time>
                  <meta itemprop='dateModified' content='2020-07-03T16:14:06Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><strong>Error: Couldn't allocate column buffer</strong></p>
<p>Hi there! First time posting on a Rebol/Ren-C/Red forum, I hope this is the right place for my question. I have been testing the ODBC functionality in <em>Ren-C build 2.102.0.3.1</em> from <strong>10-Aug-2017/5:25:53</strong> on Windows 10 Pro.</p>
<p>Is there any way how to increase the available memory for the ODBC query? Because I have some kind of memory allocation problem while running my queries..</p>
<pre><code>&gt;&gt; insert conn-port "select * from [Sheet0$] where Meno = 'ALENA'"
** Error: Couldn't allocate column buffer!
** Where: insert-odbc --anonymous-- insert
** Near: reduce compose [(sql)] ??
</code></pre>
<p>The query should return 1 record from an XLSX file with 13 columns, where 2 of the columns contain strings longer than 1500 characters. When I run the select query without these two columns the query runs fine and I receive my data.</p>
<p>I am a bit confused with this problem because in Rebol2/View I can run the same query with all 100 records (without the <code>where</code> clause) in a single statement without any memory problems. Am I missing something or is it a bug in the ODBC Ren-C implementation? Thank you very much for an answer and for your excellent work.</p>
<p>P.S. running TRACE ON crashes the executable immediately..</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../testing-odbc-branch/114/20.html">Testing ODBC branch</a>
                        <meta itemprop='position' content='1'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/gchiu'><span itemprop='name'>gchiu</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-31T10:21:16Z' class='post-time'>
                    August 31, 2017, 10:21am
                  </time>
                  <meta itemprop='dateModified' content='2017-08-31T10:21:16Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Can you try casting the result eg varchar(1500) ?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-31T22:01:05Z' class='post-time'>
                    August 31, 2017, 10:01pm
                  </time>
                  <meta itemprop='dateModified' content='2017-08-31T22:01:05Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group quote-modified" data-username="orr721" data-post="20" data-topic="114">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/orr721/48/235_2.png" class="avatar"><a href="../testing-odbc-branch/114/20.html">Testing ODBC branch</a></div>
<blockquote>
<p>Hi there! First time posting on a Rebol/Ren-C/Red forum, I hope this is the right place for my question.</p>
</blockquote>
</aside>
<p>Welcome!  Yes, this is a good place to ask questions regarding Rebol.  I was once a skeptic of the idea of making a forum <em>(I preferred <a href="https://chat.stackoverflow.com/rooms/291/rebol">our chat</a>, GitHub Issues, <a href="https://trello.com/b/l385BE7a/rebol3-porting-guide-ren-c-branch">Trello</a>, <a href="https://stackoverflow.com/questions/tagged/rebol">StackOverflow Q&amp;A</a>...)</em> and wondered if it would just be a burden to have another "place".  But I think it turned out to be a good medium for longer-attention-span discussions that don't fit elsewhere.</p>
<p><em>(Note that for Red, they do most of their support on Gitter... <a href="https://gitter.im/red/home">here is their list of rooms</a>)</em></p>
<aside class="quote no-group quote-post-not-found" data-username="orr721" data-post="23" data-topic="114">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/orr721/48/235_2.png" class="avatar"><a href="../testing-odbc-branch/114/23.html">Testing ODBC branch</a></div>
<blockquote>
<p>The question remains though, shouldn't it work automatically like in Rebol2/View?</p>
</blockquote>
</aside>
<p>The ODBC support was an attempt by me to get the ball rolling by hacking on an <a href="https://github.com/gurzgri/r3-odbc">R3-Alpha extension written by Christian Ensel</a> so that it could work in a minimal sense.  I don't know how true that extension was to Rebol2, as I have no real experience with historical ODBC in Rebol <em>(I did not arrive on the scene until the R3 times)</em>.</p>
<p>So over the span of a week or so I managed to get something going, against MySQL's ODBC driver on Windows.  I concocted a single test file to see what it could do:</p>
<p><a href="https://github.com/metaeducation/ren-c/blob/master/tests/misc/odbc-test.reb" class="onebox" target="_blank" rel="noopener">https://github.com/metaeducation/ren-c/blob/master/tests/misc/odbc-test.reb</a></p>
<p>That's about as far as we've gotten, though it's better than nothing!!</p>
<p>So I don't presume to know what it should or should not do.  It's mostly on those in the community who have a stake to come in and say what it would take for them to feel engaged and want to be involved.  I've got a lot of questions about the PORT! design in the first place, and I also feel like there's a lot more STRING! use than I'd like to see for a dialect.  One of Rebol's strengths is supposed to be DSLs, so it would seem a smoother and more integrated SQL using WORD!s and such would be an objective...</p>
<p>We could definitely use some more developers to hack on it with us.  C programmers would be great <img src="../../images/emoji/twitter/slight_smile.png%3Fv=14" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"> but even writing tests and defining what it <em>should</em> do helps.</p>
<p>In any case, please feel free to introduce yourself and your stake in the project here!</p>
<aside class="quote" data-post="1" data-topic="197">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/gchiu/48/22_2.png" class="avatar">
    <a href="../introductions-who-am-i/197.html">Introductions - who am I?</a> <a class="badge-category__wrapper " href="https://rebol.metaeducation.com/c/community/11"><span data-category-id="11" style="--category-badge-color: #12A89D; --category-badge-text-color: #FFFFFF;" data-drop-close="true" class="badge-category " title="Topics regarding people, projects, and websites in the Rebol community."><span class="badge-category__name">Community</span></span></a>
  </div>
  <blockquote>
    If you're using a pseudonym here, then we'd appreciate it if you would post a little about your experience with Rebol.  And of course, if you're a long time Rebol user back from whenever, and have been on the mailing list etc, then feel free to mention this. 
Thanks. 
PS: Please add any Github or other Repos, and LinkedIn if you wish.
  </blockquote>
</aside>

            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/orr721.html'><span itemprop='name'>orr721</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-31T11:01:30Z' class='post-time'>
                    August 31, 2017, 11:01am
                  </time>
                  <meta itemprop='dateModified' content='2017-08-31T11:01:30Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <blockquote>
<p>Can you try casting the result eg varchar(1500) ?</p>
</blockquote>
<p>I am sorry, you have to help me a bit here, because I don't know how to do that.</p>
<p>Anyway I have checked the column properties and there is something strange with the 2 mentioned columns:</p>
<pre><code>&gt;&gt; insert conn-port ['columns "Sheet0$"]
== [TABLE_CAT TABLE_SCHEM TABLE_NAME COLUMN_NAME DATA_TYPE TYPE_NAME COLUMN_SIZE BUFFER_LENGTH DECIMAL_DIGITS NUM_PREC_RADIX NULLABLE REMARKS COLUMN_DEF SQL_DATA_TYPE SQL_DATETIME_SUB CHAR_OCTET_LENGTH ORDINAL_POSITION IS_NULLABLE ORDINAL]

&gt;&gt; copy conn-port
== [["C:\exp.xlsx" _ "Sheet0$" "Priezvisko" -9 "VARCHAR" 255 510 _ _ 1 _ _ -9 _ 510 1 "YES" 1]
["C:\exp.xlsx" _ "Sheet0$" "Meno" -9 "VARCHAR" 255 510 _ _ 1 _ _ -9 _ 510 2 "YES" 2]

--snip--

["C:\exp.xlsx" _ "Sheet0$" "Nález" -1 _ 1073741824 1073741824 _ _ 1 _ _ -1 _ 1073741824 7 "YES" 7]
["C:\exp.xlsx" _ "Sheet0$" "Záver" -1 _ 1073741824 1073741824 _ _ 1 _ _ -1 _ 1073741824 8 "YES" 8]

 --snip--
        ]
</code></pre>
<p>The problematic columns are "Nález" and "Záver".</p>
<p>Thank you very much.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/orr721.html'><span itemprop='name'>orr721</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-31T15:00:54Z' class='post-time'>
                    August 31, 2017,  3:00pm
                  </time>
                  <meta itemprop='dateModified' content='2017-08-31T15:00:54Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Whoa, after some googling I have found that this works:</p>
<pre><code>insert conn-port "select Meno, {fn convert(Nález, SQL_VARCHAR)} as nalez, {fn convert(Záver, SQL_VARCHAR)} as zaver from [Sheet0$]"
== [Meno nalez zaver]
</code></pre>
<p>So thanks for the pointers. The question remains though, shouldn't it work automatically like in Rebol2/View?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/gchiu'><span itemprop='name'>gchiu</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-31T23:12:22Z' class='post-time'>
                    August 31, 2017, 11:12pm
                  </time>
                  <meta itemprop='dateModified' content='2017-08-31T23:12:22Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group quote-post-not-found" data-username="orr721" data-post="23" data-topic="114">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/orr721/48/235_2.png" class="avatar"><a href="../testing-odbc-branch/114/23.html">Testing ODBC branch</a></div>
<blockquote>
<p>So thanks for the pointers. The question remains though, shouldn't it work automatically like in Rebol2/View?</p>
</blockquote>
</aside>
<p>Rebol2 was a mature product of many decades of work.  We don't have the source code but it would seem some of its magic was not safe!</p>
<p>The error message suggested that the ODBC driver was not allocating enough memory for an unexpected result hence my suggestion that you cast the result first so that the driver would know to allocate the right amount of memory.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/orr721.html'><span itemprop='name'>orr721</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-31T23:25:51Z' class='post-time'>
                    August 31, 2017, 11:25pm
                  </time>
                  <meta itemprop='dateModified' content='2017-08-31T23:25:51Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Well, unfortunately I was a bit too quick in making my conclusions. It works, but after the typecast the big columns are truncated to 255 chars.</p>
<p>This specific ODBC driver supports VARCHAR only for length 255 and no other types for larger strings are available (i.e. no LONGVARCHAR, BLOB, etc.).</p>
<pre><code>&gt;&gt; insert conn-port ['types]
== [TYPE_NAME DATA_TYPE COLUMN_SIZE LITERAL_PREFIX LITERAL_SUFFIX CREATE_PARAMS NULLABLE CASE_SENSITIVE SEARCHABLE UNSIGNED_ATTRIBUTE FIXED_PREC_SCALE AUTO_UNIQUE_VALUE LOCAL_TYPE_NAME MINIMUM_SCALE MAXIMUM_SCALE SQL_DATA_TYPE SQL_DATETIME_SUB NUM_PREC_RADIX INTERVAL_PRECISION]                                                                                                          
                                                                                                                                
&gt;&gt; copy conn-port
== [["LOGICAL" -7 1 _ _ _ 0 0 2 _ 0 _ _ 0 0 -7 _ _ _] ["CURRENCY" 2 19 _ _ _ 1 0 2 0 1 0 _ 4 4 2 _ 10 _] ["NUMBER" 8 53 _ _ _ 1 0 2 0 0 0 _ _ _ 8 _ 2 _] ["VARCHAR" 12 255 "'" "'" _ 1 1 3 _ 0 _ _ _ _ 12 _ _ _] ["DATETIME" 93 19 "#" "#" _ 1 0 2 _ 0 _ _ 0 0 9 3 _ _]]  
</code></pre>
<p>While the ODBC driver itself can work with the big columns without any problems (even though the datatype itself is "unsupported") I have not found a way how to tell the Ren-C ODBC module to accept it. Unfortunately I am not much of a C programmer and really can't fix any C code.</p>
<p>I have tested various SQL string operations and all work with the full column data, i.e. beyond the 255 char limit. So a potential work-around would be to split the big columns in SQL to several 255 char parts and then join them back in Ren-C. Or go back to Rebol2/View where it strangely enough doesn't have this problem.</p>
<p>Regarding myself, I use Rebol mostly for scripting short "glue" code to collect data from various sources, modify it and export it for further use in databases, making statistics, etc. I like it very much because it is small, multiplatform (I have used it on Solaris, NetBSD, MS Windows, Linux, MacOSX, even classic MacOS, ...), it is dynamic, easy to use, etc.. A real swiss army knife for any quick work. I have to admit I still fight with the parse rules for string processing so sometimes I use awk (which is an excellent small tool as well).</p>
<p>Thanks again!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/gchiu'><span itemprop='name'>gchiu</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-31T23:44:38Z' class='post-time'>
                    August 31, 2017, 11:44pm
                  </time>
                  <meta itemprop='dateModified' content='2017-08-31T23:44:38Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>If you're trying to do "SQL" on an Excel file, then I'd suggest you consider using Ashley's <a href="http://www.dobeash.com/munge.html">munge</a> script which he has made compatible with r3/Ren-c.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/orr721.html'><span itemprop='name'>orr721</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-08-31T23:52:52Z' class='post-time'>
                    August 31, 2017, 11:52pm
                  </time>
                  <meta itemprop='dateModified' content='2017-08-31T23:52:52Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Yeah, I have tried. But even after reinstalling MS Office, installing the dependencies, it doesn't work for me (I have tried yesterday). But I have to admit I do have a strange combination of Office 2003 and Office 2010 Starter on my Windows computer so I am not complaining.</p>
<p>ODBC seemed to me like a more universal, cleaner and faster way. Hey, and it mostly works! <img src="../../images/emoji/twitter/slight_smile.png%3Fv=14" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_10' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-01T02:54:27Z' class='post-time'>
                    September 1, 2017,  2:54am
                  </time>
                  <meta itemprop='dateModified' content='2017-09-01T03:17:46Z'>
              <span itemprop='position'>10</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="orr721" data-post="7" data-topic="280">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/orr721/48/235_2.png" class="avatar"> orr721:</div>
<blockquote>
<p>This specific ODBC driver supports VARCHAR only for length 255 and no other types for larger strings are available (i.e. no LONGVARCHAR, BLOB, etc.).</p>
</blockquote>
</aside>
<aside class="quote no-group" data-username="orr721" data-post="7" data-topic="280">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/orr721/48/235_2.png" class="avatar"> orr721:</div>
<blockquote>
<p>While the ODBC driver itself can work with the big columns without any problems (even though the datatype itself is "unsupported") I have not found a way how to tell the Ren-C ODBC module to accept it.</p>
</blockquote>
</aside>
<p>I'm not that surprised if SQL statements issued to some random "database" willingly works with an overlong VARCHAR(255), because you're just throwing instructions over to the database; it does all the work on its side, and there's not any issue with whether ODBC understands what it's asking.</p>
<p>What I might find surprising would be if the type indicator is formally marked VARCHAR(255) in its specification, yet using some clients it returns longer than 255 and this is tolerated...and for instance Rebol2 is such a client?  Are you sure?  <img src="../../images/emoji/twitter/frowning.png%3Fv=14" title=":frowning:" class="emoji" alt=":frowning:" loading="lazy" width="20" height="20"></p>
<p>It might be possible, though sketchy.  The way ODBC works, is that you provide memory buffers of sufficient size for each column, in a process called binding.  It is the case that for some types, if you provide too small a buffer, you can get back a status code indicating this... SQL_SUCCESS_WITH_INFO with SQLSTATE 01004 (Data truncated)</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://learn.microsoft.com/en-us/sql/odbc/reference/develop-app/data-length-buffer-length-and-truncation?view=sql-server-ver16">
  <header class="source">

      <a href="https://learn.microsoft.com/en-us/sql/odbc/reference/develop-app/data-length-buffer-length-and-truncation?view=sql-server-ver16" target="_blank" rel="noopener">learn.microsoft.com</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/362;"><img src="https://learn.microsoft.com/en-us/media/open-graph-image.png" class="thumbnail" width="690" height="362"></div>

<h3><a href="https://learn.microsoft.com/en-us/sql/odbc/reference/develop-app/data-length-buffer-length-and-truncation?view=sql-server-ver16" target="_blank" rel="noopener">Data Length, Buffer Length, and Truncation - ODBC API Reference</a></h3>

  <p>Data Length, Buffer Length, and Truncation</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>It says:</p>
<blockquote>
<p>When data truncation occurs, the application can sometimes allocate a larger buffer and refetch the data; <strong>this is not true in all cases.</strong> (emphasis mine)</p>
</blockquote>
<p>The routine that would be returning SQLSTATE 01004 would be, I guess, SQLFetch...here:</p>
<aside class="onebox githubblob" data-onebox-src="https://github.com/metaeducation/ren-c/blob/804618c1a0b5bc1554c9622b21da5a7011721e78/src/extensions/odbc/mod-odbc.c#L1296">
  <header class="source">

      <a href="https://github.com/metaeducation/ren-c/blob/804618c1a0b5bc1554c9622b21da5a7011721e78/src/extensions/odbc/mod-odbc.c#L1296" target="_blank" rel="noopener">github.com/metaeducation/ren-c</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/metaeducation/ren-c/blob/804618c1a0b5bc1554c9622b21da5a7011721e78/src/extensions/odbc/mod-odbc.c#L1296" target="_blank" rel="noopener">src/extensions/odbc/mod-odbc.c</a></h4>

<div class="git-blob-info">
  <a href="https://github.com/metaeducation/ren-c/blob/804618c1a0b5bc1554c9622b21da5a7011721e78/src/extensions/odbc/mod-odbc.c#L1296" rel="noopener"><code>804618c1a</code></a>
</div>


  This file is binary. <a href="https://github.com/metaeducation/ren-c/blob/804618c1a0b5bc1554c9622b21da5a7011721e78/src/extensions/odbc/mod-odbc.c#L1296" target="_blank" rel="noopener">show original</a>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>So the deal would be that it's possible to notice you've been lied to about the length and a field wound up truncated, update the binding, and then fetch again perhaps.  Of course you're operating in an inconsistent world, where the length limit is a lie, and I'd certainly think it's something any given ODBC client or driver would consider undefined behavior.</p>
<p>If you've got proof it's being done then it has been done, though it would help if that proof came along with source code to see how they were doing it.  Hence if you can point to an open source application which has the feature, that would be more useful.</p>
<p>All this said, I don't know how much work we can promise.  We'd like to have more participants here, but we don't really have a huge developer "budget" for things beyond our core focus unless people are willing to contribute in kind.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_11' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/orr721.html'><span itemprop='name'>orr721</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-01T07:25:03Z' class='post-time'>
                    September 1, 2017,  7:25am
                  </time>
                  <meta itemprop='dateModified' content='2017-09-01T07:25:03Z'>
              <span itemprop='position'>11</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>These are the column properties ODBC is reporting for the big columns (see my second post):</p>
<pre><code>TABLE_CAT C:\exp.xlsx
TABLE_SCHEM
TABLE_NAME Sheet0$
COLUMN_NAME Nález
DATA_TYPE -1
TYPE_NAME
COLUMN_SIZE 1073741824
BUFFER_LENGTH 1073741824
DECIMAL_DIGITS
NUM_PREC_RADIX
NULLABLE 1
REMARKS
COLUMN_DEF
SQL_DATA_TYPE -1
SQL_DATETIME_SUB
CHAR_OCTET_LENGTH 1073741824
ORDINAL_POSITION 7
IS_NULLABLE YES
ORDINAL 7
</code></pre>
<p>Please notice TYPE_NAME (empty), COLUMN_SIZE, BUFFER_LENGTH, CHAR_OCTET_LENGTH (1073741824).</p>
<p>So ODBC wants Ren-C to allocate 1 GB of memory and this fails. However Rebol2/View can somehow deduce that this is some kind of a special type (by the SQL_DATA_TYPE property?) and allocates just enough for it to make it work.</p>
<p>Could it be that the datatype -1 means BLOB datatype? I have tried to search through Microsoft ODBC documentation but I have found nothing. They refer to types only by their names not by the constant values.</p>
<p>This is taken from Rebol2/View, so you believe me, (the big columns are number 7 and 8)..</p>
<pre><code>&gt;&gt; insert conn-port "select * from [Sheet0$]"
&gt;&gt; rec: copy conn-port
== [[ ... ]]
&gt;&gt; reclen: copy [] foreach i rec [append reclen length? i/7] print unique sort reclen
446 478 487 495 504 510 537 570 572 575 578 584 588 624 630 645 650 651 656 658 661 663 673 678 679 691 728 730 733 744 756 76
3 801 806 809 819 821 822 828 839 844 879 887 888 907 908 927 950 969 982 996 1006 1012 1015 1033 1054 1064 1073 1074 1077 110
9 1139 1165 1179 1207 1245 1359 1384 1446 1574
&gt;&gt;
</code></pre>
<p>I will try to search for some other ODBC implementation where it works and will report. Any tips what would be the easiest to understand and to port later on? Ruby? Scheme?</p>
<p>Thanks.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_12' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/orr721.html'><span itemprop='name'>orr721</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-01T16:36:39Z' class='post-time'>
                    September 1, 2017,  4:36pm
                  </time>
                  <meta itemprop='dateModified' content='2017-09-01T16:36:39Z'>
              <span itemprop='position'>12</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I got it running in Python:</p>
<pre><code>C:\TEMP\py&gt;python
Python 3.5.0 (v3.5.0:374f501f4567, Sep 13 2015, 02:16:59) [MSC v.1900 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import pyodbc
&gt;&gt;&gt; cnxn = pyodbc.connect(r'DRIVER={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};DBQ=C:\exp.xlsx;', autocommit=True)
&gt;&gt;&gt; cur = cnxn.cursor()
&gt;&gt;&gt; cur.execute("select * from [Sheet0$]")
&lt;pyodbc.Cursor object at 0x03173E20&gt;
&gt;&gt;&gt; rows = cur.fetchall()
&gt;&gt;&gt; for r in rows:
...     print(len(r[6]), ' ', end='')
...
733  887  656  510  663  828  763  1006  982  678  927  908  1245  1074  806  661  1207  744  1139  839  537  446  756  624  879  809  763  570  1165  733  1064  821  588  1033  584  691  673  730  1446  572  907  645  819  801  1384  487  1179  1109  575  950  888  1012  673  650  844  678  1574  1077  495  996  1015  630  1359  822  679  673  969  578  1054  658  1073  504
</code></pre>
<p>The ODBC library is called <strong>pyodbc</strong> and the source is at: <a href="https://github.com/mkleehammer/pyodbc" class="inline-onebox" rel="noopener nofollow ugc">GitHub - mkleehammer/pyodbc: Python ODBC bridge</a></p>
<p>Thanks again for your consideration..</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_13' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/gchiu'><span itemprop='name'>gchiu</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-01T23:28:26Z' class='post-time'>
                    September 1, 2017, 11:28pm
                  </time>
                  <meta itemprop='dateModified' content='2017-09-01T23:28:26Z'>
              <span itemprop='position'>13</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I'd report the code you used, the data so it can be reproduced etc on github as a bug in the meantime.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_14' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/orr721.html'><span itemprop='name'>orr721</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-03T02:06:27Z' class='post-time'>
                    September 3, 2017,  2:06am
                  </time>
                  <meta itemprop='dateModified' content='2017-09-03T02:06:27Z'>
              <span itemprop='position'>14</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I did some more digging..</p>
<ol>
<li>The memory allocation problem is not Ren-C specific at all. There are several reports from people having the same problem:</li>
</ol>
<ul>
<li>in PHP: <a href="https://bugs.php.net/bug.php?id=68964" class="inline-onebox" rel="noopener nofollow ugc">PHP :: Bug #68964 :: Allowed memory size exhausted with odbc_exec</a>,</li>
<li>in MySQL: <a href="https://forums.mysql.com/read.php?10,618038,618760" rel="noopener nofollow ugc">https://forums.mysql.com/read.php?10,618038,618760</a>,</li>
<li>in a ODBC bridge: <a href="http://www.easysoft.com/support/kb/kb00712.html" class="inline-onebox" rel="noopener nofollow ugc">Why do I get "[unixODBC][Easysoft ODBC (Server)]Memory allocation error"?</a>).</li>
</ul>
<ol start="2">
<li>
<p>According to Microsoft ODBC <a href="https://github.com/Microsoft/ODBC-Specification/blob/0583d997331a898bb0077e3cb58e210ced3a5ff1/Windows/inc/sqlext.h" rel="noopener nofollow ugc">sqlext.h</a> header file, the <code>SQL_DATA_TYPE -1</code> corresponds to <code>SQL_LONGVARCHAR</code>. This data-type has no fixed length limit, hence the ODBC reported <code>BUFFER_LENGTH</code> and <code>COLUMN_SIZE</code> of <code>1073741824</code> (which equals 1 GB).</p>
</li>
<li>
<p>So i think the problematic code is the line number <code>834</code> of the <code>ODBC_BindColumns</code> function in the <code>ren-c/src/extensions/odbc/mod-odbc.c</code> file, where the buffer size is determined:</p>
<p>case SQL_CHAR:<br>
case SQL_VARCHAR:<br>
case SQL_LONGVARCHAR: // <a href="https://stackoverflow.com/a/9547441" class="inline-onebox" rel="noopener nofollow ugc">What is a practical use for LONG VARCHAR instead of VARCHAR in Derby DB? - Stack Overflow</a></p>
<p>--snip--</p>
<pre><code> c-&gt;c_type = SQL_C_WCHAR;
</code></pre>
<p>--snip--</p>
<p>c-&gt;buffer_size = sizeof(WCHAR) * (c-&gt;column_size + 1);<br>
break;</p>
</li>
<li>
<p>The Microsoft recommended way how to handle this data-type is to use maximum allowed string size or a maximum known size of the source data. I have checked for Excel where the maximum cell size is 32K. It could be different (larger) for other ODBC databases. Actually that <a href="https://stackoverflow.com/a/9547441" class="inline-onebox" rel="noopener nofollow ugc">What is a practical use for LONG VARCHAR instead of VARCHAR in Derby DB? - Stack Overflow</a> reference talks about the 32K limit but as far as I can tell it is not enforced anywhere in the <code>mod-odbc.c</code> code.</p>
</li>
</ol>
<p>So could some one able to compile Ren-C please devise a way how to cap the <code>column_size</code> to 32K and test it..</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_15' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-06T00:14:22Z' class='post-time'>
                    September 6, 2017, 12:14am
                  </time>
                  <meta itemprop='dateModified' content='2017-09-06T00:14:22Z'>
              <span itemprop='position'>15</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="orr721" data-post="14" data-topic="280">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/orr721/48/235_2.png" class="avatar"> orr721:</div>
<blockquote>
<p>According to Microsoft ODBC sqlext.h header file, the SQL_DATA_TYPE -1 corresponds to SQL_LONGVARCHAR. This data-type has no fixed length limit, hence the ODBC reported BUFFER_LENGTH and COLUMN_SIZE of 1073741824 (which equals 1 GB).</p>
</blockquote>
</aside>
<p>Great, thanks for looking at it and into the code itself...if people are willing to do more of that, I'm sure all this could be improved much faster!  <a href="https://github.com/metaeducation/ren-c/commit/e6718d6e36fdc11dfaba586dd4920d906cce0b40">I've committed a change</a>.</p>
<p>The Ren-C download page's HTML isn't getting updated right now, as <a class="mention" href="https://rebol.metaeducation.com/u/gchiu">@gchiu</a> is in China and is firewalled out of the place where he runs the script.  But the builds are being generated by Travis anyway, and are available by URL...if you just put the commit hash in.  e.g. if you were downloading Windows 64-bit debug, the now-outdated last link that was at on the page is:</p>
<p><a href="http://metaeducation.s3.amazonaws.com/travis-builds/0.3.40/r3-a0b5b94-debug.exe" class="onebox" target="_blank" rel="noopener">http://metaeducation.s3.amazonaws.com/travis-builds/0.3.40/r3-a0b5b94-debug.exe</a></p>
<p>But the shortened hash of the commit above (e6718d6) can be substituted:</p>
<p><a href="http://metaeducation.s3.amazonaws.com/travis-builds/0.3.40/r3-e6718d6-debug.exe" class="onebox" target="_blank" rel="noopener">http://metaeducation.s3.amazonaws.com/travis-builds/0.3.40/r3-e6718d6-debug.exe</a></p>
<p><em>(Builds should be available after all their Travis entries complete, which can take some time as the Mac builds often wait in a queue.)</em></p>
<p>Of course if people build the system themselves, then they can start making patches, and I'd argue we're doing a reasonable job of keeping it the kind of C you can read with one book's worth of knowledge.  <img src="../../images/emoji/twitter/slight_smile.png%3Fv=14" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"></p>
<aside class="onebox wikipedia" data-onebox-src="https://en.wikipedia.org/wiki/The_C_Programming_Language">
  <header class="source">

      <a href="https://en.wikipedia.org/wiki/The_C_Programming_Language" target="_blank" rel="noopener">en.wikipedia.org</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:220/310;"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/The_C_Programming_Language%2C_First_Edition_Cover.svg/220px-The_C_Programming_Language%2C_First_Edition_Cover.svg.png" class="thumbnail" width="220" height="310"></div>

<h3><a href="https://en.wikipedia.org/wiki/The_C_Programming_Language" target="_blank" rel="noopener">The C Programming Language</a></h3>

<p>The C Programming Language (sometimes termed K&amp;R, after its authors' initials) is a computer programming book written by Brian Kernighan and Dennis Ritchie, the latter of whom originally designed and implemented the C programming language, as well as co-designed the Unix operating system with which development of the language was closely intertwined.  The book was central to the development and popularization of C and is still widely read and used today.  Because the book was co-authored by the o...</p>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_16' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/orr721.html'><span itemprop='name'>orr721</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-06T15:09:45Z' class='post-time'>
                    September 6, 2017,  3:09pm
                  </time>
                  <meta itemprop='dateModified' content='2017-09-06T15:09:45Z'>
              <span itemprop='position'>16</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks a lot, it is working now. <img src="../../images/emoji/twitter/grinning.png%3Fv=14" title=":grinning:" class="emoji" alt=":grinning:" loading="lazy" width="20" height="20"></p>
<p>I have even got it running under both the 32bit and 64bit versions (had to do some black magic first to have both versions of the ODBC drivers installed at the same time).</p>
<p>A minor nitpick is that the 64bit r3-e6718d6-debug.exe version reports a memory leak? after quitting:</p>
<pre><code>&gt;&gt; close c
&gt;&gt; close p

&gt;&gt; quit
*** PG_Mem_Usage = 136436 ***
Memory accounting imbalance: Rebol internally tracks how much
memory it uses to know when to garbage collect, etc.  For
some reason this accounting did not balance to zero on exit.
Run under Valgrind with --leak-check=full --track-origins=yes
to find out why this is happening.
</code></pre>
<p>I can test further if you give me any instructions.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_17' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-06T17:08:38Z' class='post-time'>
                    September 6, 2017,  5:08pm
                  </time>
                  <meta itemprop='dateModified' content='2017-09-06T17:08:38Z'>
              <span itemprop='position'>17</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="orr721" data-post="16" data-topic="280">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/orr721/48/235_2.png" class="avatar"> orr721:</div>
<blockquote>
<p>I can test further if you give me any instructions.</p>
</blockquote>
</aside>
<p>I'm not surprised there are presently leaks in the ODBC.  It really was just a first cut at taking Christian's code and getting it to build and do <em>something</em>.</p>
<p>I'm more surprised you've managed to accomplish productive work with it.  <img src="../../images/emoji/twitter/slight_smile.png%3Fv=14" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"></p>
<p>At this moment there are several higher priorities in the core, but if you're blocked by an issue please bring it up.  If your code is open source, it would also be interesting to see what you're doing and perhaps suggest how you could take advantage of new features.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_18' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../u/orr721.html'><span itemprop='name'>orr721</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-06T18:24:53Z' class='post-time'>
                    September 6, 2017,  6:24pm
                  </time>
                  <meta itemprop='dateModified' content='2017-09-06T18:24:53Z'>
              <span itemprop='position'>18</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This warning is displayed <strong>after the r3 runtime quits</strong>.</p>
<p>I was not doing anything fancy really, just run the r3-... exe REPL, opened the ODBC connection, run a simple query, closed the connection and quit. It did not crash, freeze or anything.</p>
<p>And it is only displayed by the 64bit r3-...exe. Could it be because of the -debug compile? The 32bit runtime does not have this message.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_19' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-06T21:22:41Z' class='post-time'>
                    September 6, 2017,  9:22pm
                  </time>
                  <meta itemprop='dateModified' content='2017-09-06T21:22:41Z'>
              <span itemprop='position'>19</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="orr721" data-post="18" data-topic="280">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/orr721/48/235_2.png" class="avatar"> orr721:</div>
<blockquote>
<p>This warning is displayed after the r3 runtime quits.</p>
</blockquote>
</aside>
<aside class="quote no-group" data-username="orr721" data-post="18" data-topic="280">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/orr721/48/235_2.png" class="avatar"> orr721:</div>
<blockquote>
<p>Could it be because of the -debug compile?</p>
</blockquote>
</aside>
<p>Yes: the memory balancing is <a href="https://github.com/metaeducation/ren-c/blob/e6718d6e36fdc11dfaba586dd4920d906cce0b40/src/core/m-pools.c#L396">only checked in the debug build</a>, and program termination is the only time you can be sure the memory isn't being held onto for later use.  A 32-bit debug build would have the same issue.</p>
<p>If you're only getting the message when you've run an ODBC query, then that's where the problem nearly certainly is.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_20' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/gchiu'><span itemprop='name'>gchiu</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-09-16T09:34:27Z' class='post-time'>
                    September 16, 2017,  9:34am
                  </time>
                  <meta itemprop='dateModified' content='2017-09-16T09:34:27Z'>
              <span itemprop='position'>20</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>These are the listed ODBC bugs <a href="https://github.com/metaeducation/ren-c/issues?utf8=%E2%9C%93&amp;q=is%3Aissue%20is%3Aopen%20odbc">I found</a>.  If you've found another, please report it so that it can be eventually fixed.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
