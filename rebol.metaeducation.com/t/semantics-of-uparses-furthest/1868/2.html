<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Semantics of UPARSE&#39;s FURTHEST - #2 by hostilefork - Parsing - AltRebol</title>
    <meta name="description" content="Upon the announcement of UPARSE, @Brett listed as his secondmost missing feature the idea of knowing &amp;quot;how far a parse got&amp;quot;: 


An ability to return the furthest input point matched and the rule that caused rollback from &amp;hellip;">
    <meta name="generator" content="Discourse 3.5.0.beta6-dev - https://github.com/discourse/discourse version 623cde985b21c2ed812b83d3ea94f69231613718">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="../1868.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="AltRebol Search">

    <link href="https://rebol.metaeducation.com/stylesheets/color_definitions_base__2_ceb61c279a74dfa3cef6a62f7784988102abec82.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" class="light-scheme"/>

<link href="https://rebol.metaeducation.com/stylesheets/common_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common"  />

  <link href="https://rebol.metaeducation.com/stylesheets/desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="desktop"  />



    <link href="https://rebol.metaeducation.com/stylesheets/chat_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-details_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-lazy-videos_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-local-dates_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-narrative-bot_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-presence_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="https://rebol.metaeducation.com/stylesheets/docker_manager_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="https://rebol.metaeducation.com/stylesheets/footnote_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll"  />
    <link href="https://rebol.metaeducation.com/stylesheets/spoiler-alert_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="https://rebol.metaeducation.com/stylesheets/chat_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat_desktop"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://rebol.metaeducation.com/stylesheets/common_theme_2_57fe803ed5a41e9f7d94086afaf66a1aab57d9ae.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="2" data-theme-name="default"/>
    

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Semantics of UPARSE&#39;s FURTHEST&#39;" href="../1868.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://rebol.metaeducation.com/t/semantics-of-uparses-furthest/1868/2" />
<meta name="twitter:url" content="https://rebol.metaeducation.com/t/semantics-of-uparses-furthest/1868/2" />
<meta property="og:title" content="Semantics of UPARSE&#39;s FURTHEST" />
<meta name="twitter:title" content="Semantics of UPARSE&#39;s FURTHEST" />
<meta property="og:description" content="Giving back FURTHEST as a multi-return had to be axed, for several reasons.  ðŸª“  For one thing: PARSE now raises a definitional error when it does not reach the end of input.  Returning an error isotope is fundamentally incompatible with unpacking return values from a returned block isotope, you can&#39;t do both!  And secondly: PARSE is designed to allow you to use the full bandwidth of return values, including multi-returns.  This means combinators themselves might be multi-returns (I&#39;ve sugge..." />
<meta name="twitter:description" content="Giving back FURTHEST as a multi-return had to be axed, for several reasons.  ðŸª“  For one thing: PARSE now raises a definitional error when it does not reach the end of input.  Returning an error isotope is fundamentally incompatible with unpacking return values from a returned block isotope, you can&#39;t do both!  And secondly: PARSE is designed to allow you to use the full bandwidth of return values, including multi-returns.  This means combinators themselves might be multi-returns (I&#39;ve sugge..." />
<meta property="og:article:section" content="Domains" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="og:article:section" content="Parsing" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="article:published_time" content="2023-11-02T04:54:49+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://rebol.metaeducation.com/">AltRebol</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="../1868.html">Semantics of UPARSE&#39;s FURTHEST</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/domains/parsing/16" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Domains</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/domains/parsing/16" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Parsing</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Semantics of UPARSE&#39;s FURTHEST'>
      <link itemprop='url' href='../1868.html'>
      <meta itemprop='datePublished' content='2022-07-09T12:21:05Z'>
        <meta itemprop='articleSection' content='Parsing'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>

          <span itemprop='author' itemscope itemtype="http://schema.org/Person">
            <meta itemprop='name' content='hostilefork'>
            <link itemprop='url' rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'>
          </span>
        <meta itemprop='text' content='Upon the announcement of UPARSE, @Brett listed as his secondmost missing feature the idea of knowing &amp;quot;how far a parse got&amp;quot;: 


An ability to return the furthest input point matched and the rule that caused rollback from &amp;hellip;'>

          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-11-02T04:54:49Z' class='post-time'>
                    November 2, 2023,  4:54am
                  </time>
                  <meta itemprop='dateModified' content='2023-11-02T05:02:11Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="1868">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>I made <strong>FURTHEST</strong> a multi-return value. The hooked combinators are run, and then if they succeed they're checked to see if they got further than any previous combinator. If so they update furthest.</p>
<pre><code>&gt;&gt; [_ furthest]: uparse "aaabbb" [some "a" some "c"]
; null

 &gt;&gt; furthest
 == "bbb"
</code></pre>
</blockquote>
</aside>
<p><strong>Giving back FURTHEST as a multi-return had to be axed, for several reasons.</strong></p>
<p><img src="../../../images/emoji/twitter/axe.png%3Fv=14" title=":axe:" class="emoji only-emoji" alt=":axe:" loading="lazy" width="20" height="20"></p>
<p>For one thing: <strong><a href="../../try-parse-parse-except-fail-on-mismatch/1924.html">PARSE now raises a definitional error when it does not reach the end of input.</a></strong>  Returning an error isotope is fundamentally incompatible with unpacking return values from a returned block isotope, you can't do both!</p>
<p>And secondly: PARSE is designed to allow you to use the full bandwidth of return values, including multi-returns.  This means combinators themselves might be multi-returns <em>(I've suggested TALLY could be a multi-returner, giving the count as a primary product but also including the synthesized product)</em>:</p>
<pre><code> &gt;&gt; [count result]: parse "aaa" [tally ["a" ('a)] | tally ["b" ('b)]]]
 == 3

 &gt;&gt; count
 == 3

 &gt;&gt; result
 == a
</code></pre>
<p>Or you can just explicitly evaluate to a muti-return PACK from a group evaluation, for whatever reason...</p>
<pre><code>parse "..." [... accept (pack [&lt;a&gt; 2]) ...]
</code></pre>
<h2><a name="p-6721-stop-gap-measure-a-crappy-furthest-hook-1" class="anchor" href="2.html#p-6721-stop-gap-measure-a-crappy-furthest-hook-1"></a>Stop-Gap Measure: a "Crappy" FURTHEST Hook</h2>
<p>An early adaptation of <a class="mention" href="https://rebol.metaeducation.com/u/blackattr">@BlackATTR</a>'s Query had used the FURTHEST return value from UPARSE.  But that needed to backtrack into painful inclusion of <strong><code>furthest: &lt;here&gt;</code></strong> markers in every rule.  That's no good.</p>
<p>But UPARSE's generic hookability allows for a <strong><a href="../../visualizing-parse/1639/8.html">rule-stepwise debugger</a></strong> <img src="../../../images/emoji/twitter/eyes.png%3Fv=14" title=":eyes:" class="emoji" alt=":eyes:" loading="lazy" width="20" height="20"></p>
<p>So of course, simply asking how far it got is not hard to ask for.  Just use a hook which writes to a variable you specify.  I hacked this up separately as PARSE-FURTHEST:</p>
<pre><code>&gt;&gt; parse-furthest "aaabbb" [some "a" some "c"] 'far except [
       print ["Furthest was:" mold far]
   ]

Furthest was: "bbb"
</code></pre>
<p>Well, it's better than nothing!</p>
<h2><a name="p-6721-but-what-do-we-really-want-2" class="anchor" href="2.html#p-6721-but-what-do-we-really-want-2"></a>But What Do We Really Want?</h2>
<p>One way of looking at this could be that FURTHEST is a field in the error that gets returned.</p>
<pre><code>&gt;&gt; parse "aaabbb" [some "a" some "c"] except e -&gt; [
       assert [e.id = 'incomplete-parse]  ; only raised error?
       print ["Furthest was:" mold e.furthest]
   ]
</code></pre>
<p>That's not bad, other than it seems there might be a lot of things you want to know about a failed parse besides just FURTHEST.  You'd want to know the actual parse position, but other aspects about the rule state as well.  Is it too much stuff to pack into an error object?</p>
<p>You might have been keeping running track of the line and column (which I've wanted to find a way to expose via <strong><code>&lt;line&gt;</code></strong> and <strong><code>&lt;column&gt;</code></strong> combinators, where applicable).  That has to be updated as the parse proceeds, you wouldn't want to have to recalculate that in case of an error...?</p>
<p>So it seems to me that there may be need for a parse state object which can be made available to reflect after a parse that's successful -or- unsuccessful.  The PARSE function would be a convenient wrapper on top of this, but you could dig deeper for more serious needs.</p>
<p>For right now, the PARSE-FURTHEST hack keeps the mechanism behind the functionality tested, but there's clearly a lot to think about here (and I believe looking at Haskell for inspiration on these kinds of questions is wise).</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
    </div>

      <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
          <span itemprop='name'>
            <a itemprop="url" href="../1868.html#post_2">show post in topic</a>
          </span>
      </div>

    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
