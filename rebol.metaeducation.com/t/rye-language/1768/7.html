<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Rye Language - #7 by hostilefork - Redbol - AltRebol</title>
    <meta name="description" content="So here&amp;#39;s another language which doesn&amp;#39;t look very Rebol-like, but is by Refaktor who is Rebol-inspired: 


Notably, it is written in Go.  (I&amp;#39;ve mentioned that increasingly I have been leaning toward modeling things afte&amp;hellip;">
    <meta name="generator" content="Discourse 3.5.0.beta6-dev - https://github.com/discourse/discourse version 623cde985b21c2ed812b83d3ea94f69231613718">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="../1768.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="AltRebol Search">

    <link href="https://rebol.metaeducation.com/stylesheets/color_definitions_base__2_ceb61c279a74dfa3cef6a62f7784988102abec82.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" class="light-scheme"/>

<link href="https://rebol.metaeducation.com/stylesheets/common_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common"  />

  <link href="https://rebol.metaeducation.com/stylesheets/desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="desktop"  />



    <link href="https://rebol.metaeducation.com/stylesheets/chat_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-details_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-lazy-videos_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-local-dates_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-narrative-bot_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-presence_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="https://rebol.metaeducation.com/stylesheets/docker_manager_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="https://rebol.metaeducation.com/stylesheets/footnote_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll"  />
    <link href="https://rebol.metaeducation.com/stylesheets/spoiler-alert_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="https://rebol.metaeducation.com/stylesheets/chat_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat_desktop"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://rebol.metaeducation.com/stylesheets/common_theme_2_57fe803ed5a41e9f7d94086afaf66a1aab57d9ae.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="2" data-theme-name="default"/>
    

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Rye Language&#39;" href="../1768.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://rebol.metaeducation.com/t/rye-language/1768/7" />
<meta name="twitter:url" content="https://rebol.metaeducation.com/t/rye-language/1768/7" />
<meta property="og:title" content="Rye Language" />
<meta name="twitter:title" content="Rye Language" />
<meta property="og:description" content="Thought I would pick apart some native (&quot;BFunction&quot;) implementation code in Rye, just to get the gist.  A WHILE loop would be ideal, since I already contrasted R3-Alpha, Red, and Ren-C WHILE  But... uh, it turns out Rye doesn&#39;t have a normal WHILE (at least that I can find).  It has produce\while ... which is arity-3 and is some kind of folding operation.  produce/while  Accepts a while condition, initial value and a block of code. Does the block of code number times, injecting the number first ..." />
<meta name="twitter:description" content="Thought I would pick apart some native (&quot;BFunction&quot;) implementation code in Rye, just to get the gist.  A WHILE loop would be ideal, since I already contrasted R3-Alpha, Red, and Ren-C WHILE  But... uh, it turns out Rye doesn&#39;t have a normal WHILE (at least that I can find).  It has produce\while ... which is arity-3 and is some kind of folding operation.  produce/while  Accepts a while condition, initial value and a block of code. Does the block of code number times, injecting the number first ..." />
<meta property="og:article:section" content="Domains" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="og:article:section" content="Redbol" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="article:published_time" content="2024-09-24T19:43:52+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://rebol.metaeducation.com/">AltRebol</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="../1768.html">Rye Language</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/domains/redbol/47" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Domains</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/domains/redbol/47" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Redbol</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Rye Language'>
      <link itemprop='url' href='../1768.html'>
      <meta itemprop='datePublished' content='2021-12-05T16:21:46Z'>
        <meta itemprop='articleSection' content='Redbol'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>

          <span itemprop='author' itemscope itemtype="http://schema.org/Person">
            <meta itemprop='name' content='hostilefork'>
            <link itemprop='url' rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'>
          </span>
        <meta itemprop='text' content='So here&amp;#39;s another language which doesn&amp;#39;t look very Rebol-like, but is by Refaktor who is Rebol-inspired: 


Notably, it is written in Go.  (I&amp;#39;ve mentioned that increasingly I have been leaning toward modeling things afte&amp;hellip;'>

          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-09-24T19:43:52Z' class='post-time'>
                    September 24, 2024,  7:43pm
                  </time>
                  <meta itemprop='dateModified' content='2024-09-24T21:32:37Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thought I would pick apart some native ("BFunction") implementation code in Rye, just to get the gist.</p>
<p>A WHILE loop would be ideal, since I already contrasted <strong><a href="../../stackless-is-here-today-now/1844/2.html">R3-Alpha, Red, and Ren-C WHILE</a></strong></p>
<p>But... uh, it turns out Rye doesn't have a normal WHILE (at least that I can find).  It has <strong><code>produce\while</code></strong> ... which is arity-3 and is some kind of folding operation.</p>
<pre><code>produce/while

Accepts a while condition, initial value and a block of code.
Does the block of code number times, injecting the number first
and then result of block.
</code></pre>
<p>Close enough.  Here is a usage from <a href="https://github.com/refaktor/rye/blob/625283fd05334a293889cf803b8c0daed48103a9/examples/project-euler/prob002.rye">Project Euler Problem 2</a></p>
<pre><code>; 1. while with condition and a starting block
; 2. while's body: sums last 2 elements and concats result to block
; 3. last one is already greater than 4 million
; 4. filter to even numbers
; 5. sum them and print
; result: 4613732

produce\while { .last &lt; 4000000 } { 1 2 }      ; [1]
{ :b .tail 2 |sum .concat* b }                 ; [2]
|head -1                                       ; [3]
|filter { .even }                              ; [4]
|sum .print                                    ; [5]
</code></pre>
<p>So... PRODUCE\WHILE is arity-3, and starts out with a seed block of <code>{ 1 2 }</code> which is fed into the condition... and then the body.  On successive calls the body's result is fed to the condition, and then to the body again.  (The condition's result is discarded).</p>
<p>The first time it's fed into the body, it's observed that the last value in the block is &lt; 4000000.  So you have to read that sort of like:</p>
<pre><code> while (block -&gt; [(last block) &lt; 4000000]) 
</code></pre>
<p>Because there's a sort of "invisible left hand side" being fed into the block, you can either put an infix operation at the head of your block and pick it up implicitly, or use a "left set-word" as <strong>:b</strong> to capture it into a variable.  Here the condition uses a leading dot to turn LAST into an operation that takes its argument from that sneaky left.  But the body has to make a variable.</p>
<p>Okay, well, "de gustibus non est disputandum".  <img src="../../../images/emoji/twitter/man_shrugging.png%3Fv=14" title=":man_shrugging:" class="emoji" alt=":man_shrugging:" loading="lazy" width="20" height="20"></p>
<p><em>(I can't be too harsh and say I'd never use sneaky infix capture, because I have... though I'd not base a language on it: <strong><a href="../../persistence-of-memory-the-infix-console-trick/1071.html">Persistence of Memory: The Console Infix Trick</a></strong>.  But <a class="mention" href="../../../u/lkppo.html">@LkpPo</a> got confused by it so I dropped it.)</em></p>
<h2><a name="p-7775-on-to-the-go-code-1" class="anchor" href="7.html#p-7775-on-to-the-go-code-1"></a>On To The Go Code...</h2>
<p><a>Here is Rye's "BFunction" for <strong><code>PRODUCE\WHILE</code></strong></a>, formatted slightly to fit on the page here:</p>
<pre><code>"produce\\while": {
	Argsn: 3,
	Doc: "Accepts a while condition, initial value and a block of code."
         + " Does the block of code number times, injecting the number"
         + " first and then result of block.",
	Fn: func(
        ps *env.ProgramState,
        arg0 env.Object,
        arg1 env.Object, 
        arg2 env.Object,
        arg3 env.Object,
        arg4 env.Object
    ) env.Object {
		switch cond := arg0.(type) {
		case env.Block:
			switch bloc := arg2.(type) {
			case env.Block:
				acc := arg1
				ser := ps.Ser
				for {
					ps.Ser = cond.Series
					ps = EvalBlockInjMultiDialect(ps, acc, true)
					if ps.ErrorFlag {
						return ps.Res
					}
					if !util.IsTruthy(ps.Res) {
						ps.Ser.Reset()
						ps.Ser = ser
						return acc
					}
					ps.Ser.Reset()
					ps.Ser = bloc.Series
					ps = EvalBlockInjMultiDialect(ps, acc, true)
					if ps.ErrorFlag {
						return ps.Res
					}
					ps.Ser = ser
					ps.Ser.Reset()
					acc = ps.Res
				}
			default:
				return MakeArgError(
                   ps, 3, []env.Type{env.BlockType}, "produce\\while")
                )
			}
		default:
			return MakeArgError(
                ps, 1, []env.Type{env.IntegerType}, "produce\\while"
            )
		}
	},
},
</code></pre>
<p>So...</p>
<ul>
<li>
<p>We know what <code>arg0</code>, <code>arg1</code> and <code>arg2</code> are, but I have no clue what <code>arg3</code> and <code>arg4</code> are supposed to be.  <a href="https://stackoverflow.com/questions/22549228/why-does-go-allow-compilation-of-unused-function-parameters">Go apparently doesn't warn you about unused arguments.</a>.  I guess it's either there for interface compatibility with something else, or it's just accidental code.</p>
</li>
<li>
<p>As expected, it loops and makes two calls to the evaluator as it does so... one for the condition, and one for the body.  When the condition isn't truthy any more, it's finished.</p>
<ul>
<li>
<p>Makes a direct call to the evaluator, <a href="../../switching-to-stackless-why-this-why-now/1247.html">so not stackless</a>.  <em>(My understanding is that Go itself has a conventional stack and is not stackless.)</em></p>
</li>
<li>
<p>Searching for stackless in the repository <a href="https://github.com/refaktor/rye/blob/625283fd05334a293889cf803b8c0daed48103a9/evaldo/builtins_stackless.go">turns up a <strong><code>builtins_stackless.go</code></strong></a> but I don't understand how what's in it would apply to stacklessness.</p>
</li>
</ul>
</li>
<li>
<p>Seems to bubble up errors out of the condition, and the body.</p>
<ul>
<li>
<p>As I've said, Rye seems to be at least aware that handling arbitrary unknown abrupt failures emerging from arbitrary code is a dead end...especially in a language that can abruptly fail over a typo.  You need to connect the errors to the function you just called, or it has to be a hard fail.</p>
</li>
<li>
<p>I'm not so sure about the meaningfulness of being willing to bubble errors up out of the condition and the body.  Ren-C doesn't do that, e.g. a TRY cannot suppress an error from inside the while:</p>
<pre><code>ren-c&gt;&gt; block: []
== []

&gt;&gt; while [take block] [print "Not trappable"]
** Script Error: Can't TAKE, no value available (consider TRY TAKE)

&gt;&gt; try while [take block] [print "Not trappable"]
** Script Error: Can't TAKE, no value available (consider TRY TAKE)
</code></pre>
<p>I'll admit to not having a firm grasp on what the whole policy should be.  But when errors can come from multiple places, I just get skeptical that you really know what you're handling.  The body may make sense, but I'm pretty sure the condition is a bad idea.</p>
</li>
</ul>
</li>
</ul>
<h2><a name="p-7775-evalblockinjmultidialect-2" class="anchor" href="7.html#p-7775-evalblockinjmultidialect-2"></a>EvalBlockInjMultiDialect()</h2>
<p>Excerpting a bit here:</p>
<pre><code>acc := arg1
ser := ps.Ser
for {
    ps.Ser = cond.Series
    ps = EvalBlockInjMultiDialect(ps, acc, true)
    if ps.ErrorFlag {
        return ps.Res
    }
</code></pre>
<p>All right, so <strong><code>acc</code></strong> is the accumulator, e.g. the thing that being sent into the block evaluations implicitly to be picked up as the left-hand side of an infix operator or assignment.</p>
<p>The "Inj" is presumably for "Inject" related to the fact that it's passing in this parameter to inject into the evaluation.  <a href="https://github.com/refaktor/rye/blob/625283fd05334a293889cf803b8c0daed48103a9/evaldo/evaldo.go#L76">The flag is for "injnow", so inject now</a>.  I don't know what injecting later would be like... and every call to EvalBlockInjMultiDialect() passes true.</p>
<pre><code>func EvalBlockInjMultiDialect(
    ps *env.ProgramState, inj env.Object, injnow bool
) *env.ProgramState {
    switch ps.Dialect {
        case env.EyrDialect:
            return Eyr_EvalBlockInside(ps, inj, injnow)
        default:
            return EvalBlockInj(ps, inj, injnow)
    }
}
</code></pre>
<p>So the "ProgramState" can have the concept of being "in a dialect".  Hence when something like WHILE calls <code>EvalBlockInjMultiDialect()</code> it might evaluate that block differently based on what dialect is in effect.  And at the moment, <a href="../../om-concatenative-homoiconic-language/2184/3.html">the one dialect supported is Eyr</a>...a sort of Reverse Polish math thing.</p>
<p>But the average case it calls the non-dialected <a href="https://github.com/refaktor/rye/blob/625283fd05334a293889cf803b8c0daed48103a9/evaldo/evaldo.go#L86"><code>EvalBlockInj()</code></a></p>
<p>Reading it... really the "inject now" is just due to the fact that there's no "Optional" state on the injected value to say there's no value.   So as it evaluates each expression, it has to pass a pair of values: the left hand side, and whether the left hand side you got passed is meaningful.</p>
<h2><a name="p-7775-i-see-where-the-left-set-word-motivation-comes-from-now-3" class="anchor" href="7.html#p-7775-i-see-where-the-left-set-word-motivation-comes-from-now-3"></a>I See Where The Left-Set-Word Motivation Comes From Now...</h2>
<p>What it seems to come down to is that infix is a sunk cost, and it's an attempt to reuse that.</p>
<p>Hence the thinking here is: "so long as there have to be mechanics to feed a value from a previous evaluation in to the next anyway (for operations like <code>+</code>, <code>*</code>, etc)... why not use that already-existing mechanism to slipstream parameters into block evaluations?  It's basically 'free'."</p>
<p>To me...that's the implementation-tail wagging the language-dog.  <img src="../../../images/emoji/twitter/dog2.png%3Fv=14" title=":dog2:" class="emoji" alt=":dog2:" loading="lazy" width="20" height="20"></p>
<p>It's a trick that obfuscates what's there, and breaks other tricks.  For instance: Ren-C has the ability to ELIDE expressions so they vanish completely.</p>
<pre><code>&gt;&gt; 1 + 2 elide print "like this"
like this
== 3
</code></pre>
<p>But if you are running a block that's been seeded with this value, and all your block says is <strong><code>[elide print "I think this block is vanishing"]</code></strong>, you'd be leaving the residual of the thing you fed into that block.</p>
<p>If I sat down and looked...I imagine I could rattle off a bunch of other things it breaks.  But abstractly speaking, I happen to like having constructs that can detect the "reality" of if there's anything to their left or not.</p>
<p>In the past I've had things like a mode-switching <strong><code>+</code></strong>, that became variadic with nothing on its left:</p>
<pre><code>&gt;&gt; x: 1 + 2
== 3

&gt;&gt; x: (+ 1 2 3 4)
== 10
</code></pre>
<p>And so when this infix seeds evaluations with a value, anything like that would be broken too.</p>
<p>I'm empathetic to the idea that when you're sitting down and hacking on a language, you might find a trick like slipstreaming infix into a block evaluation, and think it solves your problem.  But when you take off the implementation glasses--and look at what it really does in terms of distorting "what's there" in the code--I don't think it's a very empowering approach.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>

      <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
          <span itemprop='name'>
            <a itemprop="url" href="../1768.html#post_7">show post in topic</a>
          </span>
      </div>

    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
