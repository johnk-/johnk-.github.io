<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>rebSpell() or rebBytes() of NULL in the API - Language Bridging - AltRebol</title>
    <meta name="description" content="For safety reasons, extraction APIs like rebSpell() and rebBytes() would raise errors if the evaluative product was NULL: 
char* my_c_string = rebSpell(&amp;quot;third [a b]&amp;quot;);  // !!! fail/panic/crash

To get around this, the ol&amp;hellip;">
    <meta name="generator" content="Discourse 3.1.0.beta4 - https://github.com/discourse/discourse version 25276f62f959eab4557049a655300a70835c5769">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1887.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

    <link href="https://forum.rebol.info/stylesheets/color_definitions_base__2_caa66e77e807fc270e5b21d201643962219b6a9a.css?__ws=forum.rebol.info" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://forum.rebol.info/stylesheets/desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://forum.rebol.info/stylesheets/chat_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-details_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-lazy-videos_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-local-dates_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-narrative-bot_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-presence_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://forum.rebol.info/stylesheets/docker_manager_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="https://forum.rebol.info/stylesheets/poll_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://forum.rebol.info/stylesheets/chat_desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat_desktop"  />
  <link href="https://forum.rebol.info/stylesheets/poll_desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://forum.rebol.info/stylesheets/desktop_theme_2_5e18a6fac02b6ab11e33445179f4a2961aadbfd8.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="default"/>

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;rebSpell() or rebBytes() of NULL in the API&#39;" href="1887.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/rebspell-or-rebbytes-of-null-in-the-api/1887" />
<meta name="twitter:url" content="https://forum.rebol.info/t/rebspell-or-rebbytes-of-null-in-the-api/1887" />
<meta property="og:title" content="rebSpell() or rebBytes() of NULL in the API" />
<meta name="twitter:title" content="rebSpell() or rebBytes() of NULL in the API" />
<meta property="og:description" content="For safety reasons, extraction APIs like rebSpell() and rebBytes() would raise errors if the evaluative product was NULL:  char* my_c_string = rebSpell(&quot;third [a b]&quot;);  // !!! fail/panic/crash  To get around this, the old way of thinking was you would use TRY and it would produce a BLANK!.  The blank would be interpreted as an intentional nothing, and suppress an error:  char* my_c_string = rebSpell(&quot;try third [a b]&quot;);  // was like rebSpell(&quot;_&quot;) assert(my_c_string == nullptr);  // this is what y..." />
<meta name="twitter:description" content="For safety reasons, extraction APIs like rebSpell() and rebBytes() would raise errors if the evaluative product was NULL:  char* my_c_string = rebSpell(&quot;third [a b]&quot;);  // !!! fail/panic/crash  To get around this, the old way of thinking was you would use TRY and it would produce a BLANK!.  The blank would be interpreted as an intentional nothing, and suppress an error:  char* my_c_string = rebSpell(&quot;try third [a b]&quot;);  // was like rebSpell(&quot;_&quot;) assert(my_c_string == nullptr);  // this is what y..." />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:section" content="Language Bridging" />
<meta property="og:article:section:color" content="25AAE2" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="2 ❤" />
<meta property="article:published_time" content="2022-07-16T14:01:23+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://forum.rebol.info/">
    AltRebol
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="1887.html">rebSpell() or rebBytes() of NULL in the API</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/8" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/language-bridging/35" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Language Bridging</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='rebSpell() or rebBytes() of NULL in the API'>
        <meta itemprop='articleSection' content='Language Bridging'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>

          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1887.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2022-07-16T14:01:23Z' class='post-time'>
                    July 16, 2022,  2:01pm
                  </time>
                  <meta itemprop='dateModified' content='2022-07-16T14:01:23Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='articleBody'>
              <p>For safety reasons, extraction APIs like rebSpell() and rebBytes() would raise errors if the evaluative product was NULL:</p>
<pre><code>char* my_c_string = rebSpell("third [a b]");  // !!! fail/panic/crash
</code></pre>
<p>To get around this, the old way of thinking was you would use TRY and it would produce a BLANK!.  The blank would be interpreted as an intentional nothing, and suppress an error:</p>
<pre><code>char* my_c_string = rebSpell("try third [a b]");  // was like rebSpell("_")
assert(my_c_string == nullptr);  // this is what you'd get
</code></pre>
<p>But now we're in the era of <strong>NULL-in-TRY-out</strong>.  Nothing gets converted to blank anymore...a TRY just gives back NULL.  So it won't work this way.</p>
<h2>What Was Safer About The Old Way?</h2>
<p>You might ask what the difference is.  Like if you're writing JavaScript and get a null back you don't expect, the JavaScript will raise an error when you try to use it where you shouldn't.  Why's it better to make reb.Spell() itself raise the error?</p>
<p>Okay, yes, in JavaScript there's not really all that strong an argument.  But in C if you use a null incorrectly, you get a crash.  Intercepting it in rebSpell() gives a chance to throw (via longjmp, or now maybe C++ throw) to the error handler of the console...and have it be a non-fatal error.</p>
<p><em>(...though in WebAssembly, it's different... (!)  I noticed something started to happen once we switched to the new C++ throw builds for the web console, and it's actually recovering from access violations in the native code and the console stays running!  Probably not great to rely on this, but I do find it interesting.)</em></p>
<h2>I Was Always On The Fence on This...</h2>
<p>If you look at the design ethos of C, it really does kind of try to make it easy to sweep nulls under the rug.</p>
<p>For instance, if you call <strong>free()</strong> on a null pointer, it is a no-op.</p>
<p>Whether you agree with that decision or not, it's there...and so when you ask for a memory backing buffer (e.g. one that can be used to build a BINARY!) the rebMalloc()/rebFree() pairs are such that rebFree() accepts null.  If it didn't do so, you couldn't pass it in as your memory allocator to things like zlib that expect you to obey the malloc()/free() behavior.</p>
<p>So I often wondered if rebSpell() and rebBytes() should be null tolerant, and let the chips fall where they may.</p>
<p>But...hrm.  I don't know.  I like the error emerging from inside the call.</p>
<h2>What About rebTrySpell() and rebTryBytes() ?</h2>
<p>With the new meaning of TRY, this actually makes sense!</p>
<p>It's a better way to bias it than to say that rebSpell() can give back NULL, where you'd use rebMustSpell() if you want to ensure it isn't null.</p>
<p>Very well, then.  I'm glad we had this talk.</p>
<p><img src="../../images/emoji/twitter/no_mouth.png%3Fv=9" title=":no_mouth:" class="emoji only-emoji" alt=":no_mouth:"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
    </div>






    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
        </span>
      </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
