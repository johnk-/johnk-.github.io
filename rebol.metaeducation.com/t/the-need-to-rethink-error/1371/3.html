<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>The Need To Rethink ERROR! - #3 by hostilefork - Errors - AltRebol</title>
    <meta name="description" content="Looking around at how people deal with failure conditions, there&amp;#39;s a pretty strong trend against exceptions--a trend which has grown stronger in the last batch of popular languages. 
Exceptions operate on a dubious princ&amp;hellip;">
    <meta name="generator" content="Discourse 3.1.0.beta4 - https://github.com/discourse/discourse version 25276f62f959eab4557049a655300a70835c5769">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../1371.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="AltRebol Search">

    <link href="https://forum.rebol.info/stylesheets/color_definitions_base__2_caa66e77e807fc270e5b21d201643962219b6a9a.css?__ws=forum.rebol.info" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://forum.rebol.info/stylesheets/desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://forum.rebol.info/stylesheets/chat_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-details_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-lazy-videos_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-local-dates_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-narrative-bot_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-presence_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://forum.rebol.info/stylesheets/docker_manager_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="https://forum.rebol.info/stylesheets/poll_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://forum.rebol.info/stylesheets/chat_desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat_desktop"  />
  <link href="https://forum.rebol.info/stylesheets/poll_desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://forum.rebol.info/stylesheets/desktop_theme_2_5e18a6fac02b6ab11e33445179f4a2961aadbfd8.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="default"/>

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;The Need To Rethink ERROR!&#39;" href="../1371.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/the-need-to-rethink-error/1371/3" />
<meta name="twitter:url" content="https://forum.rebol.info/t/the-need-to-rethink-error/1371/3" />
<meta property="og:title" content="The Need To Rethink ERROR!" />
<meta name="twitter:title" content="The Need To Rethink ERROR!" />
<meta property="og:description" content="The Above Was Written in 2020.  In 2022: (1) (2) (3) =&gt; ^META ðŸ’¥  We address (1) by multiplexing ERROR! return results onto the main return channel backbone with ^META conventions!!!  e.g. with ^META, we can say that if a function you are calling raises an error, then you get a QUASI!-ERROR! result.  &gt;&gt; x: ^(1 / 0) == ~make error! [     type: &#39;Math     id: &#39;zero-divide     ... ]~  This is distinct from what would happen if a non-triggered ERROR! value just happened to be evaluated to.  That..." />
<meta name="twitter:description" content="The Above Was Written in 2020.  In 2022: (1) (2) (3) =&gt; ^META ðŸ’¥  We address (1) by multiplexing ERROR! return results onto the main return channel backbone with ^META conventions!!!  e.g. with ^META, we can say that if a function you are calling raises an error, then you get a QUASI!-ERROR! result.  &gt;&gt; x: ^(1 / 0) == ~make error! [     type: &#39;Math     id: &#39;zero-divide     ... ]~  This is distinct from what would happen if a non-triggered ERROR! value just happened to be evaluated to.  That..." />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:section" content="Errors" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="article:published_time" content="2022-06-09T06:38:07+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://forum.rebol.info/">
    AltRebol
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="../1371.html">The Need To Rethink ERROR!</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/8" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/errors/54" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Errors</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='The Need To Rethink ERROR!'>
        <meta itemprop='articleSection' content='Errors'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>

          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="../1371.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2020-10-23T07:48:00Z' class='post-time'>
                    October 23, 2020,  7:48am
                  </time>
                  <meta itemprop='dateModified' content='2021-10-02T19:56:01Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='articleBody'>
              <p>Looking around at how people deal with failure conditions, <em>there's a pretty strong trend against exceptions--a trend which has grown stronger in the last batch of popular languages</em>.</p>
<p>Exceptions operate on a dubious principle: that a trigger condition originating transitively in a deep stack of code can be meaningfully handled when passed up through intermediary stacks.  There's an uncomfortable violation of abstraction: you are no longer dealing with a return result that was clearly formalized in the contract between caller-and-callee.  <em>"The function you called couldn't handle an error... but you're trying to do it without even knowing what that function called that failed...?"</em></p>
<p>Even exception advocates agree that they should not be used lightly...the name suggests it is only for "exceptional" circumstances.  So things that are very reasonable to expect to occur during operation--like a filesystem API trying to open the file and it not being there--should fit into the normal return results.  This is a slippery slope and subject to what your program considers "normal"...but the intent is that it's supposed to be more for things like "ran out of memory" or "network cable was unplugged during transfer".</p>
<p>But there are many who are against exceptions.  e.g. Google's is against them: <a href="https://google.github.io/styleguide/cppguide.html#Exceptions"><em>"We do not use C++ exceptions."</em></a>  When the pros and cons are weighed, they think it's just not worth it.</p>
<p>Rebol code that uses TRAP (old TRY) or ATTEMPT frequently shows that Rebol has an even greater weakness of the approach than usual: any arbitrary typo inside the executing code can be interpreted as the wrong kind of failure.  Conflating a syntax error with something like file-not-found is much too easy.</p>
<p>Another key contributor to exception unpopularity is <strong>exceptions don't work well with asynchronous programming</strong>.  Code that triggered a request can be off the stack while a handler is running.  So there is nowhere to put a <code>catch {}</code> above the stack for the problem.</p>
<h2>Emergent Pattern: Branching Returns</h2>
<p>Across languages you see a consistent pattern of functions formalizing the return of a branched result: either a "successful" return or an "error" return...and labeling the return value as such.</p>
<ul>
<li>
<p>Haskell has "the <a href="https://wiki.haskell.org/Handling_errors_in_Haskell#Error_using_the_Either_type"><code>Either</code></a> monad"...which bundles a value with a label of "left" and "right".  By convention, if the value is labeled "left" it is an error value...and if it is labeled "right" it is a successful return.  There is no "umbrella" error datatype--so strings labeled "left" or other common tuples are typically used.</p>
</li>
<li>
<p>Haskell-inspired Rust has <a href="https://doc.rust-lang.org/stable/rust-by-example/error/result.html"><code>result</code></a>, which has a similar labeling scheme...though it specializes the purpose and gives the labels the names "Ok" and "Err".  It suggests (but does not enforce) that Err-labeled values be instances of the <a href="https://doc.rust-lang.org/std/error/trait.Error.html"><code>std::error::Error</code></a> datatype...which meets the basic expectations of what an error should be able to do (e.g. print itself out, show a call stack of where it originated).</p>
</li>
<li>
<p>JavaScript ES6 handles asynchronous scenarios by making it so that <code>async</code> functions don't return their result with <code>return</code>, but with either <code>resolve()</code> or <code>reject()</code>.  If resolve is called, then callsites will trigger <code>then()</code> handling, otherwise they will trigger <code>catch()</code> handling.  If <code>await</code> is used vs. then/catch, a failed promise will resort to throwing the error (e.g. an exception).</p>
</li>
<li>
<p>Node.js used the <a href="https://nodejs.org/en/knowledge/errors/what-are-the-error-conventions/">"callback convention"</a> where asynchronous functions return errors as the first parameter to a callback, and if that is null the other arguments are assumed valid...but this is now typically <a href="https://medium.com/better-programming/converting-callbacks-to-promises-like-a-pro-in-node-js-f5d4d466a1a7">converted into ES6 promises</a> where errors produce</p>
</li>
<li>
<p>Go uses <a href="https://www.digitalocean.com/community/tutorials/handling-errors-in-go#:~:text=When%20a%20function%20returns%20multiple,value%20to%20a%20zero%20value.">multiple return values for errors</a>, with a convention that the <em>last</em> value in the return sequence is the error...with all other values being "zero values" of their type.</p>
</li>
</ul>
<p>So if your own unsatisfying experiences with "throw/catch" and "fail/trap" solutions isn't enough to convince you...there's a pretty strong batch of added evidence.</p>
<h2>Using The Parts In The Box Effectively</h2>
<p>Something I had in the back of my mind ever since THEN could conveniently take a parameter value via lambdas, was what if ELSE could too.</p>
<p>At the moment ELSE only triggers on NULL.  But what might happen if THEN didn't take ERROR!s or nulls, but ELSE did.  Something like:</p>
<pre><code> (make error! "how about this?") then value -&gt; [
     print ["This would not run:" value]
 ] else error -&gt; [
     print ["This would run:" error]
 ]
</code></pre>
<p>But that crude sketch shows a weak basis for doing error handling:</p>
<ul>
<li>
<p>It operates in the "single return result" realm...so to use it, you'd have to conflate ERROR! values in with a function's ordinary return values.  That would be tricky to avoid including ERROR! itself, if it can return ANY-VALUE! (e.g. you can PICK an ERROR! out of an array)</p>
</li>
<li>
<p>There's nothing guaranteeing you handle an error...you could just forget and leave off the ELSE  (The "good" versions of the branched error approaches make sure you never accidentally ignore them, you have to consciously throw them away.)</p>
</li>
<li>
<p>It may be (probably is?) a bad fit to fold this into ELSE...which isn't really about error handling, but whether branches are taken.</p>
</li>
</ul>
<p>Using SET-BLOCK! for <a href="https://forum.rebol.info/t/forward-to-multiple-return-values-and-return-value-forwarding/1271">multiple return values</a> wedged open the door for being more effective in this space.  But we can think through this some more.</p>
<p>One thing I notice in JavaScript and Go is that the error result is distinguished, but positioning is set by convention instead of by name.  As a random sample thought, we could syntactically push errors out somehow, e.g. with a TUPLE!</p>
<pre><code>; function that returns 3 values and a possible error
;
[a b c].err: some-func arg1 arg2 arg3
</code></pre>
<p>I didn't say it was a great idea--just pointing out a degree of freedom.</p>
<h2>Could We Get More Mileage Out Of ERROR!</h2>
<p>Rebol2's ERROR! had an interesting aspect to it, as being an "ornery" value...like a VOID!...that you couldn't inspect normally.  You had to DISARM it and view it as an object in order to pick apart its properties.</p>
<p>R3-Alpha's ERROR! was neutered and became just another flavor of OBJECT!.  It carries a bit of standardized information about what line and location it originated from...but arguably this could be a useful feature for any value <em>(internally to the system for debugging, I have functions like Touch() which will tag a value with the last place that modified it...and it comes in handy a lot)</em>.</p>
<p>Maybe it's all right as it is... and what we're missing is more like Rust's <strong><code>result</code></strong>.  But I can't help but feel that in a universe of possible designs...that "OBJECT! that reports a different type" is weak.</p>
<p>Again: I don't have any great ideas right now.  This is just noticing something and brainstorming.  Having multiple returns in the mix is good, but I'd like to see something that's at least as good as what other languages have.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="2" />
              </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../../parameter-order-in-rebol/1238/4.html">Parameter Order in Rebol</a>
                        <meta itemprop='position' content='8'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../../haskell-and-rust-error-handling/1987.html">Haskell and Rust Error Handling</a>
                        <meta itemprop='position' content='9'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../../should-evaluate-bomb-on-an-error/1491/2.html">Should EVALUATE/NEXT bomb on an error?</a>
                        <meta itemprop='position' content='10'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="../1371.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2021-10-04T22:00:48Z' class='post-time'>
                    October 4, 2021, 10:00pm
                  </time>
                  <meta itemprop='dateModified' content='2021-10-04T22:11:29Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <h2>Thoughts on CALL And Errors</h2>
<p>In <a class="mention" href="https://forum.rebol.info/u/gchiu">@gchiu</a>'s small pharmac script, there are a <a href="https://github.com/gchiu/pharmac/blob/master/scripts/grab-pdfs.reb#L122">couple of uses of CALL</a> that run ghostscript (gs):</p>
<pre><code>call [
    gs -sDEVICE=pngmono -o (join root "-%02d.png") -r600 (pdfname)
]

call [
    gs -sDEVICE=eps2write -sPAPERSIZE=a4
        -o (join root "-%02d.eps") (pdfname)
]
</code></pre>
<p><strong>But if either of these calls fail, the script will keep running.</strong>  That is because CALL is not checking the result code...and in OS terms, any process that returns a nonzero value had an error.</p>
<p><strong>I think the default behavior of CALL should be to raise an error on a nonzero result.</strong></p>
<p>The best strategy seems that if you request the exit status explicitly, then it would assume you were going to handle it.</p>
<pre><code>[# status]: call [...]
</code></pre>
<p>What makes this a little bit weird is that there doesn't seem to be any particularly great return result from CALL besides the integer return value.  So there'd be a ~none~ return result by default, and this status would be the secondary result.</p>
<p>This doesn't exactly fit the pattern of my "distinguished error" result, because the status is an integer... not an ERROR!.  Though if you don't ask for the status and it raises an error because of that you could see it that way:</p>
<pre><code>[#].err: call [...]
</code></pre>
<h2>Could a Function Tell If You "Use" Its Primary Return Result?</h2>
<p>It's hard to say what "using" would mean.</p>
<p>For instance, imagine this scenario:</p>
<pre><code>&gt;&gt; call [rm nonexistentfile.txt] print "nocheck"
** Error: CALL returned exitstatus 1
** Near: rm nonexistentfile.txt
</code></pre>
<p>So I'm proposing that would raise an error in a script.  But what if you wrote:</p>
<pre><code>&gt;&gt; call [rm nonexistentfile.txt]
== 1
</code></pre>
<p>The value 1 got "used" in the sense that it was reported by the console.  Should that count as suppressing the error, since someone took the result?</p>
<p>What about:</p>
<pre><code>&gt;&gt; elide call [rm nonexistentfile.txt]
</code></pre>
<p>The ELIDE consumed the result, but threw it away.  It doesn't seem that should suppress errors.</p>
<p>Really only multiple-returns are set up to be explicitly thought of as "requested" vs. not.  We could argue that explicit setting to a word is different:</p>
<pre><code>status: call [rm nonexistentfile.txt]
</code></pre>
<p>And then CALL could be told whether there was an explicit assignment or not.  But the way that multi-returns are checked is if their argument names are null or not...and the RETURN argument isn't named right now (it's just the RETURN: in the spec).</p>
<p>Overall I am wary of trying to do anything detection-wise with the main return, and keep that for multi-returns...which are really just syntactic sugar over refinements.  That has this weird implication for CALL not having the exitstatus as its primary return.  Oh well.</p>
<h2>Thoughts on CALL and Asynchronousness</h2>
<aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="1371">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>Another key contributor to exception unpopularity is <strong>exceptions don't work well with asynchronous programming</strong>. Code that triggered a request can be off the stack while a handler is running. So there is nowhere to put a <code>catch {}</code> above the stack for the problem.</p>
</blockquote>
</aside>
<p>In the model I'm pushing for asynchronousness, this argument isn't as applicable...because the error can be received by the callsite.</p>
<p>What you'd want to do to make CALL asynchronous would be to just spawn it off on a separate "goroutine"-like thing.</p>
<p>If you didn't care about the result, you could just do something like this:</p>
<pre><code> go [call [echo "I'm being printed by the OS"]]
 print "This could print before the echo executes."
</code></pre>
<p>But if you wanted to coordinate, you'd make something like a "channel" and have the goroutine transmit updates on it.</p>
<pre><code>let c: make-channel
go [
    send-channel c &lt;start&gt;
    call [echo "I'm being printed by the OS"]
    send-channel c &lt;finish&gt;
    close-channel c
]
while [msg: receive-channel c] [
   print ["Got signal from channel:" msg]
]
print "Channel has been closed"
</code></pre>
<p>That would be one strategy.  But a different strategy would be used if you wanted to communicate with the input and receive the output, in a streaming fashion.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../../making-call-raise-a-definitional-error-for-bad-exit-codes/2068.html">Making CALL Raise a (definitional) Error For Bad Exit Codes</a>
                        <meta itemprop='position' content='2'>
                      </div>
                </div>
          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="../1371.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2022-06-09T06:38:07Z' class='post-time'>
                    June 9, 2022,  6:38am
                  </time>
                  <meta itemprop='dateModified' content='2022-09-01T10:35:26Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group quote-modified" data-username="hostilefork" data-post="1" data-topic="1371">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<pre><code>(make error! "how about this?") then value -&gt; [
     print ["This would not run:" value]
] else error -&gt; [
    print ["This would run:" error]
]
</code></pre>
<p>But that crude sketch shows a weak basis for doing error handling:  <em>(Note: numbering added)</em></p>
<ol>
<li>
<p>It operates in the "single return result" realm...so to use it, you'd have to conflate ERROR! values in with a function's ordinary return values. That would be tricky to avoid including ERROR! itself, if it can return ANY-VALUE! (e.g. you can PICK an ERROR! out of an array)</p>
</li>
<li>
<p>It may be (probably is?) a bad fit to fold this into ELSE...which isn't really about error handling, but whether branches are taken.</p>
</li>
<li>
<p>There's nothing guaranteeing you handle an error...you could just forget and leave off the ELSE (The "good" versions of the branched error approaches make sure you never accidentally ignore them, you have to consciously throw them away.)</p>
</li>
</ol>
</blockquote>
</aside>
<p>The Above Was Written in 2020.</p>
<h2>In 2022: (1) (2) (3) =&gt; ^META</h2>
<p><img src="../../../images/emoji/twitter/boom.png%3Fv=9" title=":boom:" class="emoji only-emoji" alt=":boom:"></p>
<p><strong>We address (1) by multiplexing ERROR! return results onto the main return channel backbone with ^META conventions!!!</strong></p>
<p>e.g. with ^META, we can say that if a function you are calling raises an error, then you get a QUASI!-ERROR! result.</p>
<pre><code>&gt;&gt; x: ^(1 / 0)
== ~make error! [
    type: 'Math
    id: 'zero-divide
    ...
]~
</code></pre>
<p>This is distinct from what would happen if a non-triggered ERROR! value just happened to be evaluated to.  That would be quoted by the ^META process.</p>
<p><em>Then we could say that UNMETA of a non-quoted ERROR! will raise that error.</em>  This gives a time between the ^META and UNMETA for you to handle it, if you can do so meaningfully.  If you don't, it fails.</p>
<p><strong>We solve (2) by saying ELSE and THEN both reject ERROR! meta-values...</strong></p>
<p>Instead, special handling is done through something like an EXCEPT clause:</p>
<pre><code>if x [1 / 0] then [
    print "Skipping THEN"
] else [
    print "Skipping ELSE"
] except e -&gt; [
    print ["Handling" mold e]
]
</code></pre>
<p><strong>Address (3) by making an isotopic ERROR! that falls out an evaluation chain without being caught cause a failure.</strong></p>
<p>That means that if the above were a THEN and ELSE with no EXCEPT, the error would be offered as ^META to each clause, piped through.  But then if the overall expression result wasn't targeting a ^META slot you'd get a problem.</p>
<h2>This Means (Effectively) that there are ERROR! Isotopes</h2>
<p>The trick is that error isotopes don't decay when you try to store them in variables, <strong>they trigger failure</strong>.</p>
<p>In a surface-level way, this somewhat resembles Rebol2's "armed" and "disarmed" errors.  But it fits into a deeper story.  And with stackless, it should be performant--because we can effectively be running a "TRAP" on every stack level at near zero cost (vs. the setjmp()/longjmp() that would be required in a non-stackless model on every frame)</p>
<p><strong>This has potential, and I'm very curious to try it out.</strong></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../../should-everything-have-an-isotopic-form/1889.html">Should Everything Have an Isotopic Form?</a>
                        <meta itemprop='position' content='1'>
                      </div>
                </div>
          </div>
    </div>






    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
        </span>
      </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
