<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Virtual-Binding-Based &quot;Error Propagation Operator&quot; 🤯 - Errors - AltRebol</title>
    <meta name="description" content="In Rust, if you define your function interface as possibly returning an Error, then you might find a circumstance where you call a function whose error you wish to propagate up to become your function&amp;#39;s error. 
Here&amp;#39;s ho&amp;hellip;">
    <meta name="generator" content="Discourse 3.5.0.beta6-dev - https://github.com/discourse/discourse version 623cde985b21c2ed812b83d3ea94f69231613718">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="2389.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

    <link href="https://rebol.metaeducation.com/stylesheets/color_definitions_base__2_ceb61c279a74dfa3cef6a62f7784988102abec82.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" class="light-scheme"/>

<link href="https://rebol.metaeducation.com/stylesheets/common_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common"  />

  <link href="https://rebol.metaeducation.com/stylesheets/desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="desktop"  />



    <link href="https://rebol.metaeducation.com/stylesheets/chat_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-details_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-lazy-videos_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-local-dates_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-narrative-bot_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-presence_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="https://rebol.metaeducation.com/stylesheets/docker_manager_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="https://rebol.metaeducation.com/stylesheets/footnote_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll"  />
    <link href="https://rebol.metaeducation.com/stylesheets/spoiler-alert_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="https://rebol.metaeducation.com/stylesheets/chat_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat_desktop"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://rebol.metaeducation.com/stylesheets/common_theme_2_57fe803ed5a41e9f7d94086afaf66a1aab57d9ae.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="2" data-theme-name="default"/>
    

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Virtual-Binding-Based &quot;Error Propagation Operator&quot; :exploding_head:&#39;" href="2389.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://rebol.metaeducation.com/t/virtual-binding-based-error-propagation-operator/2389" />
<meta name="twitter:url" content="https://rebol.metaeducation.com/t/virtual-binding-based-error-propagation-operator/2389" />
<meta property="og:title" content="Virtual-Binding-Based &quot;Error Propagation Operator&quot; 🤯" />
<meta name="twitter:title" content="Virtual-Binding-Based &quot;Error Propagation Operator&quot; 🤯" />
<meta property="og:description" content="In Rust, if you define your function interface as possibly returning an Error, then you might find a circumstance where you call a function whose error you wish to propagate up to become your function&#39;s error.  Here&#39;s how you&#39;d traditionally write something like that, in a case where it potentially propagates an error from one of two calls:  fn read_username_from_file_traditional() -&gt; Result&lt;String, io::Error&gt; {     let f = match File::open(&quot;username.txt&quot;) {         Ok(file) =&gt; file,         Err..." />
<meta name="twitter:description" content="In Rust, if you define your function interface as possibly returning an Error, then you might find a circumstance where you call a function whose error you wish to propagate up to become your function&#39;s error.  Here&#39;s how you&#39;d traditionally write something like that, in a case where it potentially propagates an error from one of two calls:  fn read_username_from_file_traditional() -&gt; Result&lt;String, io::Error&gt; {     let f = match File::open(&quot;username.txt&quot;) {         Ok(file) =&gt; file,         Err..." />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:section" content="Errors" />
<meta property="og:article:section:color" content="25AAE2" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="10 ❤" />
<meta property="article:published_time" content="2025-03-28T23:29:47+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://rebol.metaeducation.com/">AltRebol</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="2389.html">Virtual-Binding-Based &quot;Error Propagation Operator&quot; 🤯</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/development/errors/54" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/development/errors/54" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Errors</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Virtual-Binding-Based &quot;Error Propagation Operator&quot; :exploding_head:'>
      <link itemprop='url' href='2389.html'>
      <meta itemprop='datePublished' content='2025-03-28T23:29:47Z'>
        <meta itemprop='articleSection' content='Errors'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="2389.html">


              <span class="crawler-post-infos">
                  <time  datetime='2025-03-28T23:29:47Z' class='post-time'>
                    March 28, 2025, 11:29pm
                  </time>
                  <meta itemprop='dateModified' content='2025-06-01T21:37:01Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>In Rust, if you define your function interface as possibly returning an Error, then you might find a circumstance where you call a function whose error you wish to propagate up to become your function's error.</p>
<p>Here's how you'd traditionally write something like that, in a case where it potentially propagates an error from one of two calls:</p>
<pre><code>fn read_username_from_file_traditional() -&gt; Result&lt;String, io::Error&gt; {
    let f = match File::open("username.txt") {
        Ok(file) =&gt; file,
        Err(e) =&gt; return Err(e),
    };
    
    let mut username = String::new();
    match f.read_to_string(&amp;mut username) {
        Ok(_) =&gt; Ok(username),
        Err(e) =&gt; Err(e),
    }
}
</code></pre>
<p>But there's an application of <strong>"the <code>?</code> operator"</strong> (which doesn't really have another name) which will do this propagation for you.</p>
<pre><code>fn read_username_from_file() -&gt; Result&lt;String, io::Error&gt; {
    let mut username = String::new();
    File::open("username.txt")?.read_to_string(&amp;mut username)?;
    Ok(username)
}
</code></pre>
<h2><a name="p-8092-historically-we-couldnt-do-things-like-this-1" class="anchor" href="2389.html#p-8092-historically-we-couldnt-do-things-like-this-1"></a>Historically We Couldn't Do Things Like This</h2>
<p>There was no way for such an operator to be able to know what the concept of RETURN was.</p>
<p>Hence you see things like:</p>
<pre><code>change: combinator [
    "Substitute a match with new data"
    return: [~#change~]
    parser [action!]
    replacer [action!]  ; !!! How to say result is used here?
    &lt;local&gt; ^replacement
][
    [^ remainder]: parser input except e -&gt; [  ; first find end position
        return fail e
    ]

    [^replacement #]: replacer input except e -&gt; [
        return fail e
    ]

    ; CHANGE returns tail, use as new remainder
    ;
    remainder: change:part input ^replacement remainder
    return ~#change~
]
</code></pre>
<h2><a name="p-8092-but-virtual-binding-means-we-could-do-it-2" class="anchor" href="2389.html#p-8092-but-virtual-binding-means-we-could-do-it-2"></a>But Virtual Binding Means We <em>COULD</em> Do It</h2>
<p>I'm pretty dead-set on using <strong>?</strong> for OPT.  But let's say we were using <strong><code>!!</code></strong> for this.</p>
<p>The behavior would be like writing this at the callsite:</p>
<pre><code>let ^result: some-call xxx yyy zzz
if error? ^result [return ^result]
result: ^result
</code></pre>
<p>So you could rewrite the above as:</p>
<pre><code>change: combinator [
    "Substitute a match with new data"
    return: [~#change~]
    parser [action!]
    replacer [action!]  ; !!! How to say result is used here?
    &lt;local&gt; ^replacement
][
    [^ remainder]: !! parser input  ; first find end position
    [^replacement #]: !! replacer input

    ; CHANGE returns tail, use as new remainder
    ;
    remainder: change:part input ^replacement remainder
    return ~#change~
]
</code></pre>
<p><strong>That's awesome.</strong>  I don't know that I love the <strong><code>!!</code></strong> for the name.  As the comment above shows, I use <code>!!!</code> for attention.  One exclamation point?</p>
<pre><code>    [^ remainder]: ! parser input  ; first find end position
    [^replacement' #]: ! replacer input
</code></pre>
<p>That's too slight.  Something out of left field... maybe a visual indication of "pass this error up?"</p>
<pre><code>    [^ remainder]: --^ parser input  ; first find end position
    [^replacement' #]: --^ replacer input
</code></pre>
<p>Or something to indicate what you're passing up, like <code>*</code> for "problem"?</p>
<pre><code>    [^ remainder]: *--^ parser input  ; first find end position
    [^replacement #]: *--^ replacer input
</code></pre>
<p>Interesting looking ideas... but would be a caret-in-word exception.  <img src="../../images/emoji/twitter/frowning.png%3Fv=14" title=":frowning:" class="emoji" alt=":frowning:" loading="lazy" width="20" height="20">  <em>(There's not--I suppose--any particular reason why you can't have carets in words if they're not at the head...we allow it for tick marks.)</em></p>
<h2><a name="p-8092-nuance-of-slashes-i-realized-3" class="anchor" href="2389.html#p-8092-nuance-of-slashes-i-realized-3"></a>Nuance of Slashes I Realized</h2>
<p>I've mentioned the goal that if you write something like <strong>not/even?</strong> that would act as if you had written <strong>not even?</strong>.  I presumed that wouldn't be useful typically, but it would be useful if you were using a terminal slash, and trying to pass the cascade of functions as a single value somewhere, e.g.</p>
<pre><code> &gt;&gt; match not/even?/ 7 
 == 7
</code></pre>
<p><em>BUT</em> there's a rule in infix deferred processing that it runs "one expression evaluation to the left".</p>
<p>This means <strong><code>!!/foo</code></strong> could be used to <em>not disrupt the infix deferred logic</em>.  It's more general than just this case, which is awesome.  But it definitely helps here.</p>
<h2><a name="p-8092-ill-write-it-up-but-it-needs-a-name-4" class="anchor" href="2389.html#p-8092-ill-write-it-up-but-it-needs-a-name-4"></a>I'll Write It Up, But It Needs a Name...</h2>
<p>Suggestions, please!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../solving-the-pox-of-the-lift-the-universe/2477/8.html">Solving the Pox of the (^)... LIFT the Universe?</a>
                        <meta itemprop='position' content='1'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../could-the-operator-do-something-haskell-y/2440.html">Could The &gt;&gt;= Operator Do Something Haskell-Y</a>
                        <meta itemprop='position' content='2'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../when-should-evaluative-constructs-return-error/2506.html">When Should Evaluative Constructs Return ERROR! ?</a>
                        <meta itemprop='position' content='3'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../introducing-reframer-close-cousin-to-enclose/1395/4.html">Introducing REFRAMER: Close Cousin to ENCLOSE</a>
                        <meta itemprop='position' content='4'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/bradrn'><span itemprop='name'>bradrn</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-04-05T08:04:19Z' class='post-time'>
                    April 5, 2025,  8:04am
                  </time>
                  <meta itemprop='dateModified' content='2025-06-01T21:37:16Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="2389">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p><strong>That's awesome.</strong> I don't know that I love the <strong><code>!!</code></strong> for the name</p>
</blockquote>
</aside>
<p>It is great! I love that Ren-C has become a language where you can do this.</p>
<p>(And personally, I’d be fine with calling it <code>?</code>.)</p>
<aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="2389">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<h2>I'll Write It Up, But It Needs a Name...</h2>
<p>Suggestions, please!</p>
</blockquote>
</aside>
<p>I think ‘error propagation operator’ is a fine name. But somehow, I suspect that name would be a little too clunky for your tastes…</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-04-05T08:25:23Z' class='post-time'>
                    April 5, 2025,  8:25am
                  </time>
                  <meta itemprop='dateModified' content='2025-06-01T21:38:16Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="bradrn" data-post="2" data-topic="2389">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/bradrn/48/365_2.png" class="avatar"> bradrn:</div>
<blockquote>
<p>It is great! I love that Ren-C has become a language where you can do this.</p>
</blockquote>
</aside>
<p>Still a lot of questions to be answered, but it really is night and day from the historical binding model.</p>
<p>One question to answer with <strong>!!</strong> though is what to do about it when the concept of "what to call to propagate" isn't named RETURN.</p>
<p>Though as it so happens, generators aren't allowed to YIELD a raised error.  There is only one raised error contractually that arises from a generator, and that's the generation termination error.  This way if you intercept a raised error from a generator you can assume the reason why and act on it.  All other raised errors will be promoted to abrupt failure before the YIELD can give them back.</p>
<p>But maybe you have a CATCH + THROW situation and you want the throw to be what you use.</p>
<p>The just-a-thought-for-now concept of <strong><a href="../dialecting-function-calls-new-weird-powerful/2310.html">dialecting function calls</a></strong> might have some options here.  What about <strong><code>!!:throw</code></strong></p>
<pre><code>result: catch [
   !!:throw some expression
   !!:throw some other expression
   print "Then you get here"
   throw &lt;success&gt;
] except e -&gt; [
   print ["You failed!" mold e]
]
</code></pre>
<p>So it could presume RETURN if you don't say otherwise, yet still be used for other things.</p>
<p>The dialected function call concept has been simmering a bit, and I do keep finding places where I think it would be nice.</p>
<p>Prior to that being decided, there could still be a convention to name your own variants, e.g. <strong>!!-THROW</strong></p>
<pre><code>result: catch [
   !!-throw some expression
   !!-throw some other expression
   print "Then you get here"
   throw &lt;success&gt;
] except e -&gt; [
   print ["You failed!" mold e]
]
</code></pre>
<p>And you could define it within a context if you planned to use it a lot:</p>
<pre><code>result: catch [
   let !!: !!-throw/
   !! some expression
   !! some other expression
   print "Then you get here"
   throw &lt;success&gt;
] except e -&gt; [
   print ["You failed!" mold e]
]
</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-04-05T12:02:42Z' class='post-time'>
                    April 5, 2025, 12:02pm
                  </time>
                  <meta itemprop='dateModified' content='2025-06-02T14:53:54Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="3" data-topic="2389">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>Though as it so happens, generators aren't allowed to YIELD a raised error. There is only one raised error contractually that arises from a generator, and that's the generation termination error. This way if you intercept a raised error from a generator you can assume the reason why and act on it. All other raised errors will be promoted to abrupt failure before the YIELD can give them back.</p>
</blockquote>
</aside>
<p>Though I will make the not-insignificant-point that you can beat this by wrapping your generator up to use lift/unlift.</p>
<p>Basically wrap GENERATOR such that your version's YIELD does a lifted-yield, and that the generator itself is adapted to unlift the result.</p>
<p>You will have successfully built a generator which can conflate ERROR! antiforms with the "no more to generate" error.</p>
<p><em>(If it turns out people actually find they want to do this commonly, it could just be a refinement.  GENERATOR:CONFLATE or something.)</em></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-06-29T10:37:33Z' class='post-time'>
                    June 29, 2025, 10:37am
                  </time>
                  <meta itemprop='dateModified' content='2025-06-29T10:37:33Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="2389">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<pre data-code-wrap="plaintext"><code class="lang-plaintext">  [^ remainder]: !! parser input  ; first find end position
  [^replacement #]: !! replacer input
</code></pre>
</blockquote>
</aside>
<p>I'm trying to implement a poor-man's version of the error propagation operator inside the C source itself, using some various tricks.</p>
<p>But given that it's C I have to use a C identifier for the name.</p>
<p>I actually was thinking of TRAP:</p>
<pre><code> Index i = TRAP(Series_Index(series));
 if (i &gt; 0)
     Do_Something();
</code></pre>
<p>Imagine that transforming into something like:</p>
<pre><code> Index i = Trap_Series_Index(series);
 if (Did_Trap_Error()) return Trapped_Error();
 if (i &gt; 0)
     Do_Something();
</code></pre>
<p>The idea is that it's using a global (well, thread-local) state to communicate if the function raised an error.  The Trap_XXX() name suggests that it is a function participating in this protocol, and hence you shouldn't use its result directly (e.g. because the index could be invalid).</p>
<p>Hence the macro would look like:</p>
<pre><code>#define TRAP(expr) \
     Trap_##expr; if (Did_Trap_Error()) return Trapped_Error();
</code></pre>
<h2><a name="p-8486-could-trap-be-the-name-of-the-operator-1" class="anchor" href="2389.html#p-8486-could-trap-be-the-name-of-the-operator-1"></a>Could TRAP Be The Name Of The Operator?</h2>
<pre data-code-wrap="plaintext"><code class="lang-plaintext">change: combinator [
    "Substitute a match with new data"
    return: [~#change~]
    parser [action!]
    replacer [action!]  ; !!! How to say result is used here?
    &lt;local&gt; ^replacement
][
    [^ remainder]: trap parser input  ; first find end position
    [^replacement #]: trap replacer input

    ; CHANGE returns tail, use as new remainder
    ;
    remainder: change:part input ^replacement remainder
    return ~#change~
]
</code></pre>
<p>The part of the name that sort of makes sense is that it's one of the operations that stops an ERROR! from promoting to a panic.  So it "traps" it.</p>
<p>On first glance, that doesn't really convey anything about "and after you trap it, use it as the return value for the current meaning of RETURN"</p>
<p>The thing is, when you see it written like this... <em>there's kind of nowhere else for the error to go, but up</em>.  You evaluated the expression, it produced an ERROR!, you've trapped it...</p>
<p>...but you're a single arity-function.  What are you going to do with the error?  If you return it as your synthesized result, you're a no-op.  If you panic, you served no purpose..that's what would have presumably happened otherwise.  If you return a WARNING! or similar, you've conflated with non-erroring states...</p>
<p>EXCEPT is an infix function and arity-2, it does routing.  But TRAP as a prefix function would either need to take a handler as a second argument, or be single-arity and do this forwarding/propagation.</p>
<h2><a name="p-8486-it-seems-promising-2" class="anchor" href="2389.html#p-8486-it-seems-promising-2"></a>It Seems Promising</h2>
<p>I like the idea of the parity with the interpreter source, and that means making it a word has benefit.</p>
<p>So I'll try going in this direction for now.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-07-06T09:51:43Z' class='post-time'>
                    July 6, 2025,  9:51am
                  </time>
                  <meta itemprop='dateModified' content='2025-07-06T09:51:43Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="5" data-topic="2389">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>On first glance, that doesn't really convey anything about "and after you trap it, use it as the return value for the current meaning of RETURN"</p>
</blockquote>
</aside>
<p>So I've tried TRAP, and I definitely do like having the same word used in the C sources in my poor-man's Rust trick... being a word and not something symbol-y is good.  I'm just about ready to commit to it.</p>
<p>But in terms of leaving no-stone-unturned, had another weird idea for a name: <strong>BUBBLE</strong>.</p>
<p><img src="../../images/emoji/twitter/bubbles.png%3Fv=14" title=":bubbles:" class="emoji only-emoji" alt=":bubbles:" loading="lazy" width="20" height="20"></p>
<p>Off-the-wall, but... all words that enter the programming domain start as seeming odd, I think (<em>"THROW, CATCH... What is this, a football?"</em>)  But things are driven by analogy.</p>
<pre data-code-wrap="plaintext"><code class="lang-plaintext">change: combinator [
    "Substitute a match with new data"
    return: [~#change~]
    parser [action!]
    replacer [action!]  ; !!! How to say result is used here?
    &lt;local&gt; ^replacement
][
    [^ remainder]: bubble parser input  ; first find end position
    [^replacement #]: bubble replacer input

    ; CHANGE returns tail, use as new remainder
    ;
    remainder: change:part input ^replacement remainder
    return ~#change~
]
</code></pre>
<h2><a name="p-8497-bubble-isnt-errorish-trap-isnt-bubble-ish-1" class="anchor" href="2389.html#p-8497-bubble-isnt-errorish-trap-isnt-bubble-ish-1"></a>BUBBLE Isn't Errorish, TRAP Isn't Bubble-ish</h2>
<p>But bubble looks weird, and I think the brevity and relevance of TRAP wins out here.  You learn what it means.</p>
<p>You have to read it as "make this <em>function</em> trap the error".  e.g. make the whole function act as a trap.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-07-10T03:45:18Z' class='post-time'>
                    July 10, 2025,  3:45am
                  </time>
                  <meta itemprop='dateModified' content='2025-07-10T03:45:18Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="6" data-topic="2389">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>So I've tried TRAP, and I definitely do like having the same word used in the C sources in my poor-man's Rust trick... being a word and not something symbol-y is good. I'm just about ready to commit to it.</p>
</blockquote>
</aside>
<p>Aaaand I've committed it... <em><a href="https://github.com/hostilefork/ren-c/commit/80b2469c711de63ccf22dc83e279f21a39206e5e#diff-59c2d687e1e6ff36e7b8bd41de137836741a51260a2a2ad6ad90c23c30a89da9">to my side branch</a></em>.</p>
<pre><code>This makes a native that acts a bit like Rust's "?" operator so that
if you pass it an ERROR!, it will propagate that with a call to whatever
RETURN is defined as in the local scope.

Hence this:

    trappy: func [] [
        let x: trap 1 * 0
        let y: trap 1 / 0
        return x + y
    ]

Acts equivalently to if you'd written:

    trappy: func [] [
        let x: (1 * 0) except e -&gt; [return fail e]
        let y: (1 / 0) except e -&gt; [return fail e]
        return x + y
    ]
</code></pre>
<p>Not a ton of the code is modernized to use definitional failures well... so there aren't actually all that many instances of EXCEPT in the code base to replace with TRAP yet.  The exception would be UPARSE, where you can see it tightens things up quite a bit:</p>
<h2><a name="p-8501-new-executables-soon-ish-i-hope-1" class="anchor" href="2389.html#p-8501-new-executables-soon-ish-i-hope-1"></a>New Executables... Soon-ish... I hope...</h2>
<p>While it seems like I'll be off on the side branch forever, things are starting to align to where I will hopefully not be <em>too</em> much longer before all these cool features make it to the deployed web console, and a batch of new EXEs.</p>
<p>(The good news about why it's taking so long is because I keep finding solutions to longstanding problems, and I feel like I need to push every solution through as far as it can go until it sort of plateaus, at which point it will be time for a release.)</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-07-12T12:30:37Z' class='post-time'>
                    July 12, 2025, 12:30pm
                  </time>
                  <meta itemprop='dateModified' content='2025-07-12T12:30:37Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="7" data-topic="2389">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<pre data-code-wrap="plaintext"><code class="lang-plaintext">    trappy: func [] [
        let x: trap 1 * 0
        let y: trap 1 / 0
        return x + y
    ]
</code></pre>
</blockquote>
</aside>
<p>I'll mention something kind of curious.</p>
<p>You can actually put the TRAP on the outside of the assignment:</p>
<pre><code>trappy: func [] [
    trap let x: 1 * 0
    trap let y: 1 / 0
    return x + y
]
</code></pre>
<p>If you weren't using LETs here and depending on the variables surviving the scope, you could even use parentheses:</p>
<pre><code>trappy: func [&lt;local&gt; x y] [
    trap (x: 1 * 0)
    trap (y: 1 / 0)
    return x + y
]
</code></pre>
<p>This is because the way plain assignment works, it will skip the assignment in case of an error and the overall expression evaluates to an error.</p>
<p>Note that ^META assignments are different:</p>
<pre><code>trap ^x: fail "different!"
</code></pre>
<p>This would <em>not</em> skip the assignment.  Which means that's fundamentally distinct from:</p>
<pre><code>^x: trap fail "different!"
</code></pre>
<p>I'll mention that the new REQUIRE operator is a general tool for ducking the assignment of errors and failing afterwards when using meta assignment:</p>
<pre><code>^x: require some-potentially-erroring-thing
</code></pre>
<p>Part of what makes this interesting is that I've aligned the C code to use the same techniques and terminology.  So you will see calls to <strong><code>trap ()</code></strong> that propagate errors to the return of the running function (via macro) by testing a global error state.  These calls have to be on the outside in order to be "safe", to avoid usages which might break due to being used in branches without scopes.  Random details here--but--it's cool that the usermode constructs support the style that the C code is forced to use.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
