<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Getting Out Of ENTRAP-ment - Errors - AltRebol</title>
    <meta name="description" content="When antiform ERROR! first arrived, there needed to be a way to capture them. 
I was uncomfortable having the LIFT operator blindly turn an antiform ERROR! into a quasi-ERROR!, because that could sweep things under the r&amp;hellip;">
    <meta name="generator" content="Discourse 3.5.0.beta6-dev - https://github.com/discourse/discourse version 623cde985b21c2ed812b83d3ea94f69231613718">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="2444.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

    <link href="https://rebol.metaeducation.com/stylesheets/color_definitions_base__2_ceb61c279a74dfa3cef6a62f7784988102abec82.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" class="light-scheme"/>

<link href="https://rebol.metaeducation.com/stylesheets/common_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common"  />

  <link href="https://rebol.metaeducation.com/stylesheets/desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="desktop"  />



    <link href="https://rebol.metaeducation.com/stylesheets/chat_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-details_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-lazy-videos_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-local-dates_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-narrative-bot_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="https://rebol.metaeducation.com/stylesheets/discourse-presence_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="https://rebol.metaeducation.com/stylesheets/docker_manager_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="https://rebol.metaeducation.com/stylesheets/footnote_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll"  />
    <link href="https://rebol.metaeducation.com/stylesheets/spoiler-alert_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="spoiler-alert"  />
    <link href="https://rebol.metaeducation.com/stylesheets/chat_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="chat_desktop"  />
    <link href="https://rebol.metaeducation.com/stylesheets/poll_desktop_e0a75505da9bc96953dd62a4aad773a25cca0f8e.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://rebol.metaeducation.com/stylesheets/common_theme_2_57fe803ed5a41e9f7d94086afaf66a1aab57d9ae.css?__ws=rebol.metaeducation.com" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="2" data-theme-name="default"/>
    

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Getting Out Of ENTRAP-ment&#39;" href="2444.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://rebol.metaeducation.com/t/getting-out-of-entrap-ment/2444" />
<meta name="twitter:url" content="https://rebol.metaeducation.com/t/getting-out-of-entrap-ment/2444" />
<meta property="og:title" content="Getting Out Of ENTRAP-ment" />
<meta name="twitter:title" content="Getting Out Of ENTRAP-ment" />
<meta property="og:description" content="When antiform ERROR! first arrived, there needed to be a way to capture them.  I was uncomfortable having the LIFT operator blindly turn an antiform ERROR! into a quasi-ERROR!, because that could sweep things under the rug.  You might have been LIFT-ing because you wanted to capture a PACK! (including VOID) or so you could put a NULL or SPLICE! into a BLOCK!.  Why would you conflate that with error suppression?  So there was LIFT that didn&#39;t meta an ERROR! antiform, and LIFT* that would.  Now yo..." />
<meta name="twitter:description" content="When antiform ERROR! first arrived, there needed to be a way to capture them.  I was uncomfortable having the LIFT operator blindly turn an antiform ERROR! into a quasi-ERROR!, because that could sweep things under the rug.  You might have been LIFT-ing because you wanted to capture a PACK! (including VOID) or so you could put a NULL or SPLICE! into a BLOCK!.  Why would you conflate that with error suppression?  So there was LIFT that didn&#39;t meta an ERROR! antiform, and LIFT* that would.  Now yo..." />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:section" content="Errors" />
<meta property="og:article:section:color" content="25AAE2" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="1 ❤" />
<meta property="article:published_time" content="2025-05-11T11:04:52+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://rebol.metaeducation.com/">AltRebol</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="2444.html">Getting Out Of ENTRAP-ment</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/development/errors/54" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://rebol.metaeducation.com/c/development/errors/54" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Errors</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Getting Out Of ENTRAP-ment'>
      <link itemprop='url' href='2444.html'>
      <meta itemprop='datePublished' content='2025-05-11T11:04:52Z'>
        <meta itemprop='articleSection' content='Errors'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://rebol.metaeducation.com/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="2444.html">


              <span class="crawler-post-infos">
                  <time  datetime='2025-05-11T11:04:52Z' class='post-time'>
                    May 11, 2025, 11:04am
                  </time>
                  <meta itemprop='dateModified' content='2025-06-02T17:55:18Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>When antiform ERROR! first arrived, there needed to be a way to capture them.</p>
<p>I was uncomfortable having the LIFT operator blindly turn an antiform ERROR! into a quasi-ERROR!, because that could sweep things under the rug.  You might have been LIFT-ing because you wanted to capture a PACK! (including VOID) or so you could put a NULL or SPLICE! into a BLOCK!.  Why would you conflate that with error suppression?</p>
<p>So there was LIFT that didn't meta an ERROR! antiform, and LIFT* that would.</p>
<p>Now you want to capture an error from an operation.  You've got a situation like:</p>
<pre><code>result': lift* eval code

if error? unlift result' [
     let warning: unquasi result'
     ; ... handle disarmed error (warning) ...
] else [
    let result: unlift result'
    ; ... handle result ...
]
</code></pre>
<p>I thought this was a bit more painful than it needed to be, so I created ENTRAP.</p>
<pre><code>result': entrap code

if warning? result' [
     ; ... handle disarmed error (warning) in result' ...
] else [
    let result: unlift result'
    ; ... handle result ...
]
</code></pre>
<p>Not a heck of a lot better.  But saved a bit of boilerplate.</p>
<h2><a name="p-8250-now-we-can-do-better-1" class="anchor" href="2444.html#p-8250-now-we-can-do-better-1"></a>Now We Can Do Better!</h2>
<p><strong>(^result: ...)</strong> will write the lifted representation of the evaluation into result, <em>but still return the original result</em>.  So if the original result was an ERROR! it will still be an error out.</p>
<p>But you can suppress that.  So look at this magic:</p>
<pre><code>try ^result: eval code  ; TRY suppresses, but meta-ERROR! still wrote to result

if error? ^result [
     ; ... handle error in ^result ...
] else [
    ; ... handle original result as ^result ...
]
</code></pre>
<p><img src="../../images/emoji/twitter/bullseye.png%3Fv=14" title=":bullseye:" class="emoji only-emoji" alt=":bullseye:" loading="lazy" width="20" height="20"></p>
<h2><a name="p-8250-so-what-then-is-trap-now-2" class="anchor" href="2444.html#p-8250-so-what-then-is-trap-now-2"></a>So What, Then, Is TRAP Now?</h2>
<p>Right now EVAL only lets you bubble out an error if it's the last step.  Interstitial ERROR! will lead to a PANIC if there's no triage:</p>
<pre><code>&gt;&gt; error? eval [print "step one" 1 / 0]
step one
== \~okay~\  ; antiform

&gt;&gt; error? eval [1 / 0 print "step two"]
!! PANIC: division by zero
</code></pre>
<p>That's kind of a non-negotiable default, because when you branch and pipe ERROR! values around you intend for the error to be the product of the last branch step, not some incidental code that ran before that last step.</p>
<p>So maybe TRAP is a construct that lets you bail early, getting an error from any step:</p>
<pre><code>&gt;&gt; error? trap [print "step one" 1 / 0]
step one
== \~okay~\  ; antiform

&gt;&gt; error? trap [1 / 0 print "step two"]
== \~okay~\  ; antiform
</code></pre>
<p>Or maybe that's a refinement to EVAL.  I dunno.</p>
<p>Another thing to point out is that ERROR! is not an exception (panic).  It's a FAIL state that can be piped around.  So using EXCEPT as name for the postfix error handler is a little off:</p>
<pre><code> eval code except ^e -&gt; [
    ; handle ERROR!
 ]
</code></pre>
<p>Should that be TRAP ?</p>
<pre><code> eval code trap ^e -&gt; [
    ; handle ERROR!
 ]
</code></pre>
<p>Food for thought.  In any case, I'm really pleased to see how (^x: ...) vs. (try ^x: ...) offers the choices I was seeking, in so much cleaner a way.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-05-11T11:12:39Z' class='post-time'>
                    May 11, 2025, 11:12am
                  </time>
                  <meta itemprop='dateModified' content='2025-06-02T17:56:24Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="2444">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>I was uncomfortable having the LIFT operator blindly turn an antiform ERROR! into a quasi-ERROR!, because that could sweep things under the rug. You might have been LIFT-ing because you wanted to capture a PACK! (including VOID) or so you could put a NULL or SPLICE! into a BLOCK!. Why would you conflate that with error suppression?</p>
<p>So there was LIFT that didn't meta an ERROR! antiform, and LIFT* that would.</p>
</blockquote>
</aside>
<p>I should point out that this is probably still a good idea.</p>
<p>It's true that you'll be able to put things in blocks by doing things like:</p>
<pre><code>block.^1: eval [...]
</code></pre>
<p>Instead of:</p>
<pre><code>block.1: lift eval [...]
</code></pre>
<p>And you'd be sort-of protected in that case, because if you don't TRY the result the ERROR! would still fall out the assignment.  (I say "sort-of" because you find out only after it's done the change, and written the meta-error into your block).</p>
<p>But then there's cases like:</p>
<pre><code>append [a b c] lift eval [...]
</code></pre>
<p>And there you're back where you started, with putting lifted-errors in blocks vs. panicking at that moment when you probably wanted to.</p>
<p>So needing <strong><code>lift:relax</code></strong> in order to be willing to meta-represent errors, and shorthanded as <strong><code>lift*</code></strong>, feels like it makes a lot of sense.</p>
<p><em>(Do note that REIFY and DEGRADE exist if quasiforms are out of band of your data, and has the nice property of just making little quasiforms for your voids and nulls and splices and such, without adding quote levels to normal values.  There is no REIFY:RELAX at this time, though perhaps there should be.)</em></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='https://rebol.metaeducation.com/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-05-11T11:24:42Z' class='post-time'>
                    May 11, 2025, 11:24am
                  </time>
                  <meta itemprop='dateModified' content='2025-06-02T17:57:27Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group quote-modified" data-username="hostilefork" data-post="2" data-topic="2444">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/rebol.metaeducation.com/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<pre data-code-wrap="plaintext"><code class="lang-plaintext">block.^1: eval [...]
</code></pre>
<p>And you'd be sort-of protected in that case, because if you don't TRY the result the ERROR! would still fall out the assignment. (I say "sort-of" because you find out only after it's done the change, and written the meta-error into your block).</p>
</blockquote>
</aside>
<p>This "not stopping the write" aspect is actually a pretty serious fundamental thing to be taken into account for using this form.</p>
<p>It suggests you should never use <strong><code>foo.^xxx:</code></strong> unless you are intending to write errors, or unless you've made sure you're not writing errors some other way.</p>
<pre><code>foo.^xxx: eval code except ^e -&gt; [...]  ; not writing error
</code></pre>
<p>Though that calls into question the "what if an EXCEPT block evaluates to a raised error" issue, which maybe should be prevented, at least by default--unless you use EXCEPT:RELAX or something.  <img src="../../images/emoji/twitter/face_with_diagonal_mouth.png%3Fv=14" title=":face_with_diagonal_mouth:" class="emoji" alt=":face_with_diagonal_mouth:" loading="lazy" width="20" height="20"></p>
<p>Anyway, I just wanted to bring up this caution, that writing <strong>(foo.^xxx: ...)</strong> is a power tool that needs to be used carefully, <em>since it never fails to overwrite the variable.</em></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://rebol.metaeducation.com/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://rebol.metaeducation.com/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
