<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Brave SWITCH new .WORLD [?] - Skippable Predicates - Internals - AltRebol</title>
    <meta name="description" content="Note: This post was originally written to use REFINEMENT! for the predicates.  However, generalized TUPLE! has seemed more favorable, so thatâ€™s whatâ€™s used when talking about it nowâ€¦even though generalized tuples do not&amp;hellip;">
    <meta name="generator" content="Discourse 3.1.0.beta4 - https://github.com/discourse/discourse version 25276f62f959eab4557049a655300a70835c5769">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1045.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

    <link href="https://forum.rebol.info/stylesheets/color_definitions_base__2_caa66e77e807fc270e5b21d201643962219b6a9a.css?__ws=forum.rebol.info" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://forum.rebol.info/stylesheets/desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://forum.rebol.info/stylesheets/chat_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-details_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-lazy-videos_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-local-dates_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-narrative-bot_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-presence_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://forum.rebol.info/stylesheets/docker_manager_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="https://forum.rebol.info/stylesheets/poll_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://forum.rebol.info/stylesheets/chat_desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat_desktop"  />
  <link href="https://forum.rebol.info/stylesheets/poll_desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://forum.rebol.info/stylesheets/desktop_theme_2_5e18a6fac02b6ab11e33445179f4a2961aadbfd8.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="default"/>

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Brave SWITCH new .WORLD [?] - Skippable Predicates&#39;" href="1045.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/brave-switch-new-world-skippable-predicates/1045" />
<meta name="twitter:url" content="https://forum.rebol.info/t/brave-switch-new-world-skippable-predicates/1045" />
<meta property="og:title" content="Brave SWITCH new .WORLD [?] - Skippable Predicates" />
<meta name="twitter:title" content="Brave SWITCH new .WORLD [?] - Skippable Predicates" />
<meta property="og:description" content="Note: This post was originally written to use REFINEMENT! for the predicates.  However, generalized TUPLE! has seemed more favorable, so that&#39;s what&#39;s used when talking about it now...even though generalized tuples do not exist at time of writing.   It&#39;s a bummer that all the Rebol functions like SWITCH or FIND use some kind of internal magic operator to decide if things are equal.  We&#39;d like that operator to be less opaque and more clearly documented and understandable, and it&#39;s in the long to..." />
<meta name="twitter:description" content="Note: This post was originally written to use REFINEMENT! for the predicates.  However, generalized TUPLE! has seemed more favorable, so that&#39;s what&#39;s used when talking about it now...even though generalized tuples do not exist at time of writing.   It&#39;s a bummer that all the Rebol functions like SWITCH or FIND use some kind of internal magic operator to decide if things are equal.  We&#39;d like that operator to be less opaque and more clearly documented and understandable, and it&#39;s in the long to..." />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:section" content="Internals" />
<meta property="og:article:section:color" content="25AAE2" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="4 mins ðŸ•‘" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="6 â¤" />
<meta property="article:published_time" content="2019-01-31T11:16:33+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://forum.rebol.info/">
    AltRebol
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="1045.html">Brave SWITCH new .WORLD [?] - Skippable Predicates</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/8" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/internals/9" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Internals</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Brave SWITCH new .WORLD [?] - Skippable Predicates'>
        <meta itemprop='articleSection' content='Internals'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>

          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1045.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-01-31T11:16:33Z' class='post-time'>
                    January 31, 2019, 11:16am
                  </time>
                  <meta itemprop='dateModified' content='2019-02-04T11:25:41Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='articleBody'>
              <blockquote>
<p><strong>Note:</strong> This post was originally written to use REFINEMENT! for the predicates.  However, generalized TUPLE! has seemed more favorable, so that's what's used when talking about it now...even though generalized tuples do not exist at time of writing.</p>
</blockquote>
<p>It's a bummer that all the Rebol functions like SWITCH or FIND use some kind of internal magic operator to decide if things are equal.  We'd like that operator to be less opaque and more clearly documented and understandable, and it's in the long to-do-list... to try and figure out how it ties into IS-ness or MATCH-ness or whatever it is.</p>
<p>Still, no matter what the default is, we know we need a way to override it.  Ren-C had added a /STRICT refinement to SWITCH to deal with this case:</p>
<pre><code>&gt;&gt; switch 0.01 [1% [&lt;pretty lax...&gt;] 0.01 [&lt;stricter&gt;]]
&lt;pretty lax...&gt;

&gt;&gt; switch/strict 0.01 [1% [&lt;pretty lax...&gt;] 0.01 [&lt;stricter&gt;]]
&lt;stricter&gt;
</code></pre>
<p>But the name "strict" wasn't something super agreed upon.  And it's just the tip of the iceberg, you kind of want to pass in more functions.  That seems kind of ugly.</p>
<pre><code>&gt;&gt; switch/compare 0.01 [1% [&lt;pretty lax...&gt;] 0.01 [&lt;stricter&gt;]] :==
&lt;stricter&gt;
</code></pre>
<h2>Fancy New Experiment: Skippable Refinements that ARE the compare!</h2>
<p>Dig this (and it will look even better when EQUAL? and = are strict by default, and IS is the lax operator...)</p>
<pre><code>&gt;&gt; switch 0.01 [1% [&lt;pretty lax...&gt;] 0.01 [&lt;stricter&gt;]]
&lt;pretty lax...&gt;

&gt;&gt; switch 0.01 /strict-equal? [1% [&lt;pretty lax...&gt;] 0.01 [&lt;stricter&gt;]]
&lt;stricter&gt;

&gt;&gt; switch 0.01 /== [1% [&lt;pretty lax...&gt;] 0.01 [&lt;stricter&gt;]]
&lt;stricter&gt;
</code></pre>
<p>There's a skippable slot for a "refinement" (blank-headed PATH!) <em>between the thing you're switching on and the cases block</em>.  And it looks up to an ACTION!.</p>
<p>It also accepts literal ACTION!s.  You won't/can't type that in by hand...but that means if you're doing an APPLY there's a normal frame slot for your compare to go into.  (It's one of the nice things about skippable parameters being knownst to the system in a way that variadic parameters are not.)  If you need a SWITCH variation with a different interface you can make one out of this one.</p>
<p>Notice that the interpretation puts the switched-on expression on the <em>left</em> or in the <em>first</em> argument.</p>
<pre><code>&gt;&gt; x: 10
== 10

&gt;&gt; switch x /greater? [20 [&lt;nope&gt;] 5 [&lt;yep&gt;]]
== &lt;yep&gt;
</code></pre>
<p><strong>Before we go propagating the idea all over the system, why not give this a spin.</strong>  Kick the tires a bit.  <em>Write some tests!</em></p>
<pre><code>&gt;&gt; x: 10

&gt;&gt; switch x /(reduce pick [:greater? :lesser?] 1) [20 [&lt;a&gt;] 5 [&lt;b&gt;]]
== &lt;b&gt;

&gt;&gt; switch x /(reduce pick [:greater? :lesser?] 2) [20 [&lt;a&gt;] 5 [&lt;b&gt;]]
== &lt;a&gt;</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../should-append-null-fail-append-blank-add-nothing-unless-only/635/6.html">Why APPEND of NULL fails, and APPEND of VOID is a No-Op</a>
                        <meta itemprop='position' content='1'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../get-block-get-and-reduce/1183/3.html">GET-BLOCK!, GET, and REDUCE</a>
                        <meta itemprop='position' content='2'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../default-now-usable-in-case-switch/739/3.html">DEFAULT now usable in CASE, SWITCH (!)</a>
                        <meta itemprop='position' content='3'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../tag-compose-is-it-tag-specific-composition/979/7.html">The Superpowers of Ren-C&#39;s Revamped COMPOSE</a>
                        <meta itemprop='position' content='4'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../pure-and-refined-simplifying-refinements-to-one-or-zero-args/1120.html">Pure and Refined: Simplifying Refinements to One or Zero Args</a>
                        <meta itemprop='position' content='5'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../block-and-object-parity-in-pathing-picking/1086.html">BLOCK! and OBJECT! Parity in Pathing/Picking</a>
                        <meta itemprop='position' content='6'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../embracing-dialected-tuple-and-path/1355.html">Embracing Dialected TUPLE! and PATH!</a>
                        <meta itemprop='position' content='7'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1045.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-02-02T01:30:27Z' class='post-time'>
                    February 2, 2019,  1:30am
                  </time>
                  <meta itemprop='dateModified' content='2019-02-02T01:30:27Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I feel like maybe this should be done with generalized TUPLE! instead.</p>
<pre><code>switch obj/value /matches [...]

switch obj/value .matches [...]
</code></pre>
<p>Because the plan is that TUPLE!s will be inert, there's not much odds of you switching on one literally.  But PATH!s you will want to switch on.</p>
<p>As the approach goes on, this will make it harder to do things like FIND on explicit tuples</p>
<pre><code>do [find data .matches integer!]  ; yay, works

do [find css-stuff .class]  ; oops, tries to call CLASS as the predicate
</code></pre>
<p>But with generalized quoting, you'll be able to get around it:</p>
<pre><code>do [find css-stuff '.class]

do [find css-stuff lit .class]
</code></pre>
<p>You just have to understand that TUPLE! has a purpose that is "effectively evaluative", kind of like you have to understand when you go to find WORD!s.  <code>find data my-word</code> already needs a quote or lit.  It comes with the territory.</p>
<p>I'm a little bummed because it kind of feels like these "are refinements", but I think that re-imagining it and saying tuples starting with dot act as predicates (by convention) probably has better bones.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/IngoHohmann'><span itemprop='name'>IngoHohmann</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1045.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-02-02T14:52:43Z' class='post-time'>
                    February 2, 2019,  2:52pm
                  </time>
                  <meta itemprop='dateModified' content='2019-02-02T14:52:43Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I find that tuple looks better, and wins when it comes to ergonomics.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1045.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-02-03T00:27:25Z' class='post-time'>
                    February 3, 2019, 12:27am
                  </time>
                  <meta itemprop='dateModified' content='2019-02-03T02:59:53Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-post="3" data-topic="1045" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/ingohohmann/40/195_2.png" class="avatar"> IngoHohmann:</div>
<blockquote>
<p>I find that tuple looks better, and wins when it comes to ergonomics.</p>
</blockquote>
</aside>
<p>Using something different than refinement could also have another advantage, that it could be interpreted as a kind of chain.  If we assume SWITCH usually goes with IS, you might want to use = for strict equality.  You also might want to use a more literate "equals".  But there isn't any particularly nice way to say "unequals".</p>
<p>So what about just good old:</p>
<pre><code> switch x .not.equals [
     &lt;whatever&gt;
 ]
</code></pre>
<p>Then imagine if we've define IS as <strong>is: :equals/lax</strong>.  So there's a refinement on equals, and you might also call it as:</p>
<pre><code> switch x .not.equals/lax [
     &lt;whatever&gt;
 ]
</code></pre>
<p>So that's an interesting potential advantage.  Though the proposal I have for tuples is that paths take priority, so it would see that as the PATH! [.not.equals lax].  But if the chain is specializing that should still work, e.g. (=&gt; NOT EQUALS) could produce a function that takes one argument and has a /LAX refinement.</p>
<p><em>(This is all pretty out there, and easier said than done...but it does tie into stuff I'd like to see be able to work.  I'm just putting in another point of notational advantage for TUPLE! here.)</em></p>
<p>This also suggests the possibility that a GET-TUPLE! might have a purpose as a chaining generator, e.g.</p>
<pre><code> chain [:a | :b | :c]
      =&gt; get c.b.a 
      =&gt; :c.b.a
</code></pre>
<p>We also might consider if CHAIN should be reversed, which is something that came up before.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1045.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-10-01T11:18:30Z' class='post-time'>
                    October 1, 2019, 11:18am
                  </time>
                  <meta itemprop='dateModified' content='2019-10-01T11:18:30Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Predicates are becoming more critical to think through, as Ren-C tries to pin down some formalisms for off-the-cuff Rebol2-isms.</p>
<p>For instance, consider how Rebol2 blurred lines by considering both literal datatype matches and values-of-that-type to match:</p>
<pre><code> rebol2&gt; find ["A" 10 20] integer!
 == [10 20]

 rebol2&gt; find reduce [string! integer! block!] integer!
 == [integer! block!]  ;...and, it looks like WORD!s :-/
</code></pre>
<p>In moving to using the @[bl o ck] type to represent datatypes, Ren-C is making this more formal:</p>
<pre><code>&gt;&gt; integer!: @[integer]

&gt;&gt; find reduce [text! integer! block!] integer!
== [@[integer] @[block]]  ; distinct from WORD!s
</code></pre>
<p>By and large, the interpretation most natives (including PARSE) will be taking is that <em>often</em> when you are using such an @[bl o ck], you mean to specify a type.  But not always.  Your dialects are free to interpret these other ways.</p>
<p>So I feel that if you want to do a FIND where you're matching against a pattern, that's a job for a predicate.  But where should it go?  How should the parameters be mapped?</p>
<p>Consider that you can write <strong><code>match integer! 10</code></strong> and get 10, but <strong><code>match integer! &lt;tag&gt;</code></strong> and get null.  That means the datatype parameter comes <em>first</em> and the thing to test comes <em>second</em>.  So this predicate looks a bit backwards:</p>
<pre><code> find /match ["A" 10 20] @[integer]
</code></pre>
<p>There's a routine called MATCHES which reverses the order:</p>
<pre><code>&gt;&gt; 10 matches integer!
== 10
</code></pre>
<p>So we might use that instead:</p>
<pre><code>find /matches ["A" 10 20] @[integer]
</code></pre>
<p>But would it look better if it were <em>between</em> ?</p>
<pre><code>find ["A" 10 20] /matches @[integer]
</code></pre>
<p>Or does that only apply for things that are infix?  It's hard to say.</p>
<p>But what I do think is that for a "fancy function" that does something other than an equality comparison on FIND, you should have to ask for it.  We should make it easy to ask, and then people will likely appreciate the more deterministic and reliable behavior.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1045.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2020-01-17T15:31:03Z' class='post-time'>
                    January 17, 2020,  3:31pm
                  </time>
                  <meta itemprop='dateModified' content='2020-01-17T15:31:03Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-post="5" data-topic="1045">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>find ["A" 10 20] /matches @[integer]</p>
</blockquote>
</aside>
<p>There's a technical problem I hadn't noticed until REFINEMENT! and PATH! unified (which we may discuss) but that is that PATH!s are not inert.  This means it's hard to distinguish the above from:</p>
<pre><code> &gt;&gt; find [a b c] obj/thing-to-find   ; evaluative
 ** Error: predicate is not an ACTION!
</code></pre>
<p>e.g. the hard quote recognition of a PATH! sucks in things you might legitimately want to look up and find.  :-/  You don't want to have to subvert this with <strong>find [a b c] (obj/thing-to-find)</strong> or other nonsense.</p>
<p>I'm still rather bullish on <strong>/a/b</strong> being both <em>legal</em> as something in the parts box and the "same-flavored" thing as <strong>/a</strong>.  I'm also not confident that the evaluative advantage of an inert <strong>/a</strong> exceeds being able to get that with <strong>'/a</strong>.  We may not know what the purpose of that leading slash could be, but it is presumably related to how binding is treated.</p>
<p>Yet I mentioned that I thought having TUPLE! be the inert form of PATH! was an interesting idea, as it would provide historical compatibility as well as open up new options.  We don't have it yet, but its inert status would make it the clear better choice for this function.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1045.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2020-09-20T22:42:46Z' class='post-time'>
                    September 20, 2020, 10:42pm
                  </time>
                  <meta itemprop='dateModified' content='2020-09-20T22:45:51Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-post="6" data-topic="1045">
<div class="title">
<div class="quote-controls"></div>
<img alt width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>Yet I mentioned that I thought having TUPLE! be the inert form of PATH! was an interesting idea, as it would provide historical compatibility as well as open up new options. We don't have it yet, but its inert status would make it the clear better choice for this function.</p>
</blockquote>
</aside>
<p>My idea of tuples not being inert, but operating the same as paths but with constrained rules (<a href="../tuple-and-path-big-picture-concept/1330.html">"thing to the left of a dot is not a function"</a>) has such strong advantages I'm hard-pressed to justify tuple as being <em>generically</em> inert.</p>
<p>But if your tuple starts with an inert value, then making it inert offers compatibility advantages (e.g. 128.0.0.1).  Then things like <strong>.foo.bar</strong> should also be inert, because they technically start with BLANK!.</p>
<p>So that part is good, but it still has the problem that the type alone can't dictate whether you want a predicate.  If a TUPLE! can evaluate to a thing to be found like a WORD! would, you don't want all TUPLE!s to get sucked up by a skippable parameter that only sees a TUPLE!.</p>
<p>So you want a <em>constrained type</em>.  If it's a TUPLE! (or PATH! or whatever) you're only interested in it as a predicate if it starts with BLANK!.</p>
<p>Of course constraining the instance of the value based on something more than just its raw type is a desirable feature.  I've talked about constructing things like EVEN-INTEGER!.  So if <strong><code>/foo</code></strong> is a REFINEMENT! and <strong><code>.foo</code></strong> is a PREDICATE! in this constrained-type universe, I guess that's all right.</p>
<p>The part I find a bit unfortunate about all of this is that it kind of seals the deal that BLANK!-headed paths (and hence "refinements") remain inert in the evaluator.  Not that I knew exactly what else they were going to do, but I thought they might have some kind of meaning in namespacing (or something).  This may be the final nail in that coffin.</p>
<p>But hey, many other wishes have come true.  Can't have everything.  But predicates are needed, I want to be able to say <strong>any .even? [1 7 5 9 10 3]</strong> and such, and have been bothered that these generic things aren't available...when they should be easy to make.  (Notationally, <strong>any/predicate [1 7 5 9 10 3] :even?</strong> is just too awkward...though you would still be able to say that with a skippable parameter at another position!)</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1045.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2021-08-22T23:11:11Z' class='post-time'>
                    August 22, 2021, 11:11pm
                  </time>
                  <meta itemprop='dateModified' content='2021-08-23T05:05:52Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group quote-modified" data-username="hostilefork" data-post="1" data-topic="1045">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<pre><code>&gt;&gt; x: 10
== 10

&gt;&gt; switch x .greater? [20 [&lt;nope&gt;] 5 [&lt;yep&gt;]]
== &lt;yep&gt;
</code></pre>
<p>Before we go propagating the idea all over the system, why not give this a spin.</p>
</blockquote>
</aside>
<p>Having given this the spin, I have found a couple of problems...</p>
<h2>ACTION!s Being Hard Quoted Instead of Run</h2>
<p>The /PREDICATE refinement not only takes TUPLE!, but it also is willing to take ACTION!.  That's in case you try to supply it explicitly, these would be equivalent:</p>
<pre><code>switch .greater? x [20 [&lt;nope&gt;] 5 [&lt;yep&gt;]] :greater?

switch/predicate x [20 [&lt;nope&gt;] 5 [&lt;yep&gt;]] :greater?
</code></pre>
<p>It didn't seem like it would conflict, because you don't see hard-quoted ACTION!s in people's code...</p>
<p><em>...unless they're using the API, or doing a COMPOSE.</em>  Internally this happens a lot:</p>
<pre><code>REBVAL *reversed = rebValue(Lib(REDUCE), Lib(REVERSE), some_block);
</code></pre>
<p><em>(The Lib() macro does a fast fetch of builtin functions without word lookup.)</em></p>
<p>What was trying to be written above was the effect of <strong><code>reduce reverse some-block</code></strong>.  But it's acting like <strong>do compose [(:reduce) (:reverse) (:some-block)]</strong>.</p>
<p>The slot where it looks for the predicate TUPLE!s now has the REVERSE action in it...which we're intending to run to negate the variable.  But it's picked up as a predicate.  <img src="../../images/emoji/twitter/frowning.png%3Fv=9" title=":frowning:" class="emoji" alt=":frowning:"></p>
<p>I don't think the solution is to have separate /PREDICATE and /PREDICATE-ACTION refinements on every function!  Somehow any shorthands need to work with actions.</p>
<h2>I Think I Want Leading Dot TUPLE! to Mean Something Else</h2>
<p>It's difficult to read method code when you are mentioning a field in an object that was declared far away.  This is true in many languages... so C++ frequently has people write <strong><code>this-&gt;x</code></strong>, and the problem is exacerbated in Rust code which is crawling with <strong><code>self-&gt;x</code></strong>.</p>
<p>What if you could just say <strong><code>.field</code></strong>, and that would be assumed to mean something along the lines of <strong><code>self.field</code></strong> ?</p>
<p>What I'm thinking is that in Rebol's binding model, you'd have a way that  <strong><code>.field</code></strong> -- even though in memory it has a heart-byte that is a WORD! (single immutable cell) -- that could hold a binding for an implied object, <em>not</em> a binding for FIELD.</p>
<p>This concept has gotten me intrigued to where the predicate use seems far less advantageous.</p>
<h2>Going to Drop Special Predicate Notation for Now</h2>
<p>Given the various issues I've encountered, I'm going to just make /PREDICATE take a normal action for now...with no shorthand.</p>
<p>With new APPLY, it's not too onerous to supply a predicate.  And you can write a whole function in place...which is probably something you'd often want to do:</p>
<pre><code>apply :switch [
    x [20 [&lt;nope&gt;] 5 [&lt;yep&gt;]]
    /predicate func [a b] [a &gt; b]
]
</code></pre>
<p><em>We know that notation will have to be supported, regardless.</em>  So let's put that as a stake in the ground so the functions still have the predicate ability.  And work on the shorthand notations as time permits.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
    </div>






    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
        </span>
      </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
