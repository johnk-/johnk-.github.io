<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>TRY PARSE + PARSE EXCEPT : *FAIL* On Mismatch - Parsing - AltRebol</title>
    <meta name="description" content="There&amp;#39;s a snazzy new potential for giving more informative messages / logs from failed parses... which means we now have a more interesting option than we might have had before. 
Imagine something like: 
&amp;gt;&amp;gt; parse &amp;quot;aaa&amp;quot; [&amp;hellip;">
    <meta name="generator" content="Discourse 3.1.0.beta4 - https://github.com/discourse/discourse version 25276f62f959eab4557049a655300a70835c5769">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1924.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

    <link href="https://forum.rebol.info/stylesheets/color_definitions_base__2_caa66e77e807fc270e5b21d201643962219b6a9a.css?__ws=forum.rebol.info" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://forum.rebol.info/stylesheets/desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://forum.rebol.info/stylesheets/chat_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-details_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-lazy-videos_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-local-dates_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-narrative-bot_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-presence_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://forum.rebol.info/stylesheets/docker_manager_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="https://forum.rebol.info/stylesheets/poll_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://forum.rebol.info/stylesheets/chat_desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat_desktop"  />
  <link href="https://forum.rebol.info/stylesheets/poll_desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://forum.rebol.info/stylesheets/desktop_theme_2_5e18a6fac02b6ab11e33445179f4a2961aadbfd8.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="default"/>

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;TRY PARSE + PARSE EXCEPT : *FAIL* On Mismatch&#39;" href="1924.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/try-parse-parse-except-fail-on-mismatch/1924" />
<meta name="twitter:url" content="https://forum.rebol.info/t/try-parse-parse-except-fail-on-mismatch/1924" />
<meta property="og:title" content="TRY PARSE + PARSE EXCEPT : *FAIL* On Mismatch" />
<meta name="twitter:title" content="TRY PARSE + PARSE EXCEPT : *FAIL* On Mismatch" />
<meta property="og:description" content="There&#39;s a snazzy new potential for giving more informative messages / logs from failed parses... which means we now have a more interesting option than we might have had before.  Imagine something like:  &gt;&gt; parse &quot;aaa&quot; [some &quot;a&quot; some &quot;b&quot;] ** Error: SOME requires at least one match ** Where: [some &quot;a&quot; \\ some &quot;b&quot; \\] ; Note: this failure can be intercepted by TRY, EXCEPT, ATTEMPT  It can&#39;t be perfect unless it maintains some kind of large error tree that accumulates the list of all the reasons it..." />
<meta name="twitter:description" content="There&#39;s a snazzy new potential for giving more informative messages / logs from failed parses... which means we now have a more interesting option than we might have had before.  Imagine something like:  &gt;&gt; parse &quot;aaa&quot; [some &quot;a&quot; some &quot;b&quot;] ** Error: SOME requires at least one match ** Where: [some &quot;a&quot; \\ some &quot;b&quot; \\] ; Note: this failure can be intercepted by TRY, EXCEPT, ATTEMPT  It can&#39;t be perfect unless it maintains some kind of large error tree that accumulates the list of all the reasons it..." />
<meta property="og:article:section" content="Domains" />
<meta property="og:article:section:color" content="F1592A" />
<meta property="og:article:section" content="Parsing" />
<meta property="og:article:section:color" content="F1592A" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="3 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="4 ❤" />
<meta property="article:published_time" content="2022-08-19T06:23:23+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://forum.rebol.info/">
    AltRebol
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="1924.html">TRY PARSE + PARSE EXCEPT : *FAIL* On Mismatch</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/domains/15" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Domains</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/domains/parsing/16" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #F1592A'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Parsing</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='TRY PARSE + PARSE EXCEPT : *FAIL* On Mismatch'>
        <meta itemprop='articleSection' content='Parsing'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>

          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1924.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2022-08-19T06:23:23Z' class='post-time'>
                    August 19, 2022,  6:23am
                  </time>
                  <meta itemprop='dateModified' content='2023-09-17T22:47:13Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='articleBody'>
              <p>There's a snazzy new potential for giving more informative messages / logs from failed parses... which means we now have a more interesting option than we might have had before.</p>
<p>Imagine something like:</p>
<pre><code>&gt;&gt; parse "aaa" [some "a" some "b"]
** Error: SOME requires at least one match
** Where: [some "a" \\ some "b" \\]
; Note: this failure can be intercepted by TRY, EXCEPT, ATTEMPT
</code></pre>
<p>It can't be perfect unless it maintains some kind of large error tree that accumulates the list of all the reasons it decided to fail, so you might have to be in a debugging mode to ask it to give you a bigger diagnostic.  But we can build it now with the participation of the combinators themselves.</p>
<p><strong>But not only this, we could open up the full spectrum of return values.</strong>  Right now if your parse returns NULL, it has to be contorted into a null isotope to avoid accidentally cuing an ELSE.  Similar contortions for void, blank, and logic false.</p>
<pre><code>result: parse block rules except e -&gt; [print "Got an error", return none]

; If you got here, you know result is good
; Even if it was a purposefully returned NULL, etc.
</code></pre>
<p>There'd be some way to rig this up without using enfix.  I might make things more lax about letting you assign error isotopes, because the isotope will bubble through and cause a problem anyway.  So you could write something like:</p>
<pre><code> if raised? result: parse block rules [
     print "You have a failure, use ^result to get it"
 ]
</code></pre>
<p>If you were willing to collapse failure down to a NULL or somesuch, or didn't even care about the result, you could just TRY it.</p>
<pre><code> try parse block rules
</code></pre>
<h2>
<a name="too-good-not-to-be-the-default-1" class="anchor" href="1924.html#too-good-not-to-be-the-default-1"></a>Too Good Not To Be The Default</h2>
<p>Of course you'll be able to reskin it however you like for the R3C's or R3Chius out there.  But I think this looks like a perfect convergence to put in the box.</p>
<p>Errors aren't going to be that interesting on day one, but it's good to point the ship in the right direction.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../introducing-uparse-the-hackable-usermode-parse/1529.html">Introducing The Hackable Usermode PARSE (&quot;UPARSE&quot;)</a>
                        <meta itemprop='position' content='1'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../semantics-of-uparses-furthest/1868/2.html">Semantics of UPARSE&#39;s FURTHEST</a>
                        <meta itemprop='position' content='2'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../how-should-take-react-null-error/1265/5.html">How Should `TAKE []` React? Null? Error?</a>
                        <meta itemprop='position' content='3'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../enfixing-also-stylizing-it-after-then-and-else/402/6.html">Enfixing ALSO, stylizing it after THEN and ELSE</a>
                        <meta itemprop='position' content='4'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1924.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-08-11T14:32:37Z' class='post-time'>
                    August 11, 2023,  2:32pm
                  </time>
                  <meta itemprop='dateModified' content='2023-08-11T17:04:04Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Looking at a parse rule in <a class="mention" href="https://forum.rebol.info/u/gchiu">@gchiu</a>'s Pharmac project, I saw this:</p>
<pre><code>; get the SAnnnn part of the pdf name
;
root: parse pdfname [between &lt;here&gt; ".pdf"]
</code></pre>
<p><em>It's a clean, casual usage of the value-synthesizing abilities of UPARSE...</em></p>
<p><em>...and I think that cleanliness should offer you safety by default.</em></p>
<p>So it seems that if the filename is <strong><code>aspirin.pdf.zip</code></strong> you should get an error raised to draw your attention to the unexpected circumstance.</p>
<p>If you didn't want an error, you have a lot of options to craft your rules</p>
<pre><code>root: parse pdfname [between &lt;here&gt; ".pdf" elide ...]

parse pdfname [root: between &lt;here&gt; ".pdf" ...]

parse pdfname [root: between &lt;here&gt; ".pdf" to &lt;end&gt;]

root: parse pdfname [between &lt;here&gt; ".pdf" &lt;end&gt; | accept (#badfile)]
</code></pre>
<p>etc.  UPARSE dances and sings.  <img src="../../images/emoji/twitter/man_dancing.png%3Fv=12" title=":man_dancing:" class="emoji" alt=":man_dancing:" loading="lazy" width="20" height="20"> <img src="../../images/emoji/twitter/studio_microphone.png%3Fv=12" title=":studio_microphone:" class="emoji" alt=":studio_microphone:" loading="lazy" width="20" height="20"></p>
<p>Or if you just wanted it to ignore success or failure in a "classic" way, use TRY:</p>
<pre><code>root: try parse pdfname [between &lt;here&gt; ".pdf"]
</code></pre>
<p><em>That seems a good enough way to ask for the bad enough thing.</em>  It will give you a NULL if there's no ".pdf" anywhere, and what's before .pdf for anything up-to-and-including <strong><code>something.pdfoobar</code></strong></p>
<h2>
<a name="i-say-again-too-good-not-to-be-the-default-1" class="anchor" href="1924.html#i-say-again-too-good-not-to-be-the-default-1"></a>I Say Again: "Too Good Not To Be The Default"</h2>
<p>...but it's a pretty big change, which will take some figuring.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="2" />
              </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1924.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-09-16T01:09:32Z' class='post-time'>
                    September 16, 2023,  1:09am
                  </time>
                  <meta itemprop='dateModified' content='2023-09-16T04:17:00Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><strong>Since I feel RAISE of an error is such a superior option, I thought it would be worthwhile to go ahead and retrofit PARSE3 to do this as well.</strong></p>
<p>It really clarifies things.  For instance, there was some rather old code that looked like this:</p>
<pre><code>let directives: collect [
    let i
    if block? prior [
        parse3 prior [some [set i: issue! (keep i)]]
    ]
]
</code></pre>
<p>It predates COLLECT being a feature of PARSE3, so it uses regular COLLECT (which lacks the nice properties like backtracking the collected data when rules fail).</p>
<p>What it was trying to do was that you'd have something like:</p>
<pre><code>[#foo #baz #bar a b c d ...]
</code></pre>
<p>It would collect any issues at the head of the block, e.g. <strong><code>[#foo #baz #bar]</code></strong>.  There may be no issues at all, in which case the collected result would be an empty block <strong><code>[]</code></strong></p>
<p><em>But using a plain SOME rule is bad way of conveying this.</em>   The PARSE is failing, and that failure is just treated casually.  At the very least, this should be a <strong><code>try some</code></strong>.</p>
<p>Then we have the issue of not reaching the end, and that being "okay".  But the okayness is nowhere in the rule formulation, meaning the person reading this code is in the dark.  It needs something like a <strong><code>to &lt;end&gt;</code></strong> or an <strong><code>accept (true)</code></strong>.</p>
<pre><code>let directives: collect [
    let i
    if block? prior [
        parse3 prior [
            try some [set i: issue! (keep i)]
            accept (true)
        ]
    ]
]
</code></pre>
<p>Of course, modern UPARSE is much slicker (!)</p>
<pre><code>let directives: parse prior [accept collect try some keep issue!]
</code></pre>
<h2>
<a name="it-caught-the-fact-that-about-has-been-broken-for-years-1" class="anchor" href="1924.html#it-caught-the-fact-that-about-has-been-broken-for-years-1"></a>It caught the fact that ABOUT has been broken for <em>years</em>!</h2>
<p>If you look way back in the history of open source Rebol, you will find an simple dialect for printing out the ABOUT information.  The dialect looked like this:</p>
<pre><code>make-banner [
    *
    -
    "REBOL 3.0 [Alpha Test]"
    -
    = Copyright: [system/build/year "REBOL Technologies"]
    = "" "All rights reserved."
    = Website:  "www.REBOL.com"
    -
    = Version:  system/version
    = Platform: system/platform
    = Build:    system/build
    = Warning:  "For testing purposes only. Use at your own risk."
    -
    = Language: system/locale/language*
    = Locale:   system/locale/locale*
    = Home:     [to-local-file system/options/home]
    -
    *
]
</code></pre>
<p>By means of the <a href="https://github.com/rebol/rebol/blob/25033f897b2bd466068d7663563cd3ff64740b94/src/mezz/mezz-banner.r#L14">generation function MAKE-BANNER</a> it would transform into an asterisk-laden box, with the substitutions made:</p>
<pre><code>**************************************************************************
**                                                                      **
**  REBOL 3.0 [Alpha Test]                                              **
**                                                                      **
**    Copyright: 2014 REBOL Technologies                                **
**               All rights reserved.                                   **
**    Website:   www.REBOL.com                                          **
**                                                                      **
**    Version:   2.101.0.4.40                                           **
**    Platform:  Linux libc-x64                                         **
**    Build:     7-Nov-2014/18:50:11                                    **
**    Warning:   For testing purposes only. Use at your own risk.       **
**                                                                      **
**    Language:  none                                                   **
**    Locale:    none                                                   **
**    Home:      ./                                                     **
**                                                                      **
**************************************************************************
</code></pre>
<p>Simple though it is, I think it is a pretty good example of how you can "rethink" your problems in a dialect to pare down your code to express your intent.</p>
<p><strong>But it was based on a PARSE rule with <a href="https://github.com/rebol/rebol/blob/25033f897b2bd466068d7663563cd3ff64740b94/src/mezz/mezz-banner.r#L22">no check for whether the parse had actually succeeded or failed</a>!</strong>  This means that when paths like <strong>system/version</strong> were changed to tuples like <strong>system.version</strong> the parse rule stopped working, and only printed the top part of the box in Ren-C:</p>
<pre><code>**************************************************************************
**                                                                      **
**  REBOL 3.0 (Ren-C branch)                                            **
**                                                                      **
**    Copyright: 2012 REBOL Technologies                                **
**    Copyright: 2012-2021 Ren-C Open Source Contributors               **
**               Licensed Under LGPL 3.0, see LICENSE.                  **
**    Website:   http://github.com/metaeducation/ren-c                  **
</code></pre>
<p>Even though the tests would run ABOUT to make sure it didn't crash, it didn't catch this half-output-box.</p>
<h2>
<a name="i-was-convinced-now-im-more-convinced-2" class="anchor" href="1924.html#i-was-convinced-now-im-more-convinced-2"></a>I Was Convinced, Now I'm More Convinced</h2>
<p>As I go through the system and fix/clarify these issues, there's no regrets on the change.</p>
<p>Red's lack of definitional failure means they couldn't embrace the idea even if they wanted to.  Triggering an error when a parse didn't succeed would be conflated with any other error that happened inside the parse (typos etc.) so trapping errors would be impractical.  Oh well... <img src="../../images/emoji/twitter/roll_eyes.png%3Fv=12" title=":roll_eyes:" class="emoji" alt=":roll_eyes:" loading="lazy" width="20" height="20"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1924.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-11-28T00:39:13Z' class='post-time'>
                    November 28, 2023, 12:39am
                  </time>
                  <meta itemprop='dateModified' content='2023-12-07T14:58:55Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="2" data-topic="1924">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p>Or if you just wanted it to ignore success or failure in a "classic" way, use TRY:</p>
<pre><code>root: try parse pdfname [between &lt;here&gt; ".pdf"]
</code></pre>
<p><em>That seems a good enough way to ask for the bad enough thing.</em> It will give you a NULL if there's no ".pdf" anywhere, and what's before .pdf for anything up-to-and-including <strong><code>something.pdfoobar</code></strong></p>
</blockquote>
</aside>
<p>So this is good when you're writing an expression that's supposed to return a value.  But if you're only interested in if the parse reached the end or not, it's not good enough.</p>
<pre><code>&gt;&gt; try parse "aaabbb" [some "a" try some "b"]
== ~null~  ; isotope
</code></pre>
<p>That parse reached the end, but the product of the TRY combinator inside the parse block when it doesn't succeed is NULL.  So <strong>if try parse ...</strong> is unfortunately not a general answer to testing if a parse completed.</p>
<ul>
<li>
<p><strong>if not raised? parse ...</strong> works but is overly verbose.</p>
</li>
<li>
<p><strong>if unraised? parse ...</strong> is a little shorter but awkward.</p>
</li>
<li>
<p><strong>if ok? parse ...</strong> uses a very old idea of OK? meaning not-errored, but a bit nebulous in what it means, and perhaps looks a little "cheap" and abbreviated.</p>
</li>
<li>
<p><strong>if okay? parse ...</strong> looks a little less cheap and abbreviated but I don't know if the added length vs. OK? really pays for itself.</p>
</li>
<li>
<p><strong>if try? parse ...</strong> builds on the existing TRY concept so you can see the relationship, but is a bit weird.</p>
</li>
<li>
<p><strong>if did parse ...</strong> looks nice but DID is taken for something else, that I don't think should be conflated with error defusion.</p>
</li>
<li>
<p><strong>if success? parse ...</strong> or <strong>if succeeded? parse ...</strong> is a little bit like OK? in the sense that success is a pretty open-ended concept.  But TRY is tied up a bit with "success" so SUCCESS? as the complement to RAISED? isn't a terrible thing.</p>
</li>
<li>
<p><strong>if good? parse ...</strong> is weird, and the suggestion of BAD? as  a synonym for RAISED? is weird also.  But it reads a little better than IF OK?</p>
</li>
<li>
<p><strong>if parse? ...</strong> as a different form of PARSE that just returns true or false based on reaching the end is something that has shown up from time to time, but I've never been crazy about it.  Functions ending in question mark tend to take one argument.  This is like it's testing if something is a parse-state object or similar, and I can't quite read it as "if parse reached end".</p>
</li>
<li>
<p><strong>if completed? parse ...</strong> is appealing, it's a bit of a parallel to Rebol2's FOUND? to pair with FIND.  It leads to a world where <strong>completed? null</strong> is true.  While not being a generic word it would function generically to other things that might raise failures leading to misuse, and it's a long word.</p>
</li>
</ul>
<p>Everything has its upsides and downsides.  I'm not crazy about <strong>if ok? parse...</strong> but I like it better than <strong>if parse? ...</strong> and it's still brief.  And it gives OK? as a generic NOT RAISED? , as well as <strong>if not ok?</strong> as a way of saying <strong>if raised?</strong> if you liked that better.</p>
<h2>
<a name="or-a-refinement-to-parse-or-combinator-1" class="anchor" href="1924.html#or-a-refinement-to-parse-or-combinator-1"></a>Or... A Refinement to PARSE, or Combinator?</h2>
<p>For the sake of covering all the bases, I'll mention this could be attacked on the insides of parse, as well.</p>
<pre><code>if parse/completed "aaabbb" [some "a" try some "b"] ...

if parse/tail? "aaabbb" [some "a" try some "b"]

if parse "aaabbb" [completed? [some "a" try some "b"]] ...

if parse "aaabbb" [some "a" try some "b" || accept &lt;end?&gt;] ...
</code></pre>
<p>I'm actually not hating PARSE/COMPLETED.  Maybe something shorter...in the spirit of PARSE/DONE but better?</p>
<p>But if you get it shorter to PARSE/OK you aren't really doing better than OK? PARSE and losing generality.</p>
<h2>
<a name="experience-probably-informs-this-2" class="anchor" href="1924.html#experience-probably-informs-this-2"></a>Experience Probably Informs This</h2>
<p>I think it's hard to see clearly in particular having seen so many different return modes of PARSE over time.</p>
<p>As you get experience in the new world with "parse raises an error if it doesn't reach the end" then a generic tool like OK? for "checks to see if it raises an error" might seem to make perfect sense.  You just have to be used to the idea of errors, and not expect anything otherwise...so of course you need some kind of weird error-detecting construct.</p>
<p>Trying it out a little, SUCCESS? is definitely more literate than OK?.  But I don't know that the length is worth it, and OK? seems pretty learnable.</p>
<p>People can of course easily make their own shorthands, even PARSE?, if they like it.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
    </div>






    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
        </span>
      </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
