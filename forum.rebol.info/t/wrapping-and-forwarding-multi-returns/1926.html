<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Wrapping And Forwarding Multi-Returns - Functions - AltRebol</title>
    <meta name="description" content="Yup, sounds really useful. 
One question, what do functions see? 
f: function [a][]
f multi-return

Does f get the return as a block, or the first value? 
What happens with multiple parameters in f? With refinements? Wi&amp;hellip;">
    <meta name="generator" content="Discourse 3.1.0.beta4 - https://github.com/discourse/discourse version 25276f62f959eab4557049a655300a70835c5769">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="1926.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

    <link href="https://forum.rebol.info/stylesheets/color_definitions_base__2_caa66e77e807fc270e5b21d201643962219b6a9a.css?__ws=forum.rebol.info" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://forum.rebol.info/stylesheets/desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://forum.rebol.info/stylesheets/chat_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-details_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-lazy-videos_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-local-dates_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-narrative-bot_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-presence_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://forum.rebol.info/stylesheets/docker_manager_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="https://forum.rebol.info/stylesheets/poll_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://forum.rebol.info/stylesheets/chat_desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat_desktop"  />
  <link href="https://forum.rebol.info/stylesheets/poll_desktop_97f5da14b02e14a864d77b6d983a33a1b302f894.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://forum.rebol.info/stylesheets/desktop_theme_2_5e18a6fac02b6ab11e33445179f4a2961aadbfd8.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="default"/>

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Wrapping And Forwarding Multi-Returns&#39;" href="1926.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/wrapping-and-forwarding-multi-returns/1926" />
<meta name="twitter:url" content="https://forum.rebol.info/t/wrapping-and-forwarding-multi-returns/1926" />
<meta property="og:title" content="Wrapping And Forwarding Multi-Returns" />
<meta name="twitter:title" content="Wrapping And Forwarding Multi-Returns" />
<meta property="og:description" content="Yup, sounds really useful.  One question, what do functions see?  f: function [a][] f multi-return  Does f get the return as a block, or the first value?  What happens with multiple parameters in f? With refinements? With variadics? When f is enfixed?" />
<meta name="twitter:description" content="Yup, sounds really useful.  One question, what do functions see?  f: function [a][] f multi-return  Does f get the return as a block, or the first value?  What happens with multiple parameters in f? With refinements? With variadics? When f is enfixed?" />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:section" content="Functions" />
<meta property="og:article:section:color" content="25AAE2" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="5 ❤" />
<meta property="article:published_time" content="2019-03-28T06:09:03+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://forum.rebol.info/">
    AltRebol
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="1926.html">Wrapping And Forwarding Multi-Returns</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/8" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/functions/59" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Functions</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Wrapping And Forwarding Multi-Returns'>
        <meta itemprop='articleSection' content='Functions'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>

          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/IngoHohmann'><span itemprop='name'>IngoHohmann</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1926.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2019-03-28T06:09:03Z' class='post-time'>
                    March 28, 2019,  6:09am
                  </time>
                  <meta itemprop='dateModified' content='2022-08-20T07:40:57Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='articleBody'>
              <aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="1134">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"><a href="../the-history-of-multi-return-in-ren-c/1134/1.html">The History of Multi-Return in Ren-C</a>
</div>
<blockquote>
<p>It seemed clearly preferable that rather than choose between <strong>[x]:</strong> and <strong>[x y]:</strong> and knowing in advance how many values you're taking or throwing away... someone who only asked for one value should be able to be blissfully ignorant. So the choice would be between:</p>
<pre><code>&gt;&gt; x: multi-return ...
&gt;&gt; [x y]: multi-return ...
</code></pre>
<p>Even though the first case is a multiple return, you wouldn't set x to a block of values, <em>but just get the first value</em>. An interface like this would also solve the issue of returning NULL.</p>
</blockquote>
</aside>
<p>Yup, sounds really useful.</p>
<p>One question, what do functions see?</p>
<pre><code>f: function [a][]
f multi-return
</code></pre>
<p>Does f get the return as a block, or the first value?</p>
<p>What happens with multiple parameters in f? With refinements? With variadics? When f is enfixed?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../multiple-return-values/1134/3.html">The History of Multi-Return in Ren-C</a>
                        <meta itemprop='position' content='2'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../multiple-return-values/1134/2.html">The History of Multi-Return in Ren-C</a>
                        <meta itemprop='position' content='3'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1926.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2020-04-07T16:52:49Z' class='post-time'>
                    April 7, 2020,  4:52pm
                  </time>
                  <meta itemprop='dateModified' content='2023-06-22T15:21:18Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>That was six questions.  <img src="../../images/emoji/twitter/slight_smile.png%3Fv=12" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"></p>
<p><strong>UPDATE: The compacted history of multi-returns answers how it evolved from a hacked prototype into the isotopic PACK! solution of today... people should read it!</strong></p>
<aside class="quote quote-modified" data-post="1" data-topic="1134">
  <div class="title">
    <div class="quote-controls"></div>
    <img loading="lazy" alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar">
    <a href="../multiple-return-values/1134.html">The History of Multi-Return in Ren-C</a> <a class="badge-wrapper  bullet" href="https://forum.rebol.info/c/development/functions/59"><span class="badge-category-parent-bg" style="background-color: #25AAE2;"></span><span class="badge-category-bg" style="background-color: #25AAE2;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Discussions of Functions and Generators, e.g. how things like RETURN work... or the mechanics of generators and composers like ADAPT, SPECIALIZE, ENCLOSE, HIJACK, etc.">Functions</span></a>
  </div>
  <blockquote>
    This thread merges discussions of history across several threads to cover the key points, starting with material from the post announcing the addition of the SET-BLOCK! and GET-BLOCK!...and then folding in important points from later posts in the relative chronology of when they happened.  So it's broken up into sections by approximate date. 

March 2019: SET-BLOCK! and GET-BLOCK! Added
These were generic parts which you could use in dialects however you wanted...just like other types. 
But a ke…
  </blockquote>
</aside>

<h2>
<a name="a-huge-question-forwarding-1" class="anchor" href="1926.html#a-huge-question-forwarding-1"></a>A Huge Question: Forwarding</h2>
<aside class="quote no-group" data-username="IngoHohmann" data-post="1" data-topic="1926">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/ingohohmann/40/195_2.png" class="avatar"> IngoHohmann:</div>
<blockquote>
<pre><code>f: function [a][]
f multi-return
</code></pre>
<p>Does f get the return as a block, or the first value?</p>
</blockquote>
</aside>
<p>Retroactively summing up the answer to this is that since <strong><code>a</code></strong> is an ordinary parameter, the PACK! isotope would "decay" and it would only receive the first value.  But if it was a meta-parameter as <strong><code>^a</code></strong> it would get a quasi-block containing all the multi-returns.</p>
<p>But what kind of argument does RETURN take.  Does it take its return value as ^META and forward the multi-return values, or does it "decay"?</p>
<pre><code>my-wrapper: func [arg1 arg2] [
     return multi-return arg1 arg2
]
</code></pre>
<p>It might seem nice to have the wrapper forward the returns by default, and use an explicit request to decay if that was not desired:</p>
<pre><code>multi-wrapper: func [arg1 arg2] [
    return multi-return arg1 arg2  ; returns PACK! isotope
]

mono-wrapper: func [arg1 arg2] [
    return decay multi-return arg1 arg2  ; just returns first PACK! item
]
</code></pre>
<p><em>But I'm concerned this could lead to counter-intuitive situations</em>, where this would be a multi-return:</p>
<pre><code> return some-function
</code></pre>
<p>...whereas this seemingly-innocent transformation would turn the code into a mono-return:</p>
<pre><code> x: some-function
 return x
</code></pre>
<p>It feels like you'd want <em>some</em> kind of signal before having these act differently.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="1926.html">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2023-06-22T15:42:17Z' class='post-time'>
                    June 22, 2023,  3:42pm
                  </time>
                  <meta itemprop='dateModified' content='2023-06-22T15:42:17Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="hostilefork" data-post="2" data-topic="1926">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="20" height="20" src="https://forum.rebol.info/user_avatar/forum.rebol.info/hostilefork/40/26_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p><em>I'm concerned this could lead to counter-intuitive situations</em>, where this would be a multi-return:</p>
<pre><code> return some-function
</code></pre>
<p>...whereas this seemingly-innocent transformation would turn the code into a mono-return:</p>
<pre><code>x: some-function
return x
</code></pre>
<p>It feels like you'd want <em>some</em> kind of signal before having these act differently.</p>
</blockquote>
</aside>
<p>What I've tried for a while to address this was to add a /FORWARD refinement to RETURN.  If you don't use the refinement then it decays to just one value.  (This decay also means raised errors decay to trigger actual runtime failures, etc.)</p>
<p>But this adds a creeping complexity, where the concern starts showing up other places.  If you're doing a CATCH with a THROW, do you need THROW/FORWARD?</p>
<p>By contrast, the approach of assuming you want forwarding in such constructs lets you use a common DECAY primitive without contaminating them all with extra refinements.  In the scheme of things, I'm not sure that an accidental leakage of multi-return information is obviously a worse default than the accidental loss of multi-return function.</p>
<p>There may be ways that a type signature can help here: if your RETURN: spec says you return an integer and you try to return a PACK!, it could automatically decay and type check the decayed form.  (Though this wouldn't apply to the likes of CATCH and THROW, so that should be kept in mind.)</p>
<p>As for the decay on assignment... <em>it may come down to making people comfortable with the idea that if you go through a non-meta assignment to a single variable you may lose information.</em>  You always have to read <strong>x: some-function</strong> as <strong>x: decay some-function</strong> and appreciate that potential for data loss.   If you don't want to lose data:</p>
<pre><code>x: meta some-function
return unmeta x
</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
    </div>






    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/guidelines' itemprop="url">FAQ/Guidelines </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
        </span>
      </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
