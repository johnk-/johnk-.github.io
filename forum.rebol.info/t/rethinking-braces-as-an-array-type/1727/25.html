<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>{ Rethinking Braces }... as an array type? - #25 by hostilefork - Datatypes - AltRebol</title>
    <meta name="description" content="I&amp;#39;ve historically been pretty attached to braces for strings.  They sure can be nice. 
But I am increasingly thinking braces might be better applied as a new array type, called FENCE!: 
[block] •  (group) • {fence}
&amp;gt;&amp;gt; fe&amp;hellip;">
    <meta name="generator" content="Discourse 3.4.0.beta3-dev - https://github.com/discourse/discourse version 93983286b54a0e96b8073abce23f4566e9f296f7">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../1727.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="AltRebol Search">

    <link href="https://forum.rebol.info/stylesheets/color_definitions_base__2_b36da8919caf93960d3b4470a90d0e79c6a110e2.css?__ws=forum.rebol.info" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://forum.rebol.info/stylesheets/desktop_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://forum.rebol.info/stylesheets/chat_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat"  />
  <link href="https://forum.rebol.info/stylesheets/checklist_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-details_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-lazy-videos_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-local-dates_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-narrative-bot_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-presence_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://forum.rebol.info/stylesheets/docker_manager_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="https://forum.rebol.info/stylesheets/footnote_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="footnote"  />
  <link href="https://forum.rebol.info/stylesheets/poll_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://forum.rebol.info/stylesheets/spoiler-alert_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="spoiler-alert"  />
  <link href="https://forum.rebol.info/stylesheets/chat_desktop_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat_desktop"  />
  <link href="https://forum.rebol.info/stylesheets/poll_desktop_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://forum.rebol.info/stylesheets/desktop_theme_2_bac9ab3eace9fe3f17026a3c4dbf25e3e9e1e9a0.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="default"/>

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;{ Rethinking Braces }... as an array type?&#39;" href="../1727.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/rethinking-braces-as-an-array-type/1727/25" />
<meta name="twitter:url" content="https://forum.rebol.info/t/rethinking-braces-as-an-array-type/1727/25" />
<meta property="og:title" content="{ Rethinking Braces }... as an array type?" />
<meta name="twitter:title" content="{ Rethinking Braces }... as an array type?" />
<meta property="og:description" content="In Carl&#39;s &quot;ASON&quot; pitch, he proposes lexical braces to mean objects:   I don&#39;t think this would satisfy JavaScript programmers...nor Rebol programmers for that matter...as a replacement for MAKE OBJECT!.  (Note there is no source code for ASON, so we don&#39;t know how many scenarios he has looked at or hasn&#39;t.)  The problem is that if you take braces to mean objects literally, it raises the question of when expressions would be evaluated... or if expressions are allowed at all.  You can&#39;t evaluate e..." />
<meta name="twitter:description" content="In Carl&#39;s &quot;ASON&quot; pitch, he proposes lexical braces to mean objects:   I don&#39;t think this would satisfy JavaScript programmers...nor Rebol programmers for that matter...as a replacement for MAKE OBJECT!.  (Note there is no source code for ASON, so we don&#39;t know how many scenarios he has looked at or hasn&#39;t.)  The problem is that if you take braces to mean objects literally, it raises the question of when expressions would be evaluated... or if expressions are allowed at all.  You can&#39;t evaluate e..." />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:section" content="Datatypes" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="article:published_time" content="2021-10-18T00:40:46+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://forum.rebol.info/">
    AltRebol
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="../1727.html">{ Rethinking Braces }... as an array type?</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/datatypes/45" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/datatypes/45" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Datatypes</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='{ Rethinking Braces }... as an array type?'>
      <link itemprop='url' href='../1727.html'>
      <meta itemprop='datePublished' content='2021-09-29T00:30:32Z'>
        <meta itemprop='articleSection' content='Datatypes'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>

          <span itemprop='author' itemscope itemtype="http://schema.org/Person">
            <meta itemprop='name' content='hostilefork'>
            <link itemprop='url' href='https://forum.rebol.info/u/hostilefork'>
          </span>
        <meta itemprop='text' content='I&amp;#39;ve historically been pretty attached to braces for strings.  They sure can be nice. 
But I am increasingly thinking braces might be better applied as a new array type, called FENCE!: 
[block] •  (group) • {fence}
&amp;gt;&amp;gt; fe&amp;hellip;'>

          <div id='post_25' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2021-10-18T00:40:46Z' class='post-time'>
                    October 18, 2021, 12:40am
                  </time>
                  <meta itemprop='dateModified' content='2021-10-18T04:13:39Z'>
              <span itemprop='position'>25</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>In Carl's "ASON" pitch, he proposes <em>lexical</em> braces to mean objects:</p>
<aside class="quote no-group" data-username="hostilefork" data-post="1" data-topic="1727">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="../../../user_avatar/forum.rebol.info/hostilefork/48/421_2.png" class="avatar"> hostilefork:</div>
<blockquote>
<p><em>"Braces {} are used to denote objects. They are lexical and may be used directly without evaluation (the <code>make</code> constructor is not necessary)."</em></p>
</blockquote>
</aside>
<p><strong>I don't think this would satisfy JavaScript programmers...nor Rebol programmers for that matter...as a replacement for MAKE OBJECT!.</strong>  (Note there is no source code for ASON, so we don't know how many scenarios he has looked at or hasn't.)</p>
<p>The problem is that if you take braces to mean objects literally, it raises the question of when expressions would be evaluated... <em>or if expressions are allowed at all</em>.</p>
<p>You can't evaluate expressions at LOAD time because the variables and contexts are not set up.  So what would you get from this?</p>
<pre><code>center: {x: 10, y: 20}

points: [
     {x: center.x - 10, y: center.y - 10}
     {x: center.x + 10, y: center.y + 10}
]

print ["Point 1's X is" points.1.x]
</code></pre>
<p><em><strong>See the problem?</strong></em>  When <em>could</em> these expressions be evaluated?  They couldn't be evaluated at load time (it doesn't know what CENTER is yet, the line assigning it hasn't happened).  And it can't be when POINTS is assigned, because the BLOCK! is inert.</p>
<p>It seems you simply can't use expressions when braces are used to lexically represent an object instance.</p>
<h2><a name="p-5577-how-does-reds-lexical-map-deal-with-this-1" class="anchor" href="25.html#p-5577-how-does-reds-lexical-map-deal-with-this-1"></a>How Does Red's "Lexical MAP!" #(...) Deal With This?</h2>
<p>It doesn't.</p>
<pre><code>red&gt;&gt; points: [#(x: 1 + 1 y: 2 + 2)]
== [#(
    x: 1
    +: 2
    y: 2
)]
</code></pre>
<p>Since it couldn't evaluate the expressions it just did something weird, as if you'd written:</p>
<pre><code> points: reduce [make map! [
     x: 1
     +: 1
     y: 2
     +: 2  ; overwrites earlier mapping of + -&gt; 1
]]
</code></pre>
<p><img src="../../../images/emoji/twitter/roll_eyes.png%3Fv=12" title=":roll_eyes:" class="emoji only-emoji" alt=":roll_eyes:" loading="lazy" width="20" height="20"></p>
<p>So if you want expressions, you need to go through the normal process of MAKE MAP!.</p>
<h2><a name="p-5577-how-does-json-deal-with-this-2" class="anchor" href="25.html#p-5577-how-does-json-deal-with-this-2"></a>How Does JSON Deal With This</h2>
<p>It doesn't.</p>
<p>JSON is narrowly defined to not allow expressions...because it is for exchanging data.</p>
<p>You are discouraged from actually using a plain JavaScript eval() to process a JSON message <em>precisely because it can evaluate</em>...which could lead to bugs or vulnerabilities.</p>
<p>That doesn't change the fact that <strong>{...}</strong> within the JavaScript language evaluate when the line containing them is run.  In this usage they are called <em>object initializers</em>.</p>
<h2><a name="p-5577-how-would-the-fence-proposal-handle-this-3" class="anchor" href="25.html#p-5577-how-would-the-fence-proposal-handle-this-3"></a>How Would The FENCE! Proposal Handle This?</h2>
<p>The proposal differs from "{} as lexical object" because it says that FENCE! is just another category of array...which when evaluated gives you an OBJECT!.</p>
<p>Arrays would be a case where this would surprise a JavaScript programmer, because they expect an array initialization to run evaluations of the object initializers inside that array.  That's because arrays get evaluated without a REDUCE step.</p>
<p>But this applies for any expression, not just objects:</p>
<pre><code>js&gt;&gt; var test = [1 + 2, 30 + 40]
js&gt;&gt; test
&lt;- Array [ 3, 70 ]

js&gt;&gt; var test = [{x: 1 + 2, y: 30 + 40}]
js&gt;&gt; test
&lt;- Array [ {...} ]
   &gt; 0: Object {x: 3, y: 70}
     length: 1
</code></pre>
<p>We understand that the first case in Rebol would need some sort of evaluation request like REDUCE to run the expressions.  With FENCE! the way I propose it, there would have to be a similar request for evaluation.</p>
<p>This calls for operators that parallel JSON.deserialize(), that would enforce that there weren't expressions.  But also operators that would be more COMPOSE-like...looking for all the OBJECT!s in nested arrays and generating new BLOCK!s of OBJECT!s from them.</p>
<h2><a name="p-5577-what-about-accessing-fence-in-object-like-ways-4" class="anchor" href="25.html#p-5577-what-about-accessing-fence-in-object-like-ways-4"></a>What About Accessing FENCE! In Object-Like Ways?</h2>
<p>There's historical precedent of being able to pick from blocks like they were objects.  Fences could try that as well.</p>
<pre><code>&gt;&gt; points: [{x: 10, y: 20}]
== [{x: 10, y: 20}]

&gt;&gt; type of points.1
== #[datatype! fence!]

&gt;&gt; points.1.y
== 20
</code></pre>
<p>But this leads to complex questions.  What if they are expressions?  (The accessor could error if it doesn't see a comma?)  How would NULL be represented?  (Going directly to the next SET-WORD?)  FENCE! is a generic array so you can APPEND arbitrary material to it...what happens if you add another X?</p>
<p>I don't know how beneficial it is to go along with this illusion, but the subject matter already has a post for discussing it:</p>
<p><a href="../../block-and-object-parity-in-pathing-picking/1086.html" class="inline-onebox">BLOCK! and OBJECT! Parity in Pathing/Picking</a></p>
<p>One nuance here is that if braces are used principally for objects, then maybe <a class="mention" href="https://forum.rebol.info/u/rgchris">@rgchris</a>'s wish for BLOCK!s to think in terms of /SKIP counts (alternating keys and values?) could coexist with a SET-WORD!-seeking rule for FENCE!.</p>
<h2><a name="p-5577-summary-5" class="anchor" href="25.html#p-5577-summary-5"></a>Summary...?</h2>
<p>The lexical brace concept (which I have never lent my support to) would not replace MAKE OBJECT! because it cannot be used for expression evaluation.  It would be creating the objects it represents at LOAD-time, not when expression contexts were known.  It would thus serve a very niche purpose in making data exchange somewhat-more JavaScript compatible.</p>
<p>The FENCE! proposal would be able to replace MAKE OBJECT!, but would be essentially a synonym for that functionality today.  You would still need to be in an evaluative context to get the OBJECT!...and until then it would remain as an unevaluated FENCE!.  But at least you can use it for more than just data exchange.  And on the plus side, this opens up fences for interesting dialecting purposes.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../../carls-new-projects-altscript-altos/1571/4.html">Carl&#39;s New Projects (?) AltScript, AltOS</a>
                        <meta itemprop='position' content='2'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../../simple-objects-vs-what-the-people-want/1745/6.html">Simple Objects vs. What The People Want</a>
                        <meta itemprop='position' content='3'>
                      </div>
                </div>
          </div>
    </div>

      <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
          <span itemprop='name'>
            <a itemprop="url" href="../1727.html#post_25">show post in topic</a>
          </span>
      </div>

    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
