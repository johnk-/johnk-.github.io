<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Ugly Types: Less Ugly Than History, Can We Do Better? - #3 by hostilefork - Datatypes - AltRebol</title>
    <meta name="description" content="The Limited and Ambiguous Historical Idea
People are used to being able to do things like: 
 x: 10
 switch type? x [
     integer! [print &amp;quot;It&amp;#39;s an integer&amp;quot;]
     block! [print &amp;quot;It&amp;#39;s a block&amp;quot;]
 ]

 assert [parse [1 [seco&amp;hellip;">
    <meta name="generator" content="Discourse 3.4.0.beta3-dev - https://github.com/discourse/discourse version 93983286b54a0e96b8073abce23f4566e9f296f7">
<link rel="icon" type="image/png" href="../../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="../../datatype-ugliness-less-ugly-than-history-but-can-we-do-better/2151.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../../opensearch.xml" title="AltRebol Search">

    <link href="https://forum.rebol.info/stylesheets/color_definitions_base__2_b36da8919caf93960d3b4470a90d0e79c6a110e2.css?__ws=forum.rebol.info" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://forum.rebol.info/stylesheets/desktop_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://forum.rebol.info/stylesheets/chat_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat"  />
  <link href="https://forum.rebol.info/stylesheets/checklist_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-details_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-lazy-videos_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-local-dates_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-narrative-bot_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-presence_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://forum.rebol.info/stylesheets/docker_manager_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="https://forum.rebol.info/stylesheets/footnote_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="footnote"  />
  <link href="https://forum.rebol.info/stylesheets/poll_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://forum.rebol.info/stylesheets/spoiler-alert_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="spoiler-alert"  />
  <link href="https://forum.rebol.info/stylesheets/chat_desktop_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat_desktop"  />
  <link href="https://forum.rebol.info/stylesheets/poll_desktop_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://forum.rebol.info/stylesheets/desktop_theme_2_bac9ab3eace9fe3f17026a3c4dbf25e3e9e1e9a0.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="default"/>

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Ugly Types: Less Ugly Than History, Can We Do Better?&#39;" href="../2151.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/ugly-types-less-ugly-than-history-can-we-do-better/2151/3" />
<meta name="twitter:url" content="https://forum.rebol.info/t/ugly-types-less-ugly-than-history-can-we-do-better/2151/3" />
<meta property="og:title" content="Ugly Types: Less Ugly Than History, Can We Do Better?" />
<meta name="twitter:title" content="Ugly Types: Less Ugly Than History, Can We Do Better?" />
<meta property="og:description" content="Prior to antiforms, it was the case that TYPE-BLOCK!s were used, though it attempted to compress by putting the quote levels on the word in the block:  &gt;&gt; type of first [a] == &amp;[word]  &gt;&gt; type of first [&#39;a] == &amp;[&#39;word]  &gt;&gt; type of first [&#39;&#39;a] == &amp;[&#39;&#39;word]  Even that starts to incur performance penalties when you ask for a type.  Because it&#39;s synthesizing an array on the spot to answer the question--not a huge deal, but it&#39;s something.  (The only &quot;stock&quot; blocks were the unquoted forms, &amp;[word] e..." />
<meta name="twitter:description" content="Prior to antiforms, it was the case that TYPE-BLOCK!s were used, though it attempted to compress by putting the quote levels on the word in the block:  &gt;&gt; type of first [a] == &amp;[word]  &gt;&gt; type of first [&#39;a] == &amp;[&#39;word]  &gt;&gt; type of first [&#39;&#39;a] == &amp;[&#39;&#39;word]  Even that starts to incur performance penalties when you ask for a type.  Because it&#39;s synthesizing an array on the spot to answer the question--not a huge deal, but it&#39;s something.  (The only &quot;stock&quot; blocks were the unquoted forms, &amp;[word] e..." />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:section" content="Datatypes" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="article:published_time" content="2024-02-17T03:24:36+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://forum.rebol.info/">
    AltRebol
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="../../datatype-ugliness-less-ugly-than-history-but-can-we-do-better/2151.html">Ugly Types: Less Ugly Than History, Can We Do Better?</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/datatypes/45" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/datatypes/45" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Datatypes</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Ugly Types: Less Ugly Than History, Can We Do Better?'>
      <link itemprop='url' href='../../datatype-ugliness-less-ugly-than-history-but-can-we-do-better/2151.html'>
      <meta itemprop='datePublished' content='2024-02-16T23:29:33Z'>
        <meta itemprop='articleSection' content='Datatypes'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>

          <span itemprop='author' itemscope itemtype="http://schema.org/Person">
            <meta itemprop='name' content='hostilefork'>
            <link itemprop='url' href='https://forum.rebol.info/u/hostilefork'>
          </span>
        <meta itemprop='text' content='The Limited and Ambiguous Historical Idea
People are used to being able to do things like: 
 x: 10
 switch type? x [
     integer! [print &amp;quot;It&amp;#39;s an integer&amp;quot;]
     block! [print &amp;quot;It&amp;#39;s a block&amp;quot;]
 ]

 assert [parse [1 [seco&amp;hellip;'>

          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-02-17T03:24:36Z' class='post-time'>
                    February 17, 2024,  3:24am
                  </time>
                  <meta itemprop='dateModified' content='2024-02-17T22:52:34Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="bradrn" data-post="2" data-topic="2151">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="../../../user_avatar/forum.rebol.info/bradrn/48/365_2.png" class="avatar"> bradrn:</div>
<blockquote>
<p>From a Haskellerâ€™s perspective, this is the obvious solution. <code>'a</code> could be <code>&amp;[quoted word]</code>, and <code>spread [1 2 3]</code> could be <code>&amp;[isotope group]</code> (or even <code>&amp;[isotope group integer]</code>), and so on. The elements of these series could simply be ordinary words, left unevaluated and unbound: one could test <code>'isotope = first type of spread [a b c]</code>, and so on.</p>
</blockquote>
</aside>
<p>Prior to antiforms, it was the case that TYPE-BLOCK!s were used, though it attempted to compress by putting the quote levels on the word in the block:</p>
<pre><code>&gt;&gt; type of first [a]
== &amp;[word]

&gt;&gt; type of first ['a]
== &amp;['word]

&gt;&gt; type of first [''a]
== &amp;[''word]
</code></pre>
<p>Even that starts to incur performance penalties when you ask for a type.  Because it's synthesizing an array on the spot to answer the question--not a huge deal, but it's something.  <em>(The only "stock" blocks were the unquoted forms, &amp;[word] etc.)</em></p>
<p>When quasiforms/antiforms came along, it ran afoul of representation questions.  Weird answers like having to do meta forms inside the block:</p>
<pre><code>&gt;&gt; type of first [(a)]
== &amp;['group]

&gt;&gt; type of first [''(a)]
== &amp;['''group]

&gt;&gt; type of spread [a b c]
== &amp;[~group~]

&gt;&gt; type of first [~(a)~]
== &amp;['~group~]
</code></pre>
<p>That was rejected as too obfuscating.  (Meta forms work all right for things like storing arbitrary values in PACKs, but the above sucks.)</p>
<p>With my performance-blinders on, I don't recall if I ever suggested attacking this via plain words that convey parameterized types as per your Haskell-like suggestion:</p>
<pre><code>&gt;&gt; type of first [(a)]
== &amp;[group]

&gt;&gt; type of first [''(a)]
== &amp;[quoted quoted group]

&gt;&gt; type of spread [a b c]
== &amp;[antiform group]  ; or &amp;[splice], if e.g. &amp;[logic] narrows &amp;[antiform word]

&gt;&gt; type of first [~(a)~]
== &amp;[quasi group]
</code></pre>
<p>It's tough here though to assume the arity of each type is known, if we imagine this generalizing it might be better to have it structured, where only terminal types aren't in blocks</p>
<pre><code>&gt;&gt; type of first [''(a)]
== &amp;[quoted [quoted group]]

&gt;&gt; type of quote matrix
== &amp;[quoted [matrix 10x10]]
</code></pre>
<p>Which adds another performance penalty to grapple with, but it seems important if you're going to say that array destructuring is the method of type destructuring.</p>
<aside class="quote no-group" data-username="bradrn" data-post="2" data-topic="2151">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="../../../user_avatar/forum.rebol.info/bradrn/48/365_2.png" class="avatar"> bradrn:</div>
<blockquote>
<p>Possibly, these type constraints may need to have their own internal representations, different to that of ordinary Rebol functions.</p>
</blockquote>
</aside>
<p>If the answer from TYPE OF came back immutable, then magic might be able to compress that behind the scenes.  It only would work if it wasn't assumed you could change one reference to the result of TYPE OF and see that in another place.</p>
<pre><code>&gt;&gt; t: type of first ['a]
== &amp;[quoted word]

&gt;&gt; t2: t
== &amp;[quoted word]

&gt;&gt; take t
== quoted

&gt;&gt; t2
== &amp;[word]  ; only if cells for t and t2 variables point to common allocation   
</code></pre>
<p>To point to a common allocation, there has to be an allocation, which subverts some levels of optimization (at least, when one is trying to be competitive with code that does no allocations).</p>
<p>For a similar problem that's been solved, see: <a href="../../heart-bytes-explained/1008.html" class="inline-onebox">PATH! and TUPLE! compression, explained</a></p>
<h2><a name="p-7138-i-may-like-the-parameterized-type-direction-1" class="anchor" href="3.html#p-7138-i-may-like-the-parameterized-type-direction-1"></a>I May Like The Parameterized Type Direction</h2>
<p>I was already aiming to flip things back so that the &amp;word and &amp;tuple and &amp;path could be used as prettier impromptu type constraints:</p>
<pre><code>parse [1 3 5] [some &amp;odd?]

parse [...] [some &amp;tester?/refinement]

parse [...] [some &amp;obj.tester?]
</code></pre>
<p>I think this needs to be done regardless.  But if it is done, then switching around to TYPE-BLOCK! for the parameterized types would be available.</p>
<p>The idea of making terminal types equivalent to their predicates might be good or bad.  Don't know.</p>
<pre><code>&gt;&gt; group!
== &amp;group?

&gt;&gt; type of first [''(a)]
== &amp;[quoted [quoted &amp;group?]]
</code></pre>
<p>Certainly some food for thought here.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>

      <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
          <span itemprop='name'>
            <a itemprop="url" href="../../datatype-ugliness-less-ugly-than-history-but-can-we-do-better/2151.html#post_3">show post in topic</a>
          </span>
      </div>

    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
