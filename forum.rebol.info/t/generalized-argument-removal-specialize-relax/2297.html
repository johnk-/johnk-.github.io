<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Generalized Argument Removal - SPECIALIZE:RELAX - Functions - AltRebol</title>
    <meta name="description" content="Let&amp;#39;s say you want a version of append that just appends random numbers to things: 
&amp;gt;&amp;gt; append-random: adapt get $append [
       value: random 10
   ]

This works, but the function interface still thinks it takes two arg&amp;hellip;">
    <meta name="generator" content="Discourse 3.4.0.beta3-dev - https://github.com/discourse/discourse version 93983286b54a0e96b8073abce23f4566e9f296f7">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/cbd70027b53fa165575e5b665f00eb3b8ae7ea31_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="2297.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="AltRebol Search">

    <link href="https://forum.rebol.info/stylesheets/color_definitions_base__2_b36da8919caf93960d3b4470a90d0e79c6a110e2.css?__ws=forum.rebol.info" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://forum.rebol.info/stylesheets/desktop_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://forum.rebol.info/stylesheets/chat_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat"  />
  <link href="https://forum.rebol.info/stylesheets/checklist_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-details_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-lazy-videos_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-local-dates_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-narrative-bot_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://forum.rebol.info/stylesheets/discourse-presence_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://forum.rebol.info/stylesheets/docker_manager_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="https://forum.rebol.info/stylesheets/footnote_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="footnote"  />
  <link href="https://forum.rebol.info/stylesheets/poll_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://forum.rebol.info/stylesheets/spoiler-alert_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="spoiler-alert"  />
  <link href="https://forum.rebol.info/stylesheets/chat_desktop_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="chat_desktop"  />
  <link href="https://forum.rebol.info/stylesheets/poll_desktop_eb475c67ca07665cb858ddf2ea6c953c2e3e2b85.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://forum.rebol.info/stylesheets/desktop_theme_2_bac9ab3eace9fe3f17026a3c4dbf25e3e9e1e9a0.css?__ws=forum.rebol.info" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="default"/>

    
    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Generalized Argument Removal - SPECIALIZE:RELAX&#39;" href="2297.rss" />
    <meta property="og:site_name" content="AltRebol" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:image" content="https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png" />
<meta property="og:url" content="https://forum.rebol.info/t/generalized-argument-removal-specialize-relax/2297" />
<meta name="twitter:url" content="https://forum.rebol.info/t/generalized-argument-removal-specialize-relax/2297" />
<meta property="og:title" content="Generalized Argument Removal - SPECIALIZE:RELAX" />
<meta name="twitter:title" content="Generalized Argument Removal - SPECIALIZE:RELAX" />
<meta property="og:description" content="Let&#39;s say you want a version of append that just appends random numbers to things:  &gt;&gt; append-random: adapt get $append [        value: random 10    ]  This works, but the function interface still thinks it takes two arguments:  &gt;&gt; append-random [a b c] [d e] == [a b c 10]  So fine, you can just specialize out the argument.  Both ADAPT of a SPECIALIZE and SPECIALIZE of an ADAPT would remove an argument.  But you want the specialize to run first, otherwise it would overwrite the adapted value.  S..." />
<meta name="twitter:description" content="Let&#39;s say you want a version of append that just appends random numbers to things:  &gt;&gt; append-random: adapt get $append [        value: random 10    ]  This works, but the function interface still thinks it takes two arguments:  &gt;&gt; append-random [a b c] [d e] == [a b c 10]  So fine, you can just specialize out the argument.  Both ADAPT of a SPECIALIZE and SPECIALIZE of an ADAPT would remove an argument.  But you want the specialize to run first, otherwise it would overwrite the adapted value.  S..." />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:section" content="Functions" />
<meta property="og:article:section:color" content="25AAE2" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="1 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="1 ❤" />
<meta property="article:published_time" content="2024-09-23T17:37:49+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    
    <header>
  <a href="https://forum.rebol.info/">
    AltRebol
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="2297.html">Generalized Argument Removal - SPECIALIZE:RELAX</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/functions/59" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://forum.rebol.info/c/development/functions/59" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Functions</span>
              </span>
            </a>
            <meta itemprop="position" content="2" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Generalized Argument Removal - SPECIALIZE:RELAX'>
      <link itemprop='url' href='2297.html'>
      <meta itemprop='datePublished' content='2024-09-23T17:37:49Z'>
        <meta itemprop='articleSection' content='Functions'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='AltRebol'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://forum.rebol.info/uploads/default/original/1X/ae4ccad1a2789bb1e85cf5a0f52f2f1de10da26d.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="2297.html">


              <span class="crawler-post-infos">
                  <time  datetime='2024-09-23T17:37:49Z' class='post-time'>
                    September 23, 2024,  5:37pm
                  </time>
                  <meta itemprop='dateModified' content='2024-09-23T18:17:41Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Let's say you want a version of append that just appends random numbers to things:</p>
<pre><code>&gt;&gt; append-random: adapt get $append [
       value: random 10
   ]
</code></pre>
<p>This works, but the function interface still thinks it takes two arguments:</p>
<pre><code>&gt;&gt; append-random [a b c] [d e]
== [a b c 10]
</code></pre>
<p>So fine, you can just specialize out the argument.  Both ADAPT of a SPECIALIZE and SPECIALIZE of an ADAPT would remove an argument.  But you want the specialize to run first, otherwise it would overwrite the adapted value.  So SPECIALIZE the ADAPT, to put the specialize earlier in the composition process.</p>
<p><em><strong>But what value do you put in the specialized-out slot if you're just going to overwrite it?</strong></em></p>
<p>Today we have quite the awesome answer: <strong><a href="../tripwire-in-the-wild/2278.html">use a TRIPWIRE!</a></strong>  Sounds great!</p>
<pre><code>&gt;&gt; append-random: specialize (adapt get $append [
       value: random 10
   ]) [
       value: ~&lt;specialized out&gt;~
   ]
** Script Error: append expects [~void~ element? splice?] for its value argument
</code></pre>
<h2>
<a name="ooops-specialize-typechecked-that-1" class="anchor" href="2297.html#ooops-specialize-typechecked-that-1"></a>Ooops.  SPECIALIZE Typechecked That</h2>
<p>There are two good reasons for specialization to type check:</p>
<ul>
<li>
<p>You find out about bad types at the moment of specialization--instead of having to wait until the function is called to know there are problems.</p>
</li>
<li>
<p>It can speed up the system by not type checking those parameters again <em>(though it occurs to me this may be broken right now, and fixing it sooner than later would probably be smart)</em></p>
</li>
</ul>
<p>Historically what I've done just to get things going is to use some value that typechecks in the argument slot:</p>
<pre><code>&gt;&gt; append-random: specialize (adapt get $append [
       value: random 10
   ]) [
       value: [something that typechecks]
   ]

&gt;&gt; append-random [a b c]
== [a b c 7]

&gt;&gt; append-random [a b c]
== [a b c 9]

&gt;&gt; append-random [a b c]
== [a b c 7]
</code></pre>
<p>For the sake of education, notice what happens if you did it backwards and ADAPT the SPECIALIZE:</p>
<pre><code>&gt;&gt; append-random: adapt (specialize get $append [
       value: [something that typechecks]
   ]) [
       value: random 10
   ]

&gt;&gt; append-random [a b c]
== [a b c [something that typechecks]]
</code></pre>
<h2>
<a name="seems-we-need-specializerelax-2" class="anchor" href="2297.html#seems-we-need-specializerelax-2"></a>Seems We Need SPECIALIZE:RELAX</h2>
<p>Having to pick an arbitrary meaningless value that won't trip up the type checking is bad.</p>
<p>While we want to type check 99% of the time, this kind of scenario calls for a version of specialize that does not do typechecking.</p>
<p>Hence I propose <strong><code>SPECIALIZE:RELAX</code></strong>.</p>
<p>Tripwires seem like the go-to datatype to use for these specialized-out values.  Rather than just say <strong><code>~&lt;specialized out&gt;~</code></strong> you can be as detailed as you like, to help inform on what should happen:</p>
<pre><code>&gt;&gt; append-random: specialize:relax (adapt get $append [
       value: random 10
   ]) [
       value: ~&lt;ADAPT phase of APPEND-RANDOM puts INTEGER! here&gt;~
   ]
</code></pre>
<p>Tripwires are great!  <img src="../../images/emoji/twitter/boom.png%3Fv=12" title=":boom:" class="emoji" alt=":boom:" loading="lazy" width="20" height="20">  You don't have to stress too much about cost...the string inside the tag only exists as one instance in memory.</p>
<p>But you could be lazy and/or cheap, and just unset it. <img src="../../images/emoji/twitter/man_shrugging.png%3Fv=12" title=":man_shrugging:" class="emoji" alt=":man_shrugging:" loading="lazy" width="20" height="20"></p>
<pre><code>&gt;&gt; append-random: specialize:relax (adapt get $append [
       value: random 10
   ]) [
       value: ~
   ]
</code></pre>
<p>There might be other uses for not typechecking at the moment of specialization, but I can't think of what they would be.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='http://schema.org/ListItem'>
                        <a itemprop='url' href="../envelop-and-compose-by-example/2294/2.html">ENVELOP (and COMPOSE!) By Example</a>
                        <meta itemprop='position' content='2'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/bradrn'><span itemprop='name'>bradrn</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-09-24T01:19:43Z' class='post-time'>
                    September 24, 2024,  1:19am
                  </time>
                  <meta itemprop='dateModified' content='2024-09-24T01:19:43Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Not to deny the utility of this SPECIALISE:RELAX, but this feels like a job for <a href="../shorthand-interface-and-symbol-name-for-pointfree/2263/2.html">partial application</a>:</p>
<pre><code class="lang-plaintext">append-random: partial [append _ (random 10)]
</code></pre>
<p>…well, it would need to make sure the <code>random 10</code> is run on every function evaluation rather than just once when the function is constructed. But these details can be worked out.</p>
<p>(In Haskell that ‘just works’ thanks to laziness and chucking side-effects into monads. But of course Ren-C doesn’t have either.)</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://forum.rebol.info/u/hostilefork'><span itemprop='name'>hostilefork</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2024-09-24T02:20:24Z' class='post-time'>
                    September 24, 2024,  2:20am
                  </time>
                  <meta itemprop='dateModified' content='2024-09-24T02:24:59Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Yup!  Though there is no fundamental PARTIAL in the core at this time...</p>
<p>Which means the only way to build it is with tools like ADAPT, SPECIALIZE, ENCLOSE, etc.</p>
<p>At one time, I had it so putting GROUP!s in SPECIALIZE slots would run the group.  So if you wanted to literally specialize a slot with a group, you'd have to put a group that evaluated to that group.</p>
<p>But I decided that made it a less clean primitive.  I figured the ADAPT+SPECIALIZE was more general...and due to the way it's done, not really that much less efficient.</p>
<p>In terms of the technical nuts and bolts: ADAPT doesn't make a new parameter spec (Exemplar) for a function, it just uses what's there.  And SPECIALIZE doesn't create a new "implementation array" (Details) for a function, it just uses whatever implementation was there and makes a new parameter spec.  So it doesn't cost a whole lot more to adapt a specialization than what could be accomplished by writing a single generator that wove both behaviors into one step.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='https://forum.rebol.info/guidelines' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='https://forum.rebol.info/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
